<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>COAsT – Tidegauge</title><link>https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/</link><description>Recent content in Tidegauge on COAsT</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Tidegauge validation tutorial</title><link>https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/tidegauge_validation_tutorial/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/tidegauge_validation_tutorial/</guid><description>
&lt;p>This tutorial gives an overview of some of validation tools available when
using the Tidegauge objects in COAsT.&lt;/p>
&lt;p>This includes:&lt;/p>
&lt;ul>
&lt;li>creating tidegauge objects
&lt;ul>
&lt;li>reading in tidegauge data&lt;/li>
&lt;li>creating tidegauge object from gridded simulation data&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>basic plotting
&lt;ul>
&lt;li>on maps and timeseries&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>analysis
&lt;ul>
&lt;li>harmonic analysis and calculation of non-tidal residual&lt;/li>
&lt;li>doodsonX0 tidal filtering&lt;/li>
&lt;li>threshold statistics&lt;/li>
&lt;li>error calculation: mean errors, mean absolute error (MAE), mean square error (MSE)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="import-necessary-libraries">Import necessary libraries&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">xarray&lt;/span> &lt;span style="color:#204a87;font-weight:bold">as&lt;/span> &lt;span style="color:#000">xr&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">numpy&lt;/span> &lt;span style="color:#204a87;font-weight:bold">as&lt;/span> &lt;span style="color:#000">np&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">coast&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">datetime&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">matplotlib.pyplot&lt;/span> &lt;span style="color:#204a87;font-weight:bold">as&lt;/span> &lt;span style="color:#000">plt&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="define-paths">Define paths&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">fn_dom&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;&amp;lt;PATH_TO_NEMO_DOMAIN&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_dat&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;&amp;lt;PATH_TO_NEMO_DATA&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_config&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;&amp;lt;PATH_TO_CONFIG.json&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_tg&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;&amp;lt;PATH_TO_TIDEGAUGE_NETCDF&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># This should already be processed, on the same time dimension&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Change this to 0 to not use default files.&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#print(f&amp;#34;Use default files&amp;#34;)&lt;/span>
&lt;span style="color:#204a87">dir&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;./example_files/&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_dom&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87">dir&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;coast_example_nemo_domain.nc&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_dat&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87">dir&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;coast_example_nemo_data.nc&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_config&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;./config/example_nemo_grid_t.json&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_tidegauge&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87">dir&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;tide_gauges/lowestoft-p024-uk-bodc&amp;#34;&lt;/span>
&lt;span style="color:#000">fn_tg&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87">dir&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;tide_gauges/coast_example_tidegauges.nc&amp;#34;&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># These are a collection (xr.DataSet) of tidegauge observations. Created for this demonstration, they are synthetic.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="reading-data">Reading data&lt;/h3>
&lt;p>We can create our empty tidegauge object:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tidegauge&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">coast&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Tidegauge&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;p>The &lt;code>Tidegauge&lt;/code> class contains multiple methods for reading different typical
tidegauge formats. This includes reading from the GESLA and BODC databases.
To read a gesla file between two dates, we can use:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">date0&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2007&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">10&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">date1&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2007&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">12&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">tidegauge&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">read_gesla_v3&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fn_tidegauge&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">date_start&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">date0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">date_end&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">date1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>A Tidegauge object is a type of Timeseries object, so it has the form:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tidegauge&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div>&lt;svg style="position: absolute; width: 0; height: 0; overflow: hidden">
&lt;defs>
&lt;symbol id="icon-database" viewBox="0 0 32 32">
&lt;path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z">&lt;/path>
&lt;path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;/symbol>
&lt;symbol id="icon-file-text2" viewBox="0 0 32 32">
&lt;path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z">&lt;/path>
&lt;path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;/symbol>
&lt;/defs>
&lt;/svg>
&lt;style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
*
*/
&lt;p>:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p>
&lt;p>html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p>
&lt;p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}&lt;/p>
&lt;p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p>
&lt;p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p>
&lt;p>.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p>
&lt;p>.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p>
&lt;p>.xr-section-item {
display: contents;
}&lt;/p>
&lt;p>.xr-section-item input {
display: none;
}&lt;/p>
&lt;p>.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p>
&lt;p>.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p>
&lt;p>.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;►&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;▼&amp;rsquo;;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p>
&lt;p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p>
&lt;p>.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p>
&lt;p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p>
&lt;p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p>
&lt;p>.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p>
&lt;p>.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p>
&lt;p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p>
&lt;p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p>
&lt;p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p>
&lt;p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list:before {
content: &amp;lsquo;(';
}&lt;/p>
&lt;p>.xr-dim-list:after {
content: &amp;lsquo;)';
}&lt;/p>
&lt;p>.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,';
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-has-index {
font-weight: bold;
}&lt;/p>
&lt;p>.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p>
&lt;p>.xr-var-name {
grid-column: 1;
}&lt;/p>
&lt;p>.xr-var-dims {
grid-column: 2;
}&lt;/p>
&lt;p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-var-preview {
grid-column: 4;
}&lt;/p>
&lt;p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p>
&lt;p>.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p>
&lt;p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p>
&lt;p>.xr-var-data &amp;gt; table {
float: right;
}&lt;/p>
&lt;p>.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p>
&lt;p>.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p>
&lt;p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p>
&lt;p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p>
&lt;p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p>
&lt;p>.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p>
&lt;p>.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style>&lt;pre class='xr-text-repr-fallback'>&amp;lt;xarray.Dataset&amp;gt;
Dimensions: (id_dim: 1, t_dim: 193)
Coordinates:
time (t_dim) datetime64[ns] 2007-01-10 &amp;hellip; 2007-01-12
longitude (id_dim) float64 1.751
latitude (id_dim) float64 52.47
id_name (id_dim) &amp;lt;U9 'Lowestoft'
Dimensions without coordinates: id_dim, t_dim
Data variables:
ssh (id_dim, t_dim) float64 2.818 2.823 2.871 &amp;hellip; 3.214 3.257 3.371
qc_flags (id_dim, t_dim) int64 1 1 1 1 1 1 1 1 1 1 &amp;hellip; 1 1 1 1 1 1 1 1 1 1&lt;/pre>&lt;div class='xr-wrap' style='display:none'>&lt;div class='xr-header'>&lt;div class='xr-obj-type'>xarray.Dataset&lt;/div>&lt;/div>&lt;ul class='xr-sections'>&lt;li class='xr-section-item'>&lt;input id='section-6f996409-8392-4f2f-84eb-b814709b937d' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-6f996409-8392-4f2f-84eb-b814709b937d' class='xr-section-summary' title='Expand/collapse section'>Dimensions:&lt;/label>&lt;div class='xr-section-inline-details'>&lt;ul class='xr-dim-list'>&lt;li>&lt;span>id_dim&lt;/span>: 1&lt;/li>&lt;li>&lt;span>t_dim&lt;/span>: 193&lt;/li>&lt;/ul>&lt;/div>&lt;div class='xr-section-details'>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-bdc76214-ab25-4250-9ca2-17b788e6d6b6' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-bdc76214-ab25-4250-9ca2-17b788e6d6b6' class='xr-section-summary' >Coordinates: &lt;span>(4)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>time&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim)&lt;/div>&lt;div class='xr-var-dtype'>datetime64[ns]&lt;/div>&lt;div class='xr-var-preview xr-preview'>2007-01-10 &amp;hellip; 2007-01-12&lt;/div>&lt;input id='attrs-458e0adf-2ab8-4ed3-b788-06a8746752e5' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-458e0adf-2ab8-4ed3-b788-06a8746752e5' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-b04d2bb0-8dd0-452c-af3e-faea58c04f8d' class='xr-var-data-in' type='checkbox'>&lt;label for='data-b04d2bb0-8dd0-452c-af3e-faea58c04f8d' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['2007-01-10T00:00:00.000000000', '2007-01-10T00:15:00.000000000',
'2007-01-10T00:30:00.000000000', '2007-01-10T00:45:00.000000000',
'2007-01-10T01:00:00.000000000', '2007-01-10T01:15:00.000000000',
'2007-01-10T01:30:00.000000000', '2007-01-10T01:45:00.000000000',
'2007-01-10T02:00:00.000000000', '2007-01-10T02:15:00.000000000',
'2007-01-10T02:30:00.000000000', '2007-01-10T02:45:00.000000000',
'2007-01-10T03:00:00.000000000', '2007-01-10T03:15:00.000000000',
'2007-01-10T03:30:00.000000000', '2007-01-10T03:45:00.000000000',
'2007-01-10T04:00:00.000000000', '2007-01-10T04:15:00.000000000',
'2007-01-10T04:30:00.000000000', '2007-01-10T04:45:00.000000000',
'2007-01-10T05:00:00.000000000', '2007-01-10T05:15:00.000000000',
'2007-01-10T05:30:00.000000000', '2007-01-10T05:45:00.000000000',
'2007-01-10T06:00:00.000000000', '2007-01-10T06:15:00.000000000',
'2007-01-10T06:30:00.000000000', '2007-01-10T06:45:00.000000000',
'2007-01-10T07:00:00.000000000', '2007-01-10T07:15:00.000000000',
'2007-01-10T07:30:00.000000000', '2007-01-10T07:45:00.000000000',
'2007-01-10T08:00:00.000000000', '2007-01-10T08:15:00.000000000',
'2007-01-10T08:30:00.000000000', '2007-01-10T08:45:00.000000000',
'2007-01-10T09:00:00.000000000', '2007-01-10T09:15:00.000000000',
'2007-01-10T09:30:00.000000000', '2007-01-10T09:45:00.000000000',
&amp;hellip;
'2007-01-11T14:30:00.000000000', '2007-01-11T14:45:00.000000000',
'2007-01-11T15:00:00.000000000', '2007-01-11T15:15:00.000000000',
'2007-01-11T15:30:00.000000000', '2007-01-11T15:45:00.000000000',
'2007-01-11T16:00:00.000000000', '2007-01-11T16:15:00.000000000',
'2007-01-11T16:30:00.000000000', '2007-01-11T16:45:00.000000000',
'2007-01-11T17:00:00.000000000', '2007-01-11T17:15:00.000000000',
'2007-01-11T17:30:00.000000000', '2007-01-11T17:45:00.000000000',
'2007-01-11T18:00:00.000000000', '2007-01-11T18:15:00.000000000',
'2007-01-11T18:30:00.000000000', '2007-01-11T18:45:00.000000000',
'2007-01-11T19:00:00.000000000', '2007-01-11T19:15:00.000000000',
'2007-01-11T19:30:00.000000000', '2007-01-11T19:45:00.000000000',
'2007-01-11T20:00:00.000000000', '2007-01-11T20:15:00.000000000',
'2007-01-11T20:30:00.000000000', '2007-01-11T20:45:00.000000000',
'2007-01-11T21:00:00.000000000', '2007-01-11T21:15:00.000000000',
'2007-01-11T21:30:00.000000000', '2007-01-11T21:45:00.000000000',
'2007-01-11T22:00:00.000000000', '2007-01-11T22:15:00.000000000',
'2007-01-11T22:30:00.000000000', '2007-01-11T22:45:00.000000000',
'2007-01-11T23:00:00.000000000', '2007-01-11T23:15:00.000000000',
'2007-01-11T23:30:00.000000000', '2007-01-11T23:45:00.000000000',
'2007-01-12T00:00:00.000000000'], dtype='datetime64[ns]')&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>longitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>1.751&lt;/div>&lt;input id='attrs-d54bd4ac-bc23-4ed1-a450-cc7f08b9e69c' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-d54bd4ac-bc23-4ed1-a450-cc7f08b9e69c' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-c6cdb637-eebd-4120-9252-cb0d9c153006' class='xr-var-data-in' type='checkbox'>&lt;label for='data-c6cdb637-eebd-4120-9252-cb0d9c153006' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([1.75083])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>latitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>52.47&lt;/div>&lt;input id='attrs-0098f799-c5ba-4d2f-ba8a-ea90c2d23e30' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-0098f799-c5ba-4d2f-ba8a-ea90c2d23e30' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-f69f4971-aba1-4652-90aa-9350d4af9717' class='xr-var-data-in' type='checkbox'>&lt;label for='data-f69f4971-aba1-4652-90aa-9350d4af9717' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([52.473])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>id_name&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>&amp;lt;U9&lt;/div>&lt;div class='xr-var-preview xr-preview'>'Lowestoft'&lt;/div>&lt;input id='attrs-1aed8b1e-fd84-408d-9d43-41c1cb8d3b6e' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-1aed8b1e-fd84-408d-9d43-41c1cb8d3b6e' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-5e94b051-4cfa-4ebe-8282-4f5c90b61b7e' class='xr-var-data-in' type='checkbox'>&lt;label for='data-5e94b051-4cfa-4ebe-8282-4f5c90b61b7e' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['Lowestoft'], dtype='&amp;lt;U9')&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-ccd53266-52ec-46a7-a932-7cd41ef29693' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-ccd53266-52ec-46a7-a932-7cd41ef29693' class='xr-section-summary' >Data variables: &lt;span>(2)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>ssh&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, t_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>2.818 2.823 2.871 &amp;hellip; 3.257 3.371&lt;/div>&lt;input id='attrs-e776eeba-b655-4c57-b4be-5191b8d8f3ba' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-e776eeba-b655-4c57-b4be-5191b8d8f3ba' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-d5c9395b-9361-4a3a-ae11-a4509ca660f2' class='xr-var-data-in' type='checkbox'>&lt;label for='data-d5c9395b-9361-4a3a-ae11-a4509ca660f2' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[ 2.818, 2.823, 2.871, 2.931, 2.961, 2.979, 2.953, 2.913,
2.864, 2.806, 2.723, 2.664, 2.606, 2.511, 2.43 , 2.379,
2.296, 2.201, 2.105, 2.006, 1.908, 1.801, 1.684, 1.579,
1.494, 1.402, 1.306, 1.233, 1.171, 1.102, 1.054, 1.028,
0.989, 0.97 , 0.983, 1.004, 1.026, 1.068, 1.153, 1.225,
1.296, 1.362, 1.436, 1.481, 1.536, 1.615, 1.695, 1.726,
1.802, 1.842, 1.86 , 1.872, 1.897, 1.912, 1.946, 1.994,
2.006, 2.028, 2.067, 2.081, 2.098, 2.137, 2.113, 2.068,
2.053, 1.985, 1.917, 1.869, 1.803, 1.695, 1.642, 1.545,
1.463, 1.463, 1.466, 1.462, 1.476, 1.524, 1.574, 1.633,
1.661, 1.717, 1.818, 1.918, 2.018, 2.093, 2.14 , 2.223,
2.278, 2.303, 2.372, 2.375, 2.395, 2.468, 2.481, 2.487,
2.535, 2.543, 2.578, 2.621, 2.627, 2.626, 2.585, 2.563,
2.529, 2.451, 2.335, 2.207, 2.086, 1.982, 1.855, 1.741,
1.618, 1.531, 1.429, 1.342, 1.246, 1.141, 1.031, 0.902,
0.784, 0.673, 0.571, 0.457, 0.323, 0.203, 0.13 , 0.056,
-0.028, -0.077, -0.093, -0.143, -0.181, -0.211, -0.217, -0.182,
-0.1 , -0.046, 0.02 , 0.121, 0.247, 0.358, 0.468, 0.65 ,
0.845, 0.987, 1.059, 1.199, 1.322, 1.38 , 1.465, 1.519,
1.559, 1.691, 1.775, 1.844, 2.019, 2.113, 2.159, 2.266,
2.311, 2.406, 2.512, 2.533, 2.43 , 2.309, 2.185, 2.136,
2.086, 2.066, 2.114, 2.114, 2.051, 2.033, 2.055, 2.1 ,
2.192, 2.278, 2.334, 2.421, 2.497, 2.548, 2.603, 2.679,
2.803, 2.859, 2.875, 3.001, 3.075, 3.135, 3.214, 3.257,
3.371]])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>qc_flags&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, t_dim)&lt;/div>&lt;div class='xr-var-dtype'>int64&lt;/div>&lt;div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 1 &amp;hellip; 1 1 1 1 1 1 1 1&lt;/div>&lt;input id='attrs-a85108f6-467f-4c00-b7ea-2ab4f1359ba6' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-a85108f6-467f-4c00-b7ea-2ab4f1359ba6' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-41a40df4-c5d6-48b0-ae72-2ec40a0a74c1' class='xr-var-data-in' type='checkbox'>&lt;label for='data-41a40df4-c5d6-48b0-ae72-2ec40a0a74c1' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-84954f72-9280-4679-970e-16c80b84946f' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-84954f72-9280-4679-970e-16c80b84946f' class='xr-section-summary' title='Expand/collapse section'>Attributes: &lt;span>(0)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/div>&lt;/p>
&lt;p>An example data variable could be ssh, or ntr (non-tidal residual). This object can also be used for other instrument types, not just tide gauges. For example moorings.&lt;/p>
&lt;p>Every id index for this object should use the same time coordinates. Therefore, timeseries need to be aligned before being placed into the object. If there is any padding needed, then NaNs should be used. NaNs should also be used for quality control/data rejection.&lt;/p>
&lt;p>For the rest of our examples, we will use data from multiple tide gauges
on the same time dimension. It will be read in from a simple netCDF file:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tt&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">xr&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">open_dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fn_tg&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">obs&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">coast&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Tidegauge&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">tt&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># Create the object and then inset the netcdf dataset&lt;/span>
&lt;span style="color:#000">tt&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">xr&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">open_dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fn_tg&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">obs&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">coast&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Tidegauge&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">tt&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">set_coords&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;time&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;h2 id="quick-plotting-to-visualise-tidegauge-data">Quick plotting to visualise Tidegauge data&lt;/h2>
&lt;p>Tidegauge has ready made quick plotting routines for viewing time series and tide gauge location. To look at the tide gauge location:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">fig&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ax&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot_on_map&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>/usr/share/miniconda/envs/coast/lib/python3.8/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip
warnings.warn(f'Downloading: {url}', DownloadWarning)
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_16_1.png" alt="png">&lt;/p>
&lt;p>There is also a slightly expanded version where you can plot multiple tidegauge objects, included as a list, and also the colour (if it is a dataarray with one value per location).&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># plot a list tidegauge datasets (here repeating obs for the point of demonstration) and colour&lt;/span>
&lt;span style="color:#000">fig&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ax&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot_on_map_multiple&lt;/span>&lt;span style="color:#000;font-weight:bold">([&lt;/span>&lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span> &lt;span style="color:#000">color_var_str&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;latitude&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_18_0.png" alt="png">&lt;/p>
&lt;p>Time series can be plotted using &lt;code>matplotlib.pyplot&lt;/code> methods. However &lt;code>xarray&lt;/code> has its own plotting wrappers that can be used, which offers some conveniences with labelling&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># pick a gauge station&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">subplot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># rename time dimension to enable automatic x-axis labelling&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">subplot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">rename&lt;/span>&lt;span style="color:#000;font-weight:bold">({&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;t_dim&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;time&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">})&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># rename time dimension to enable automatic x-axis labelling&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">tight_layout&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">show&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_20_0.png" alt="png">&lt;/p>
&lt;p>Or you can use the &lt;code>Tidegauge.plot_timeseries()&lt;/code> method, in which start and end dates can also be specified.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot_timeseries&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">date_start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;2007-01-01&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;span style="color:#000">date_end&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;2007-01-31&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>(&amp;lt;Figure size 1000x1000 with 1 Axes&amp;gt;,
&amp;lt;matplotlib.collections.PathCollection at 0x7f7f56e9cd00&amp;gt;)
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_22_1.png" alt="png">&lt;/p>
&lt;h2 id="basic-manipulation-subsetting--plotting">Basic manipulation: subsetting + plotting&lt;/h2>
&lt;p>We can do some simple spatial and temporal manipulations of this data:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># Cut out a time window&lt;/span>
&lt;span style="color:#000">obs_cut&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time_slice&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">date0&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2007&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">date1&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2007&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">31&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Cut out geographical boxes&lt;/span>
&lt;span style="color:#000">obs_upper&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs_cut&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">subset_indices_lonlat_box&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">lonbounds&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">latbounds&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">50&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">55&lt;/span>&lt;span style="color:#000;font-weight:bold">])&lt;/span>
&lt;span style="color:#000">obs_lower&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs_cut&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">subset_indices_lonlat_box&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">lonbounds&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">9&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">latbounds&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">55.5&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">59&lt;/span>&lt;span style="color:#000;font-weight:bold">])&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#fig, ax = obs_cut.plot_on_map()&lt;/span>
&lt;span style="color:#000">fig&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ax&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs_upper&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot_on_map_multiple&lt;/span>&lt;span style="color:#000;font-weight:bold">([&lt;/span>&lt;span style="color:#000">obs_upper&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">obs_lower&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span> &lt;span style="color:#000">color_var_str&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;latitude&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_24_1.png" alt="png">&lt;/p>
&lt;h3 id="gridded-model-comparison">Gridded model comparison&lt;/h3>
&lt;p>To compare our observations to the model, we will interpolate a model variable to the same time and geographical space as the tidegauge. This is done using the &lt;code>obs_operator()&lt;/code> method.&lt;/p>
&lt;p>But first load some gridded data and manipulate some variable names for convenience&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">nemo&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">coast&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Gridded&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fn_dat&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">fn_dom&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">multiple&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#3465a4">True&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">config&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">fn_config&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Rename depth_0 to be depth&lt;/span>
&lt;span style="color:#000">nemo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">nemo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">rename&lt;/span>&lt;span style="color:#000;font-weight:bold">({&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;depth_0&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;depth&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">})&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#nemo.dataset = nemo.dataset[[&amp;#34;ssh&amp;#34;, &amp;#34;landmask&amp;#34;]]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>interpolate model onto obs locations&lt;/p>
&lt;pre>&lt;code>tidegauge_from_model = obs.obs_operator(nemo, time_interp='nearest')
&lt;/code>&lt;/pre>&lt;p>Doing this would create a new interpolated tidegauge called &lt;code>tidegauge_from_model&lt;/code>
Take a look at &lt;code>tidegauge_from_model.dataset&lt;/code> to see for yourself. If a &lt;code>landmask&lt;/code>
variable is present in the &lt;code>Gridded&lt;/code> dataset then the nearest wet points will
be taken. Otherwise, just the nearest point is taken. If &lt;code>landmask&lt;/code> is required
but not present you will need to insert it into the dataset yourself. For nemo
data, you could use the &lt;code>bottom_level&lt;/code> or &lt;code>mbathy&lt;/code> variables to do this. E.g:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># Create a landmask array and put it into the nemo object.&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Here, using the bottom_level == 0 variable from the domain file is enough.&lt;/span>
&lt;span style="color:#000">nemo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;landmask&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">nemo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">bottom_level&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">==&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Then do the interpolation&lt;/span>
&lt;span style="color:#000">tidegauge_from_model&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">obs_operator&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">nemo&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">time_interp&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;nearest&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Calculating spatial indices.
Calculating time indices.
Indexing model data at tide gauge locations..
Calculating interpolation distances.
Interpolating in time...
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;p>However, the new &lt;code>tidegauge_from_model&lt;/code> will the same number of time entries as the &lt;code>obs&lt;/code> data (rather than the model data). So, for a more useful demonstration we trim the observed gauge data so it better matches the model data.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># Cut down data to be only in 2007 to match model data.&lt;/span>
&lt;span style="color:#000">start_date&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2007&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">end_date&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2007&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">31&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">obs&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time_slice&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">start_date&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end_date&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;h3 id="interpolate-model-data-onto-obs-locations">Interpolate model data onto obs locations&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">model_timeseries&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">obs_operator&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">nemo&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Take a look&lt;/span>
&lt;span style="color:#000">model_timeseries&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Calculating spatial indices.
Calculating time indices.
Indexing model data at tide gauge locations..
Calculating interpolation distances.
Interpolating in time...
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;div>&lt;svg style="position: absolute; width: 0; height: 0; overflow: hidden">
&lt;defs>
&lt;symbol id="icon-database" viewBox="0 0 32 32">
&lt;path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z">&lt;/path>
&lt;path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;/symbol>
&lt;symbol id="icon-file-text2" viewBox="0 0 32 32">
&lt;path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z">&lt;/path>
&lt;path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;/symbol>
&lt;/defs>
&lt;/svg>
&lt;style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
*
*/
&lt;p>:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p>
&lt;p>html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p>
&lt;p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}&lt;/p>
&lt;p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p>
&lt;p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p>
&lt;p>.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p>
&lt;p>.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p>
&lt;p>.xr-section-item {
display: contents;
}&lt;/p>
&lt;p>.xr-section-item input {
display: none;
}&lt;/p>
&lt;p>.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p>
&lt;p>.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p>
&lt;p>.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;►&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;▼&amp;rsquo;;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p>
&lt;p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p>
&lt;p>.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p>
&lt;p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p>
&lt;p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p>
&lt;p>.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p>
&lt;p>.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p>
&lt;p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p>
&lt;p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p>
&lt;p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p>
&lt;p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list:before {
content: &amp;lsquo;(';
}&lt;/p>
&lt;p>.xr-dim-list:after {
content: &amp;lsquo;)';
}&lt;/p>
&lt;p>.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,';
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-has-index {
font-weight: bold;
}&lt;/p>
&lt;p>.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p>
&lt;p>.xr-var-name {
grid-column: 1;
}&lt;/p>
&lt;p>.xr-var-dims {
grid-column: 2;
}&lt;/p>
&lt;p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-var-preview {
grid-column: 4;
}&lt;/p>
&lt;p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p>
&lt;p>.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p>
&lt;p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p>
&lt;p>.xr-var-data &amp;gt; table {
float: right;
}&lt;/p>
&lt;p>.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p>
&lt;p>.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p>
&lt;p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p>
&lt;p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p>
&lt;p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p>
&lt;p>.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p>
&lt;p>.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style>&lt;pre class='xr-text-repr-fallback'>&amp;lt;xarray.Dataset&amp;gt;
Dimensions: (z_dim: 51, axis_nbounds: 2, t_dim: 720, id_dim: 61,
interp_dist: 61)
Coordinates:
longitude (id_dim) float32 1.444 -4.0 -5.333 &amp;hellip; 7.666 -9.111 8.777
latitude (id_dim) float32 51.93 51.53 58.0 51.67 &amp;hellip; 58.0 51.53 53.87
depth (z_dim, id_dim) float32 0.1001 0.2183 0.2529 &amp;hellip; 27.32 10.11
time (t_dim) datetime64[ns] 2007-01-01 &amp;hellip; 2007-01-30T23:00:00&lt;/p>
&lt;ul>
&lt;li>
&lt;p>interp_dist (interp_dist) float64 10.56 4.33 15.65 &amp;hellip; 5.835 4.96 3.957
Dimensions without coordinates: z_dim, axis_nbounds, t_dim, id_dim
Data variables:
deptht_bounds (z_dim, axis_nbounds) float32 0.0 6.157 &amp;hellip; 5.924e+03
ssh (t_dim, id_dim) float32 nan nan nan &amp;hellip; 0.3721 -0.0752 0.7412
temperature (t_dim, z_dim, id_dim) float32 nan nan nan &amp;hellip; nan nan nan
bathymetry (id_dim) float32 10.0 21.81 6.075 15.56 &amp;hellip; 17.8 14.06 10.0
e1 (id_dim) float32 7.618e+03 7.686e+03 &amp;hellip; 7.686e+03 7.285e+03
e2 (id_dim) float32 7.414e+03 7.414e+03 &amp;hellip; 7.414e+03 7.414e+03
e3_0 (z_dim, id_dim) float32 0.2002 0.4365 0.5059 &amp;hellip; 0.541 0.2002
bottom_level (id_dim) float32 50.0 50.0 12.0 32.0 &amp;hellip; 44.0 17.0 26.0 50.0
landmask (id_dim) bool False False False False &amp;hellip; False False False
Attributes:
name: AMM7_1d_20070101_20070131_25hourm_grid_T
description: ocean T grid variables, 25h meaned
title: ocean T grid variables, 25h meaned
Conventions: CF-1.6
timeStamp: 2019-Dec-26 04:35:28 GMT
uuid: 96cae459-d3a1-4f4f-b82b-9259179f95f7
history: Tue May 19 12:07:51 2020: ncks -v votemper,sossheig -d time&amp;hellip;
NCO: 4.4.7&lt;/pre>&lt;div class='xr-wrap' style='display:none'>&lt;div class='xr-header'>&lt;div class='xr-obj-type'>xarray.Dataset&lt;/div>&lt;/div>&lt;ul class='xr-sections'>&lt;li class='xr-section-item'>&lt;input id='section-adbcc442-771d-4114-b76e-1e80ea36a848' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-adbcc442-771d-4114-b76e-1e80ea36a848' class='xr-section-summary' title='Expand/collapse section'>Dimensions:&lt;/label>&lt;div class='xr-section-inline-details'>&lt;ul class='xr-dim-list'>&lt;li>&lt;span>z_dim&lt;/span>: 51&lt;/li>&lt;li>&lt;span>axis_nbounds&lt;/span>: 2&lt;/li>&lt;li>&lt;span>t_dim&lt;/span>: 720&lt;/li>&lt;li>&lt;span>id_dim&lt;/span>: 61&lt;/li>&lt;li>&lt;span class='xr-has-index'>interp_dist&lt;/span>: 61&lt;/li>&lt;/ul>&lt;/div>&lt;div class='xr-section-details'>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-8fc74827-3941-4c1c-9eda-11b9eabfd0e3' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-8fc74827-3941-4c1c-9eda-11b9eabfd0e3' class='xr-section-summary' >Coordinates: &lt;span>(5)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>longitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>1.444 -4.0 -5.333 &amp;hellip; -9.111 8.777&lt;/div>&lt;input id='attrs-3afa8a4b-16b2-4e2c-90b0-8e3829078bbc' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-3afa8a4b-16b2-4e2c-90b0-8e3829078bbc' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-528536c2-2a47-4281-a874-f12b15c7df90' class='xr-var-data-in' type='checkbox'>&lt;label for='data-528536c2-2a47-4281-a874-f12b15c7df90' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([ 1.4443359 , -4. , -5.333008 , -5.111328 , -3. ,
-3.1113281 , -5.2226562 , -3. , -1.4443359 , 1.4443359 ,
-4.666992 , 1.3330078 , -6.2226562 , -2.555664 , -3.7783203 ,
-4.333008 , 1.1113281 , -0.55566406, -5.555664 , -5.111328 ,
-1.4443359 , -2. , -1.1113281 , -2.8886719 , -1.8886719 ,
-6.333008 , -3.1113281 , -6.2226562 , -0. , 0.11132812,
-4. , 1.3330078 , -2.7783203 , -2.1113281 , -1.4443359 ,
-3.555664 , -1.4443359 , -2.7783203 , -3.2226562 , 1.7773438 ,
-5. , -5.555664 , -3.1113281 , -1.1113281 , -6.333008 ,
-5. , -4.7783203 , -6.666992 , -2.7783203 , -1.4443359 ,
-4.111328 , -4.111328 , -1.4443359 , 11.22168 , 11.777344 ,
4.888672 , 11.22168 , -7.333008 , 7.6660156 , -9.111328 ,
8.777344 ], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>latitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>51.93 51.53 58.0 &amp;hellip; 51.53 53.87&lt;/div>&lt;input id='attrs-ed94f379-5e3c-4abe-84b3-0eab07c4d921' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-ed94f379-5e3c-4abe-84b3-0eab07c4d921' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-67462e50-042b-4e44-9527-2605d1335348' class='xr-var-data-in' type='checkbox'>&lt;label for='data-67462e50-042b-4e44-9527-2605d1335348' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([51.933594, 51.53418 , 58.000977, 51.666992, 54.000977, 51.26758 ,
58.467773, 58.467773, 55.067383, 51.933594, 53.333984, 52.933594,
56.66797 , 50.600586, 53.333984, 50.333984, 51.53418 , 54.467773,
50.067383, 54.80078 , 55.067383, 57.13379 , 60.20117 , 51.53418 ,
50.666992, 49.933594, 53.467773, 55.600586, 53.600586, 50.7334 ,
57.600586, 51.067383, 51.53418 , 49.13379 , 55.067383, 54.666992,
55.067383, 51.53418 , 56.000977, 52.467773, 52.067383, 54.666992,
51.26758 , 50.7334 , 58.13379 , 55.734375, 54.067383, 55.26758 ,
51.53418 , 55.067383, 52.734375, 51.26758 , 55.067383, 58.333984,
57.66797 , 61.93457 , 64.868164, 55.40039 , 58.000977, 51.53418 ,
53.867188], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>depth&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(z_dim, id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>0.1001 0.2183 &amp;hellip; 27.32 10.11&lt;/div>&lt;input id='attrs-398d79b6-c7ae-493c-bc2f-17dc43204ff9' class='xr-var-attrs-in' type='checkbox' >&lt;label for='attrs-398d79b6-c7ae-493c-bc2f-17dc43204ff9' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-256af0ff-a869-4850-b1c4-a542a8ea745b' class='xr-var-data-in' type='checkbox'>&lt;label for='data-256af0ff-a869-4850-b1c4-a542a8ea745b' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;dt>&lt;span>units :&lt;/span>&lt;/dt>&lt;dd>m&lt;/dd>&lt;dt>&lt;span>standard_name :&lt;/span>&lt;/dt>&lt;dd>Depth at time zero on the t-grid&lt;/dd>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[1.00097656e-01, 2.18261719e-01, 2.52929688e-01, &amp;hellip;,
5.02441406e-01, 2.70507812e-01, 1.00097656e-01],
[3.00292969e-01, 6.54785156e-01, 7.58789062e-01, &amp;hellip;,
1.49365234e+00, 8.11523438e-01, 3.00292969e-01],
[5.00488281e-01, 1.09130859e+00, 1.26464844e+00, &amp;hellip;,
2.46826172e+00, 1.35253906e+00, 5.00488281e-01],
&amp;hellip;,
[9.70947266e+00, 2.11713867e+01, 2.45341797e+01, &amp;hellip;,
1.70940918e+02, 2.62392578e+01, 9.70947266e+00],
[9.90966797e+00, 2.16079102e+01, 2.50400391e+01, &amp;hellip;,
1.75505371e+02, 2.67802734e+01, 9.90966797e+00],
[1.01098633e+01, 2.20444336e+01, 2.55458984e+01, &amp;hellip;,
1.79002441e+02, 2.73212891e+01, 1.01098633e+01]], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>time&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim)&lt;/div>&lt;div class='xr-var-dtype'>datetime64[ns]&lt;/div>&lt;div class='xr-var-preview xr-preview'>2007-01-01 &amp;hellip; 2007-01-30T23:00:00&lt;/div>&lt;input id='attrs-e7c38591-551c-4df8-8a41-e4dc8d098b04' class='xr-var-attrs-in' type='checkbox' >&lt;label for='attrs-e7c38591-551c-4df8-8a41-e4dc8d098b04' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-6c8c2321-34b5-421d-9834-6aa0b86d0f46' class='xr-var-data-in' type='checkbox'>&lt;label for='data-6c8c2321-34b5-421d-9834-6aa0b86d0f46' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;dt>&lt;span>axis :&lt;/span>&lt;/dt>&lt;dd>T&lt;/dd>&lt;dt>&lt;span>standard_name :&lt;/span>&lt;/dt>&lt;dd>time&lt;/dd>&lt;dt>&lt;span>long_name :&lt;/span>&lt;/dt>&lt;dd>Time axis&lt;/dd>&lt;dt>&lt;span>time_origin :&lt;/span>&lt;/dt>&lt;dd>1900-01-01 00:00:00&lt;/dd>&lt;dt>&lt;span>bounds :&lt;/span>&lt;/dt>&lt;dd>time_counter_bounds&lt;/dd>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', &amp;hellip;, '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span class='xr-has-index'>interp_dist&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(interp_dist)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>10.56 4.33 15.65 &amp;hellip; 4.96 3.957&lt;/div>&lt;input id='attrs-d34d5c6c-89d6-49b9-af86-266198dc55eb' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-d34d5c6c-89d6-49b9-af86-266198dc55eb' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-9fcd23ef-bdda-45d4-9551-f11ea6220fbc' class='xr-var-data-in' type='checkbox'>&lt;label for='data-9fcd23ef-bdda-45d4-9551-f11ea6220fbc' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([10.557536, 4.32986 , 15.652248, 6.018475, 6.219445, 6.03486 ,
10.097628, 5.838893, 6.671627, 7.062506, 3.811328, 2.10403 ,
10.895208, 7.653076, 3.124836, 11.159928, 27.307532, 4.520905,
4.064858, 4.679088, 6.671627, 4.967727, 5.4814 , 7.053344,
5.352902, 2.058653, 6.497781, 3.618604, 12.729041, 6.597736,
0.247078, 5.276769, 5.090907, 5.522412, 6.671627, 1.957449,
6.671627, 5.130461, 2.833094, 1.887713, 6.068393, 7.322999,
6.03486 , 7.690458, 8.786909, 6.134009, 2.111385, 6.791151,
5.130461, 6.671627, 4.76955 , 6.294531, 6.671627, 1.823125,
2.146439, 11.946562, 1.343733, 3.712935, 5.835372, 4.960209,
3.956633])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-4649ce9a-5022-4189-8227-39a084172c03' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-4649ce9a-5022-4189-8227-39a084172c03' class='xr-section-summary' >Data variables: &lt;span>(9)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>deptht_bounds&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(z_dim, axis_nbounds)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>0.0 6.157 &amp;hellip; 5.72e+03 5.924e+03&lt;/div>&lt;input id='attrs-a671a142-a768-4491-8167-9010562442be' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-a671a142-a768-4491-8167-9010562442be' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-48511575-a91a-43f7-b768-a6ed9ecd4066' class='xr-var-data-in' type='checkbox'>&lt;label for='data-48511575-a91a-43f7-b768-a6ed9ecd4066' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[ 0. , 6.1572266],
[ 6.1572266, 12.678711 ],
[ 12.678711 , 19.65332 ],
[ 19.65332 , 27.19043 ],
[ 27.19043 , 35.426758 ],
[ 35.426758 , 44.527344 ],
[ 44.527344 , 54.69922 ],
[ 54.69922 , 66.19141 ],
[ 66.19141 , 79.305664 ],
[ 79.305664 , 94.41016 ],
[ 94.41016 , 111.94238 ],
[ 111.94238 , 132.41895 ],
[ 132.41895 , 156.44531 ],
[ 156.44531 , 184.71582 ],
[ 184.71582 , 218.01562 ],
[ 218.01562 , 257.20605 ],
[ 257.20605 , 303.20508 ],
[ 303.20508 , 356.95898 ],
[ 356.95898 , 419.39258 ],
[ 419.39258 , 491.35645 ],
&amp;hellip;
[1955.7686 , 2136.3613 ],
[2136.3613 , 2321.292 ],
[2321.292 , 2509.8564 ],
[2509.8564 , 2701.4355 ],
[2701.4355 , 2895.504 ],
[2895.504 , 3091.6123 ],
[3091.6123 , 3289.3867 ],
[3289.3867 , 3488.5156 ],
[3488.5156 , 3688.7441 ],
[3688.7441 , 3889.8613 ],
[3889.8613 , 4091.6963 ],
[4091.6963 , 4294.1094 ],
[4294.1094 , 4496.9893 ],
[4496.9893 , 4700.242 ],
[4700.242 , 4903.797 ],
[4903.797 , 5107.5938 ],
[5107.5938 , 5311.584 ],
[5311.584 , 5515.7295 ],
[5515.7295 , 5720. ],
[5720. , 5924.2705 ]], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>ssh&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim, id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>nan nan nan &amp;hellip; -0.0752 0.7412&lt;/div>&lt;input id='attrs-aa6eb0ee-b010-46fc-b44f-4ebe0794bf75' class='xr-var-attrs-in' type='checkbox' >&lt;label for='attrs-aa6eb0ee-b010-46fc-b44f-4ebe0794bf75' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-75ac61b0-e7ea-4894-973c-4a0dcb80b214' class='xr-var-data-in' type='checkbox'>&lt;label for='data-75ac61b0-e7ea-4894-973c-4a0dcb80b214' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;dt>&lt;span>units :&lt;/span>&lt;/dt>&lt;dd>m&lt;/dd>&lt;dt>&lt;span>online_operation :&lt;/span>&lt;/dt>&lt;dd>instant&lt;/dd>&lt;dt>&lt;span>interval_operation :&lt;/span>&lt;/dt>&lt;dd>300 s&lt;/dd>&lt;dt>&lt;span>interval_write :&lt;/span>&lt;/dt>&lt;dd>1 d&lt;/dd>&lt;dt>&lt;span>cell_methods :&lt;/span>&lt;/dt>&lt;dd>time: point (interval: 300 s)&lt;/dd>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[ nan, nan, nan, &amp;hellip;, nan,
nan, nan],
[ nan, nan, nan, &amp;hellip;, nan,
nan, nan],
[ nan, nan, nan, &amp;hellip;, nan,
nan, nan],
&amp;hellip;,
[ 0.24902344, -0.046875 , 0.20019531, &amp;hellip;, 0.3720703 ,
-0.07519531, 0.74121094],
[ 0.24902344, -0.046875 , 0.20019531, &amp;hellip;, 0.3720703 ,
-0.07519531, 0.74121094],
[ 0.24902344, -0.046875 , 0.20019531, &amp;hellip;, 0.3720703 ,
-0.07519531, 0.74121094]], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>temperature&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim, z_dim, id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>nan nan nan nan &amp;hellip; nan nan nan nan&lt;/div>&lt;input id='attrs-44a9bf1b-dfd7-4d99-bd6a-06a14caa3427' class='xr-var-attrs-in' type='checkbox' >&lt;label for='attrs-44a9bf1b-dfd7-4d99-bd6a-06a14caa3427' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-faeafbdc-8889-4c8a-969a-55e3e39cdf6f' class='xr-var-data-in' type='checkbox'>&lt;label for='data-faeafbdc-8889-4c8a-969a-55e3e39cdf6f' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;dt>&lt;span>units :&lt;/span>&lt;/dt>&lt;dd>degC&lt;/dd>&lt;dt>&lt;span>online_operation :&lt;/span>&lt;/dt>&lt;dd>instant&lt;/dd>&lt;dt>&lt;span>interval_operation :&lt;/span>&lt;/dt>&lt;dd>300 s&lt;/dd>&lt;dt>&lt;span>interval_write :&lt;/span>&lt;/dt>&lt;dd>1 d&lt;/dd>&lt;dt>&lt;span>cell_methods :&lt;/span>&lt;/dt>&lt;dd>time: point (interval: 300 s)&lt;/dd>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
&amp;hellip;,
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan]],&lt;/p>
&lt;p>[[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
&amp;hellip;
[7.4384766, 8.22168 , nan, &amp;hellip;, nan, nan,
5.0009766],
[7.439453 , 8.22168 , nan, &amp;hellip;, nan, nan,
5.0009766],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan]],&lt;/p>
&lt;p>[[7.4335938, 8.217773 , 7.245117 , &amp;hellip;, 5.8652344, 8.924805 ,
5.0322266],
[7.4345703, 8.219727 , 7.245117 , &amp;hellip;, 5.8671875, 8.926758 ,
5.0322266],
[7.4345703, 8.219727 , 7.2421875, &amp;hellip;, 5.8691406, 8.926758 ,
5.0322266],
&amp;hellip;,
[7.4384766, 8.22168 , nan, &amp;hellip;, nan, nan,
5.0009766],
[7.439453 , 8.22168 , nan, &amp;hellip;, nan, nan,
5.0009766],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan]]], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>bathymetry&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>10.0 21.81 6.075 &amp;hellip; 14.06 10.0&lt;/div>&lt;input id='attrs-1ef1c015-b9a4-441b-90e8-9c716cbc2beb' class='xr-var-attrs-in' type='checkbox' >&lt;label for='attrs-1ef1c015-b9a4-441b-90e8-9c716cbc2beb' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-163abc53-6777-4477-92a2-03010ca84861' class='xr-var-data-in' type='checkbox'>&lt;label for='data-163abc53-6777-4477-92a2-03010ca84861' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;dt>&lt;span>units :&lt;/span>&lt;/dt>&lt;dd>m&lt;/dd>&lt;dt>&lt;span>standard_name :&lt;/span>&lt;/dt>&lt;dd>bathymetry&lt;/dd>&lt;dt>&lt;span>description :&lt;/span>&lt;/dt>&lt;dd>depth of last wet w-level on the horizontal t-grid&lt;/dd>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([10. , 21.80957 , 6.0751953, 15.558594 , 10.65625 ,
12.145508 , 53.125 , 47.216797 , 10.3125 , 10. ,
21.898438 , 10.095703 , 11.674805 , 15.611328 , 11.230469 ,
20.368164 , 10.25293 , 14.34082 , 23.28418 , 37.7666 ,
10.3125 , 34.78711 , 15.394531 , 10. , 12.630859 ,
21.493164 , 10. , 18.167969 , 10. , 17.354492 ,
10. , 24.625 , 10. , 9.915039 , 10.3125 ,
10. , 10.3125 , 10. , 10. , 10.0703125,
37.003906 , 10.40918 , 12.145508 , 10. , 30.885742 ,
35.280273 , 17.089844 , 33.78711 , 10. , 10.3125 ,
10. , 37.25879 , 10.3125 , 12.712891 , 8.652344 ,
14.458984 , 83.96973 , 19.424805 , 17.804688 , 14.060547 ,
10. ], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>e1&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>7.618e+03 7.686e+03 &amp;hellip; 7.285e+03&lt;/div>&lt;input id='attrs-058e6d2f-0b04-48a0-98ac-c09d4e37b6a1' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-058e6d2f-0b04-48a0-98ac-c09d4e37b6a1' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-dd928a5f-5531-490f-9e3d-2b14d60bca14' class='xr-var-data-in' type='checkbox'>&lt;label for='data-dd928a5f-5531-490f-9e3d-2b14d60bca14' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([7617.912 , 7685.6387, 6547.1533, 7663.1045, 7262.1484, 7730.582 ,
6461.591 , 6461.591 , 7074.802 , 7617.912 , 7377.966 , 7446.9775,
6789.205 , 7842.205 , 7377.966 , 7886.5586, 7685.6387, 7180.49 ,
7930.74 , 7121.871 , 7074.802 , 6704.8984, 6140.08 , 7685.6387,
7831.091 , 7952.7676, 7354.881 , 6980.205 , 7331.758 , 7819.965 ,
6620.1465, 7764.1797, 7685.6387, 8084.0186, 7074.802 , 7145.3477,
7074.802 , 7685.6387, 6908.8594, 7527.032 , 7595.254 , 7145.3477,
7730.582 , 7819.965 , 6522.751 , 6956.461 , 7250.5117, 7039.3994,
7685.6387, 7074.802 , 7481.3477, 7730.582 , 7074.802 , 6486.082 ,
6608.004 , 5812.949 , 5247.382 , 7015.75 , 6547.1533, 7685.6387,
7285.3906], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>e2&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>7.414e+03 7.414e+03 &amp;hellip; 7.414e+03&lt;/div>&lt;input id='attrs-1bef09b0-30ab-4b29-b5e5-fc2e9eee34be' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-1bef09b0-30ab-4b29-b5e5-fc2e9eee34be' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-31228d46-83c5-4bde-b6fe-2b758ab3f47f' class='xr-var-data-in' type='checkbox'>&lt;label for='data-31228d46-83c5-4bde-b6fe-2b758ab3f47f' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>e3_0&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(z_dim, id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>0.2002 0.4365 &amp;hellip; 0.541 0.2002&lt;/div>&lt;input id='attrs-746d118f-4e8f-47be-824b-982053d3624a' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-746d118f-4e8f-47be-824b-982053d3624a' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-06009bc6-0338-461d-b438-ecca02c52b27' class='xr-var-data-in' type='checkbox'>&lt;label for='data-06009bc6-0338-461d-b438-ecca02c52b27' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[0.20019531, 0.43652344, 0.5058594 , &amp;hellip;, 1. , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &amp;hellip;, 0.9824219 , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &amp;hellip;, 0.96777344, 0.5410156 ,
0.20019531],
&amp;hellip;,
[0.20019531, 0.43652344, 0.5058594 , &amp;hellip;, 5.0214844 , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &amp;hellip;, 4.057617 , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &amp;hellip;, 3.203125 , 0.5410156 ,
0.20019531]], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>bottom_level&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>50.0 50.0 12.0 &amp;hellip; 17.0 26.0 50.0&lt;/div>&lt;input id='attrs-32212a92-138a-4b79-aebf-10dd45f58c97' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-32212a92-138a-4b79-aebf-10dd45f58c97' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-5dfe20c7-835a-4c48-90bd-fb7265178570' class='xr-var-data-in' type='checkbox'>&lt;label for='data-5dfe20c7-835a-4c48-90bd-fb7265178570' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([50., 50., 12., 32., 50., 50., 50., 50., 21., 50., 29., 42., 32.,
42., 40., 33., 50., 25., 37., 32., 21., 50., 20., 50., 44., 24.,
50., 24., 50., 43., 50., 50., 50., 34., 21., 50., 21., 50., 50.,
33., 50., 11., 50., 50., 33., 45., 29., 39., 50., 21., 50., 50.,
21., 19., 25., 25., 50., 44., 17., 26., 50.], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>landmask&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>bool&lt;/div>&lt;div class='xr-var-preview xr-preview'>False False False &amp;hellip; False False&lt;/div>&lt;input id='attrs-040f97f5-12d0-45e6-98f3-d91d001dd7b6' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-040f97f5-12d0-45e6-98f3-d91d001dd7b6' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-117e59c6-c1a9-44c4-9c90-1354f5dd9ea6' class='xr-var-data-in' type='checkbox'>&lt;label for='data-117e59c6-c1a9-44c4-9c90-1354f5dd9ea6' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-1e4888b4-8c67-4351-b170-f574373188ee' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-1e4888b4-8c67-4351-b170-f574373188ee' class='xr-section-summary' >Attributes: &lt;span>(8)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;dl class='xr-attrs'>&lt;dt>&lt;span>name :&lt;/span>&lt;/dt>&lt;dd>AMM7_1d_20070101_20070131_25hourm_grid_T&lt;/dd>&lt;dt>&lt;span>description :&lt;/span>&lt;/dt>&lt;dd>ocean T grid variables, 25h meaned&lt;/dd>&lt;dt>&lt;span>title :&lt;/span>&lt;/dt>&lt;dd>ocean T grid variables, 25h meaned&lt;/dd>&lt;dt>&lt;span>Conventions :&lt;/span>&lt;/dt>&lt;dd>CF-1.6&lt;/dd>&lt;dt>&lt;span>timeStamp :&lt;/span>&lt;/dt>&lt;dd>2019-Dec-26 04:35:28 GMT&lt;/dd>&lt;dt>&lt;span>uuid :&lt;/span>&lt;/dt>&lt;dd>96cae459-d3a1-4f4f-b82b-9259179f95f7&lt;/dd>&lt;dt>&lt;span>history :&lt;/span>&lt;/dt>&lt;dd>Tue May 19 12:07:51 2020: ncks -v votemper,sossheig -d time_counter,0,30,5 AMM7_1d_20070101_20070131_25hourm_grid_T.nc example_data.nc&lt;/dd>&lt;dt>&lt;span>NCO :&lt;/span>&lt;/dt>&lt;dd>4.4.7&lt;/dd>&lt;/dl>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/div>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>We can see that the structure for the new dataset &lt;code>model_timeseries&lt;/code>, generated from the gridded model simulation, is that of a &lt;code>tidegauge&lt;/code> object. NB in the example simulation data the ssh variable is output as 5-day means. So it is not particulatly useful for high frequency validation but serves as a demonstration of the workflow.&lt;/p>
&lt;h2 id="tidegauge-analysis-methods">Tidegauge analysis methods&lt;/h2>
&lt;p>For a good comparison, we would like to make sure that both the observed and
modelled &lt;code>Tidegauge&lt;/code> objects contain the same missing values. &lt;code>TidegaugeAnalysis&lt;/code>
contains a routine for ensuring this. First create our analysis object:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tganalysis&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">coast&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TidegaugeAnalysis&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># In this case, transpose the interpolated dataset&lt;/span>
&lt;span style="color:#000">model_timeseries&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">model_timeseries&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">transpose&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># This routine searches for missing values in each dataset and applies them&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># equally to each corresponding dataset&lt;/span>
&lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">model_new&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">match_missing_values&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">model_timeseries&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;p>Although we input data arrays to the above routine, it returns two new Tidegauge objects. Now you have equivalent and comparable sets of time series that can be easily compared.&lt;/p>
&lt;h3 id="harmonic-analysis--non-tidal-residuals">Harmonic Analysis &amp;amp; Non tidal-Residuals&lt;/h3>
&lt;p>The &lt;code>Tidegauge&lt;/code> object contains some routines which make harmonic analysis and
the calculation/comparison of non-tidal residuals easier. Harmonic analysis is
done using the &lt;code>utide&lt;/code> package. Please see &lt;a href="https://pypi.org/project/UTide/">here&lt;/a> for more info.&lt;/p>
&lt;p>First we can use the &lt;code>TidegaugeAnalysis&lt;/code> class to do a harmonic analysis. Suppose
we have two &lt;code>Tidegauge&lt;/code> objects called &lt;code>obs&lt;/code> and &lt;code>model_timeseries&lt;/code> generated from tidegauge observations and model simulations respectively.&lt;/p>
&lt;p>Then subtract means from all the time series&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># Subtract means from all time series&lt;/span>
&lt;span style="color:#000">obs_new&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">demean_timeseries&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">model_new&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">demean_timeseries&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">model_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Now you have equivalent and comparable sets of time series that can be&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># easily compared.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">figure&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">model_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">model_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;model - demeaned&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;orange&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;obs - demeaned&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;blue&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">f&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;model and observed timeseries : {obs_new.dataset.site_name.isel(id_dim=stn_id).coords}&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">legend&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">xticks&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">rotation&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">45&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">show&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_43_0.png" alt="png">&lt;/p>
&lt;p>Then we can apply the harmonic analysis (though the example data is too short for this example to be that meaningful and the model data is only saved as 5-day means! Nevertheless we proceed):&lt;/p>
&lt;h3 id="calculate-non-tidal-residuals">Calculate non tidal residuals&lt;/h3>
&lt;p>First, do a harmonic analysis. This routine uses utide&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">ha_mod&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">harmonic_analysis_utide&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">model_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">min_datapoints&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">ha_obs&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">harmonic_analysis_utide&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">min_datapoints&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
&lt;/code>&lt;/pre>
&lt;p>The &lt;code>harmonic_analysis_utide&lt;/code> routine returns a list of &lt;code>utide&lt;/code> structure object,
one for each &lt;code>id_dim&lt;/code> in the &lt;code>Tidegauge&lt;/code> object. It can be passed any of the
arguments that go to &lt;code>utide&lt;/code>. It also has an additional argument &lt;code>min_datapoints&lt;/code>
which determines a minimum number of data points for the harmonics analysis.
If a tidegauge &lt;code>id_dim&lt;/code> has less than this number, it will not return an analysis.&lt;/p>
&lt;p>Now, create new &lt;code>TidegaugeMultiple&lt;/code> objects containing reconstructed tides:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tide_mod&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reconstruct_tide_utide&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">model_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ha_mod&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">tide_obs&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reconstruct_tide_utide&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ha_obs&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
Tidegauge object at 0x55b017f74fc0 initialised
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;p>Get new TidegaugeMultiple objects containing non tidal residuals:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">ntr_mod&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">calculate_non_tidal_residuals&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">model_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tide_mod&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reconstructed&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">ntr_obs&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">calculate_non_tidal_residuals&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tide_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reconstructed&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Take a look&lt;/span>
&lt;span style="color:#000">ntr_mod&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;div>&lt;svg style="position: absolute; width: 0; height: 0; overflow: hidden">
&lt;defs>
&lt;symbol id="icon-database" viewBox="0 0 32 32">
&lt;path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z">&lt;/path>
&lt;path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;/symbol>
&lt;symbol id="icon-file-text2" viewBox="0 0 32 32">
&lt;path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z">&lt;/path>
&lt;path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;/symbol>
&lt;/defs>
&lt;/svg>
&lt;style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
*
*/
&lt;p>:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p>
&lt;p>html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p>
&lt;p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}&lt;/p>
&lt;p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p>
&lt;p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p>
&lt;p>.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p>
&lt;p>.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p>
&lt;p>.xr-section-item {
display: contents;
}&lt;/p>
&lt;p>.xr-section-item input {
display: none;
}&lt;/p>
&lt;p>.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p>
&lt;p>.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p>
&lt;p>.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;►&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;▼&amp;rsquo;;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p>
&lt;p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p>
&lt;p>.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p>
&lt;p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p>
&lt;p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p>
&lt;p>.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p>
&lt;p>.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p>
&lt;p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p>
&lt;p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p>
&lt;p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p>
&lt;p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list:before {
content: &amp;lsquo;(';
}&lt;/p>
&lt;p>.xr-dim-list:after {
content: &amp;lsquo;)';
}&lt;/p>
&lt;p>.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,';
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-has-index {
font-weight: bold;
}&lt;/p>
&lt;p>.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p>
&lt;p>.xr-var-name {
grid-column: 1;
}&lt;/p>
&lt;p>.xr-var-dims {
grid-column: 2;
}&lt;/p>
&lt;p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-var-preview {
grid-column: 4;
}&lt;/p>
&lt;p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p>
&lt;p>.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p>
&lt;p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p>
&lt;p>.xr-var-data &amp;gt; table {
float: right;
}&lt;/p>
&lt;p>.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p>
&lt;p>.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p>
&lt;p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p>
&lt;p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p>
&lt;p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p>
&lt;p>.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p>
&lt;p>.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style>&lt;pre class='xr-text-repr-fallback'>&amp;lt;xarray.Dataset&amp;gt;
Dimensions: (id_dim: 61, t_dim: 720)
Coordinates:
longitude (id_dim) float32 1.444 -4.0 -5.333 -5.111 &amp;hellip; 7.666 -9.111 8.777
latitude (id_dim) float32 51.93 51.53 58.0 51.67 &amp;hellip; 55.4 58.0 51.53 53.87
time (t_dim) datetime64[ns] 2007-01-01 &amp;hellip; 2007-01-30T23:00:00
Dimensions without coordinates: id_dim, t_dim
Data variables:
ntr (id_dim, t_dim) float64 nan nan nan &amp;hellip; -0.1131 -0.0932 -0.06751&lt;/pre>&lt;div class='xr-wrap' style='display:none'>&lt;div class='xr-header'>&lt;div class='xr-obj-type'>xarray.Dataset&lt;/div>&lt;/div>&lt;ul class='xr-sections'>&lt;li class='xr-section-item'>&lt;input id='section-da94b4eb-c5b8-48e5-b7cf-493691f43b2c' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-da94b4eb-c5b8-48e5-b7cf-493691f43b2c' class='xr-section-summary' title='Expand/collapse section'>Dimensions:&lt;/label>&lt;div class='xr-section-inline-details'>&lt;ul class='xr-dim-list'>&lt;li>&lt;span>id_dim&lt;/span>: 61&lt;/li>&lt;li>&lt;span>t_dim&lt;/span>: 720&lt;/li>&lt;/ul>&lt;/div>&lt;div class='xr-section-details'>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-6abd4387-8af0-4fb0-b3a8-a0556b87d039' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-6abd4387-8af0-4fb0-b3a8-a0556b87d039' class='xr-section-summary' >Coordinates: &lt;span>(3)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>longitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>1.444 -4.0 -5.333 &amp;hellip; -9.111 8.777&lt;/div>&lt;input id='attrs-df15d070-bb6d-4a23-9fb6-6090e9d2acb5' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-df15d070-bb6d-4a23-9fb6-6090e9d2acb5' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-d6fd227c-221f-4375-9865-0e2d746bb7c3' class='xr-var-data-in' type='checkbox'>&lt;label for='data-d6fd227c-221f-4375-9865-0e2d746bb7c3' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([ 1.4443359 , -4. , -5.333008 , -5.111328 , -3. ,
-3.1113281 , -5.2226562 , -3. , -1.4443359 , 1.4443359 ,
-4.666992 , 1.3330078 , -6.2226562 , -2.555664 , -3.7783203 ,
-4.333008 , 1.1113281 , -0.55566406, -5.555664 , -5.111328 ,
-1.4443359 , -2. , -1.1113281 , -2.8886719 , -1.8886719 ,
-6.333008 , -3.1113281 , -6.2226562 , -0. , 0.11132812,
-4. , 1.3330078 , -2.7783203 , -2.1113281 , -1.4443359 ,
-3.555664 , -1.4443359 , -2.7783203 , -3.2226562 , 1.7773438 ,
-5. , -5.555664 , -3.1113281 , -1.1113281 , -6.333008 ,
-5. , -4.7783203 , -6.666992 , -2.7783203 , -1.4443359 ,
-4.111328 , -4.111328 , -1.4443359 , 11.22168 , 11.777344 ,
4.888672 , 11.22168 , -7.333008 , 7.6660156 , -9.111328 ,
8.777344 ], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>latitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float32&lt;/div>&lt;div class='xr-var-preview xr-preview'>51.93 51.53 58.0 &amp;hellip; 51.53 53.87&lt;/div>&lt;input id='attrs-7b09d9e0-d903-4ecf-88b7-0a3cb5972fe3' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-7b09d9e0-d903-4ecf-88b7-0a3cb5972fe3' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-4a634c8b-7353-42cb-8305-beed15f335ed' class='xr-var-data-in' type='checkbox'>&lt;label for='data-4a634c8b-7353-42cb-8305-beed15f335ed' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([51.933594, 51.53418 , 58.000977, 51.666992, 54.000977, 51.26758 ,
58.467773, 58.467773, 55.067383, 51.933594, 53.333984, 52.933594,
56.66797 , 50.600586, 53.333984, 50.333984, 51.53418 , 54.467773,
50.067383, 54.80078 , 55.067383, 57.13379 , 60.20117 , 51.53418 ,
50.666992, 49.933594, 53.467773, 55.600586, 53.600586, 50.7334 ,
57.600586, 51.067383, 51.53418 , 49.13379 , 55.067383, 54.666992,
55.067383, 51.53418 , 56.000977, 52.467773, 52.067383, 54.666992,
51.26758 , 50.7334 , 58.13379 , 55.734375, 54.067383, 55.26758 ,
51.53418 , 55.067383, 52.734375, 51.26758 , 55.067383, 58.333984,
57.66797 , 61.93457 , 64.868164, 55.40039 , 58.000977, 51.53418 ,
53.867188], dtype=float32)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>time&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim)&lt;/div>&lt;div class='xr-var-dtype'>datetime64[ns]&lt;/div>&lt;div class='xr-var-preview xr-preview'>2007-01-01 &amp;hellip; 2007-01-30T23:00:00&lt;/div>&lt;input id='attrs-8257f181-ce0e-4725-83d9-3d88670f8a37' class='xr-var-attrs-in' type='checkbox' >&lt;label for='attrs-8257f181-ce0e-4725-83d9-3d88670f8a37' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-8034e749-7c3b-4c2f-b873-4ef923eab38a' class='xr-var-data-in' type='checkbox'>&lt;label for='data-8034e749-7c3b-4c2f-b873-4ef923eab38a' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;dt>&lt;span>axis :&lt;/span>&lt;/dt>&lt;dd>T&lt;/dd>&lt;dt>&lt;span>standard_name :&lt;/span>&lt;/dt>&lt;dd>time&lt;/dd>&lt;dt>&lt;span>long_name :&lt;/span>&lt;/dt>&lt;dd>Time axis&lt;/dd>&lt;dt>&lt;span>time_origin :&lt;/span>&lt;/dt>&lt;dd>1900-01-01 00:00:00&lt;/dd>&lt;dt>&lt;span>bounds :&lt;/span>&lt;/dt>&lt;dd>time_counter_bounds&lt;/dd>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', &amp;hellip;, '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-206dc412-c036-4d3d-a214-940abf68bbf2' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-206dc412-c036-4d3d-a214-940abf68bbf2' class='xr-section-summary' >Data variables: &lt;span>(1)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, t_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>nan nan nan &amp;hellip; -0.0932 -0.06751&lt;/div>&lt;input id='attrs-dde2e21d-2cdd-48f1-988b-c834f6dc08a6' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-dde2e21d-2cdd-48f1-988b-c834f6dc08a6' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-b151a7db-4657-4ca0-8e52-9cb509277dd9' class='xr-var-data-in' type='checkbox'>&lt;label for='data-b151a7db-4657-4ca0-8e52-9cb509277dd9' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[ nan, nan, nan, &amp;hellip;, -0.01578879,
-0.01832536, -0.02103986],
[ nan, nan, nan, &amp;hellip;, nan,
nan, nan],
[ nan, nan, nan, &amp;hellip;, -0.092145 ,
-0.09043849, -0.08913844],
&amp;hellip;,
[ nan, nan, nan, &amp;hellip;, -0.00689739,
-0.00588311, -0.00477213],
[ nan, nan, nan, &amp;hellip;, -0.10071189,
-0.10431121, -0.10936602],
[ nan, nan, nan, &amp;hellip;, -0.11313507,
-0.0931955 , -0.06751227]])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-44b0c31d-046b-486e-9b07-8277184fdd8e' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-44b0c31d-046b-486e-9b07-8277184fdd8e' class='xr-section-summary' title='Expand/collapse section'>Attributes: &lt;span>(0)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/div>&lt;/p>
&lt;p>The dataset structure is preserved and has created a new variable called &lt;code>ntr&lt;/code> - non-tidal residual.&lt;/p>
&lt;p>By default, this routines will apply &lt;code>scipy.signal.savgol_filter&lt;/code> to the non-tidal residuals
to remove some noise. This can be switched off using &lt;code>apply_filter = False&lt;/code>.&lt;/p>
&lt;p>The Doodson X0 filter is an alternative way of estimating non-tidal residuals. This will return a new Tidegauge() object containing filtered ssh data:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">dx0&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">doodson_x0_filter&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;ssh&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># take a look&lt;/span>
&lt;span style="color:#000">dx0&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;div>&lt;svg style="position: absolute; width: 0; height: 0; overflow: hidden">
&lt;defs>
&lt;symbol id="icon-database" viewBox="0 0 32 32">
&lt;path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z">&lt;/path>
&lt;path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;/symbol>
&lt;symbol id="icon-file-text2" viewBox="0 0 32 32">
&lt;path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z">&lt;/path>
&lt;path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;/symbol>
&lt;/defs>
&lt;/svg>
&lt;style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
*
*/
&lt;p>:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p>
&lt;p>html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p>
&lt;p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}&lt;/p>
&lt;p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p>
&lt;p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p>
&lt;p>.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p>
&lt;p>.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p>
&lt;p>.xr-section-item {
display: contents;
}&lt;/p>
&lt;p>.xr-section-item input {
display: none;
}&lt;/p>
&lt;p>.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p>
&lt;p>.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p>
&lt;p>.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;►&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;▼&amp;rsquo;;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p>
&lt;p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p>
&lt;p>.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p>
&lt;p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p>
&lt;p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p>
&lt;p>.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p>
&lt;p>.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p>
&lt;p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p>
&lt;p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p>
&lt;p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p>
&lt;p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list:before {
content: &amp;lsquo;(';
}&lt;/p>
&lt;p>.xr-dim-list:after {
content: &amp;lsquo;)';
}&lt;/p>
&lt;p>.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,';
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-has-index {
font-weight: bold;
}&lt;/p>
&lt;p>.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p>
&lt;p>.xr-var-name {
grid-column: 1;
}&lt;/p>
&lt;p>.xr-var-dims {
grid-column: 2;
}&lt;/p>
&lt;p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-var-preview {
grid-column: 4;
}&lt;/p>
&lt;p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p>
&lt;p>.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p>
&lt;p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p>
&lt;p>.xr-var-data &amp;gt; table {
float: right;
}&lt;/p>
&lt;p>.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p>
&lt;p>.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p>
&lt;p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p>
&lt;p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p>
&lt;p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p>
&lt;p>.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p>
&lt;p>.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style>&lt;pre class='xr-text-repr-fallback'>&amp;lt;xarray.Dataset&amp;gt;
Dimensions: (t_dim: 720, id_dim: 61)
Coordinates:
latitude (id_dim) float64 51.95 51.57 57.9 51.71 &amp;hellip; 58.0 51.53 53.87
site_name (id_dim) object 'Harwich' 'Mumbles' 'Ullapool' &amp;hellip; 'N/A' 'N/A'
longitude (id_dim) float64 1.292 -3.975 -5.158 -5.051 &amp;hellip; 7.567 350.8 8.717
Dimensions without coordinates: t_dim, id_dim
Data variables:
time (t_dim) datetime64[ns] 2007-01-01 &amp;hellip; 2007-01-30T23:00:00
ssh (id_dim, t_dim) float64 nan nan nan nan nan &amp;hellip; nan nan nan nan&lt;/pre>&lt;div class='xr-wrap' style='display:none'>&lt;div class='xr-header'>&lt;div class='xr-obj-type'>xarray.Dataset&lt;/div>&lt;/div>&lt;ul class='xr-sections'>&lt;li class='xr-section-item'>&lt;input id='section-18176486-467c-4eff-87a4-d00091b507ad' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-18176486-467c-4eff-87a4-d00091b507ad' class='xr-section-summary' title='Expand/collapse section'>Dimensions:&lt;/label>&lt;div class='xr-section-inline-details'>&lt;ul class='xr-dim-list'>&lt;li>&lt;span>t_dim&lt;/span>: 720&lt;/li>&lt;li>&lt;span>id_dim&lt;/span>: 61&lt;/li>&lt;/ul>&lt;/div>&lt;div class='xr-section-details'>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-1c70eb82-de4d-42e8-972a-1b902a7cbc11' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-1c70eb82-de4d-42e8-972a-1b902a7cbc11' class='xr-section-summary' >Coordinates: &lt;span>(3)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>latitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>51.95 51.57 57.9 &amp;hellip; 51.53 53.87&lt;/div>&lt;input id='attrs-4a087926-fddd-4f13-801f-c66ef69c7776' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-4a087926-fddd-4f13-801f-c66ef69c7776' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-a418920b-5c59-42ae-92ae-301fd9bc3d60' class='xr-var-data-in' type='checkbox'>&lt;label for='data-a418920b-5c59-42ae-92ae-301fd9bc3d60' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([51.94798 , 51.57 , 57.89525 , 51.7064 , 54.03167 ,
51.21525 , 58.45661 , 58.44097 , 55.00744 , 51.95675 ,
53.31394 , 52.93436 , 56.62311 , 50.6085 , 53.33167 ,
50.36839 , 51.44564 , 54.49008 , 50.103 , 54.84256 ,
55.00744 , 57.14406 , 60.15403 , 51.55 , 50.71433 ,
49.91847 , 53.44969 , 55.62742 , 53.63103 , 50.78178 ,
57.5987 , 51.11439 , 51.51089 , 49.18333 , 55.00744 ,
54.65081 , 55.00744 , 51.50002 , 55.98983 , 52.473 ,
52.01378 , 54.66475 , 51.21525 , 50.80256 , 58.20711 ,
55.74964 , 54.08539 , 55.20678 , 51.50002 , 55.00744 ,
52.71906 , 51.21097 , 55.00744 , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58. , 51.53300095,
53.86700058])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>site_name&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>object&lt;/div>&lt;div class='xr-var-preview xr-preview'>'Harwich' 'Mumbles' &amp;hellip; 'N/A' 'N/A'&lt;/div>&lt;input id='attrs-7b3b3d82-2ca6-4145-b3fd-bb192ff6c866' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-7b3b3d82-2ca6-4145-b3fd-bb192ff6c866' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-031e15d8-3ce9-4895-b210-3354be1acec2' class='xr-var-data-in' type='checkbox'>&lt;label for='data-031e15d8-3ce9-4895-b210-3354be1acec2' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &amp;quot;St. Mary's&amp;quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype=object)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>longitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>1.292 -3.975 -5.158 &amp;hellip; 350.8 8.717&lt;/div>&lt;input id='attrs-9c54dc55-a1ec-4a4c-a7ef-13864cadf878' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-9c54dc55-a1ec-4a4c-a7ef-13864cadf878' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-3d0d6a1a-d4b8-4a08-a70f-f5a2375ed332' class='xr-var-data-in' type='checkbox'>&lt;label for='data-3d0d6a1a-d4b8-4a08-a70f-f5a2375ed332' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00, 1.34839000e+00, -4.62044000e+00, 1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01, 5.70300000e-02, -4.00220000e+00, 1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00, 1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00, 1.12150002e+01, 1.18000002e+01, 5.11700010e+00,
1.12500000e+01, 3.52666992e+02, 7.56699991e+00, 3.50816986e+02,
8.71700001e+00])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-a14e6992-c681-44cc-992e-0c3a06bcc43a' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-a14e6992-c681-44cc-992e-0c3a06bcc43a' class='xr-section-summary' >Data variables: &lt;span>(2)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>time&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim)&lt;/div>&lt;div class='xr-var-dtype'>datetime64[ns]&lt;/div>&lt;div class='xr-var-preview xr-preview'>2007-01-01 &amp;hellip; 2007-01-30T23:00:00&lt;/div>&lt;input id='attrs-c2a4b2e9-333a-4d06-b1aa-58581cd1e038' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-c2a4b2e9-333a-4d06-b1aa-58581cd1e038' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-8ee1ac7a-f703-4a80-b6ad-fc92150ba4bc' class='xr-var-data-in' type='checkbox'>&lt;label for='data-8ee1ac7a-f703-4a80-b6ad-fc92150ba4bc' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&amp;hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>ssh&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, t_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>nan nan nan nan &amp;hellip; nan nan nan nan&lt;/div>&lt;input id='attrs-1661a4ca-644a-4cd1-bd3a-8b8e6a69360d' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-1661a4ca-644a-4cd1-bd3a-8b8e6a69360d' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-0554ef79-ef91-4dfb-9749-4d93d49e0329' class='xr-var-data-in' type='checkbox'>&lt;label for='data-0554ef79-ef91-4dfb-9749-4d93d49e0329' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[nan, nan, nan, &amp;hellip;, nan, nan, nan],
[nan, nan, nan, &amp;hellip;, nan, nan, nan],
[nan, nan, nan, &amp;hellip;, nan, nan, nan],
&amp;hellip;,
[nan, nan, nan, &amp;hellip;, nan, nan, nan],
[nan, nan, nan, &amp;hellip;, nan, nan, nan],
[nan, nan, nan, &amp;hellip;, nan, nan, nan]])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-44ecce65-5250-4c8a-a455-6cb1b1bb1b23' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-44ecce65-5250-4c8a-a455-6cb1b1bb1b23' class='xr-section-summary' title='Expand/collapse section'>Attributes: &lt;span>(0)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/div>&lt;/p>
&lt;p>We can compare these analyses e.g. the observed timeseries against the harmonic reconstruction. Noting we can in principle extend the harmoninc reconstruction beyond the observation time window.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">figure&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">tide_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tide_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reconstructed&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;reconstructed from harmonics&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;orange&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;observed&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;blue&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">legend&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">xticks&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">rotation&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">45&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">show&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_55_0.png" alt="png">&lt;/p>
&lt;p>We can also look closer at the difference between the observed timeseries and the harmonic reconstruction, that is the non-tidal residual. And we can compare the observed and modelled non-harmonic residual and contrast the different methods of removing the tides. Here we contrast using a harmonic analysis (and creating a &amp;ldquo;non-tidal residual&amp;rdquo;) with the DoodsonX0 filter. Note that the timeseries is far too short for a sensible analysis and that this is really a demonstration of concept.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">figure&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">subplot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">dx0&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">dx0&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ssh&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;obs: doodsonX0 filtered&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;orange&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">ntr_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ntr_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ntr&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;obs: non-tidal residual&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;blue&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;analysis comparison: non-tidal residual vs doodsonX0&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">legend&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">xticks&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">rotation&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">45&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">subplot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">ntr_mod&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ntr_mod&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ntr&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;model: non-tidal residual&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;g&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">ntr_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ntr_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ntr&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;obs: non-tidal residual&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">color&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;blue&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;model vs observation: non-tidal residual&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">legend&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">xticks&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">rotation&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">45&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">tight_layout&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_57_0.png" alt="png">&lt;/p>
&lt;h3 id="threshold-statistics-for-non-tidal-residuals">Threshold Statistics for non-tidal residuals&lt;/h3>
&lt;p>This is a simple extreme value analysis of whatever data you use. It will count the number of peaks and the total time spent over each threshold provided. It will also count the numbers of daily and monthly maxima over each threshold. To this, a Tidegauge object and an array of thresholds (in metres) should be passed. The method return &lt;code>peak_count_*&lt;/code>, &lt;code>time_over_threshold_*&lt;/code>, &lt;code>dailymax_count_*&lt;/code>, &lt;code>monthlymax_count_*&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">thresh_mod&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">threshold_statistics&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ntr_mod&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">thresholds&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">arange&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0.1&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;span style="color:#000">thresh_obs&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">threshold_statistics&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ntr_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">thresholds&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">arange&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0.1&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#8f5902;font-style:italic"># Have a look&lt;/span>
&lt;span style="color:#000">thresh_obs&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div>&lt;svg style="position: absolute; width: 0; height: 0; overflow: hidden">
&lt;defs>
&lt;symbol id="icon-database" viewBox="0 0 32 32">
&lt;path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z">&lt;/path>
&lt;path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;/symbol>
&lt;symbol id="icon-file-text2" viewBox="0 0 32 32">
&lt;path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z">&lt;/path>
&lt;path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;/symbol>
&lt;/defs>
&lt;/svg>
&lt;style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
*
*/
&lt;p>:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p>
&lt;p>html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p>
&lt;p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}&lt;/p>
&lt;p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p>
&lt;p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p>
&lt;p>.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p>
&lt;p>.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p>
&lt;p>.xr-section-item {
display: contents;
}&lt;/p>
&lt;p>.xr-section-item input {
display: none;
}&lt;/p>
&lt;p>.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p>
&lt;p>.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p>
&lt;p>.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;►&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;▼&amp;rsquo;;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p>
&lt;p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p>
&lt;p>.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p>
&lt;p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p>
&lt;p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p>
&lt;p>.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p>
&lt;p>.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p>
&lt;p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p>
&lt;p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p>
&lt;p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p>
&lt;p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list:before {
content: &amp;lsquo;(';
}&lt;/p>
&lt;p>.xr-dim-list:after {
content: &amp;lsquo;)';
}&lt;/p>
&lt;p>.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,';
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-has-index {
font-weight: bold;
}&lt;/p>
&lt;p>.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p>
&lt;p>.xr-var-name {
grid-column: 1;
}&lt;/p>
&lt;p>.xr-var-dims {
grid-column: 2;
}&lt;/p>
&lt;p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-var-preview {
grid-column: 4;
}&lt;/p>
&lt;p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p>
&lt;p>.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p>
&lt;p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p>
&lt;p>.xr-var-data &amp;gt; table {
float: right;
}&lt;/p>
&lt;p>.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p>
&lt;p>.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p>
&lt;p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p>
&lt;p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p>
&lt;p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p>
&lt;p>.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p>
&lt;p>.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style>&lt;pre class='xr-text-repr-fallback'>&amp;lt;xarray.Dataset&amp;gt;
Dimensions: (t_dim: 720, id_dim: 61, threshold: 40)
Coordinates:
latitude (id_dim) float64 51.95 51.57 57.9 &amp;hellip; 51.53 53.87
site_name (id_dim) object 'Harwich' 'Mumbles' &amp;hellip; 'N/A' 'N/A'
longitude (id_dim) float64 1.292 -3.975 &amp;hellip; 350.8 8.717&lt;/p>
&lt;ul>
&lt;li>threshold (threshold) float64 -2.0 -1.9 -1.8 &amp;hellip; 1.7 1.8 1.9
Dimensions without coordinates: t_dim, id_dim
Data variables:
time (t_dim) datetime64[ns] 2007-01-01 &amp;hellip; 2007-01-30&amp;hellip;
peak_count_ntr (id_dim, threshold) float64 24.0 24.0 &amp;hellip; 0.0 0.0
time_over_threshold_ntr (id_dim, threshold) float64 671.0 671.0 &amp;hellip; 0.0 0.0
dailymax_count_ntr (id_dim, threshold) float64 29.0 29.0 &amp;hellip; 0.0 0.0
monthlymax_count_ntr (id_dim, threshold) float64 1.0 1.0 1.0 &amp;hellip; 0.0 0.0&lt;/pre>&lt;div class='xr-wrap' style='display:none'>&lt;div class='xr-header'>&lt;div class='xr-obj-type'>xarray.Dataset&lt;/div>&lt;/div>&lt;ul class='xr-sections'>&lt;li class='xr-section-item'>&lt;input id='section-dfa0d6be-e49b-45af-860f-68cdd51166ca' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-dfa0d6be-e49b-45af-860f-68cdd51166ca' class='xr-section-summary' title='Expand/collapse section'>Dimensions:&lt;/label>&lt;div class='xr-section-inline-details'>&lt;ul class='xr-dim-list'>&lt;li>&lt;span>t_dim&lt;/span>: 720&lt;/li>&lt;li>&lt;span>id_dim&lt;/span>: 61&lt;/li>&lt;li>&lt;span class='xr-has-index'>threshold&lt;/span>: 40&lt;/li>&lt;/ul>&lt;/div>&lt;div class='xr-section-details'>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-c8668914-8a81-436a-9e39-d588631b26ee' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-c8668914-8a81-436a-9e39-d588631b26ee' class='xr-section-summary' >Coordinates: &lt;span>(4)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>latitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>51.95 51.57 57.9 &amp;hellip; 51.53 53.87&lt;/div>&lt;input id='attrs-abc4f9d6-51c9-4c85-b386-f65bd3101bd7' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-abc4f9d6-51c9-4c85-b386-f65bd3101bd7' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-37492dfb-be2f-4692-a73f-2cd0f96f71a3' class='xr-var-data-in' type='checkbox'>&lt;label for='data-37492dfb-be2f-4692-a73f-2cd0f96f71a3' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([51.94798 , 51.57 , 57.89525 , 51.7064 , 54.03167 ,
51.21525 , 58.45661 , 58.44097 , 55.00744 , 51.95675 ,
53.31394 , 52.93436 , 56.62311 , 50.6085 , 53.33167 ,
50.36839 , 51.44564 , 54.49008 , 50.103 , 54.84256 ,
55.00744 , 57.14406 , 60.15403 , 51.55 , 50.71433 ,
49.91847 , 53.44969 , 55.62742 , 53.63103 , 50.78178 ,
57.5987 , 51.11439 , 51.51089 , 49.18333 , 55.00744 ,
54.65081 , 55.00744 , 51.50002 , 55.98983 , 52.473 ,
52.01378 , 54.66475 , 51.21525 , 50.80256 , 58.20711 ,
55.74964 , 54.08539 , 55.20678 , 51.50002 , 55.00744 ,
52.71906 , 51.21097 , 55.00744 , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58. , 51.53300095,
53.86700058])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>site_name&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>object&lt;/div>&lt;div class='xr-var-preview xr-preview'>'Harwich' 'Mumbles' &amp;hellip; 'N/A' 'N/A'&lt;/div>&lt;input id='attrs-af34b280-a096-4232-b4ec-9295391caacc' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-af34b280-a096-4232-b4ec-9295391caacc' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-c7be59b1-f7eb-4a20-9eb4-7087c1e61c68' class='xr-var-data-in' type='checkbox'>&lt;label for='data-c7be59b1-f7eb-4a20-9eb4-7087c1e61c68' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &amp;quot;St. Mary's&amp;quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype=object)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>longitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>1.292 -3.975 -5.158 &amp;hellip; 350.8 8.717&lt;/div>&lt;input id='attrs-4463471d-e5e0-48c6-9870-8776aca3dbe1' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-4463471d-e5e0-48c6-9870-8776aca3dbe1' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-5831b90c-493b-4ac5-bcc4-93ce5e258ecb' class='xr-var-data-in' type='checkbox'>&lt;label for='data-5831b90c-493b-4ac5-bcc4-93ce5e258ecb' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00, 1.34839000e+00, -4.62044000e+00, 1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01, 5.70300000e-02, -4.00220000e+00, 1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00, 1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00, 1.12150002e+01, 1.18000002e+01, 5.11700010e+00,
1.12500000e+01, 3.52666992e+02, 7.56699991e+00, 3.50816986e+02,
8.71700001e+00])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span class='xr-has-index'>threshold&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(threshold)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>-2.0 -1.9 -1.8 -1.7 &amp;hellip; 1.7 1.8 1.9&lt;/div>&lt;input id='attrs-4b4dd4f6-5424-48b2-a934-8b5977a80af4' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-4b4dd4f6-5424-48b2-a934-8b5977a80af4' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-9589750a-b1cf-4636-af71-da65a5c5e413' class='xr-var-data-in' type='checkbox'>&lt;label for='data-9589750a-b1cf-4636-af71-da65a5c5e413' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([-2.000000e+00, -1.900000e+00, -1.800000e+00, -1.700000e+00,
-1.600000e+00, -1.500000e+00, -1.400000e+00, -1.300000e+00,
-1.200000e+00, -1.100000e+00, -1.000000e+00, -9.000000e-01,
-8.000000e-01, -7.000000e-01, -6.000000e-01, -5.000000e-01,
-4.000000e-01, -3.000000e-01, -2.000000e-01, -1.000000e-01,
1.776357e-15, 1.000000e-01, 2.000000e-01, 3.000000e-01,
4.000000e-01, 5.000000e-01, 6.000000e-01, 7.000000e-01,
8.000000e-01, 9.000000e-01, 1.000000e+00, 1.100000e+00,
1.200000e+00, 1.300000e+00, 1.400000e+00, 1.500000e+00,
1.600000e+00, 1.700000e+00, 1.800000e+00, 1.900000e+00])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-3b9ee740-61af-48cb-9b97-d160cfaec8bb' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-3b9ee740-61af-48cb-9b97-d160cfaec8bb' class='xr-section-summary' >Data variables: &lt;span>(5)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>time&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim)&lt;/div>&lt;div class='xr-var-dtype'>datetime64[ns]&lt;/div>&lt;div class='xr-var-preview xr-preview'>2007-01-01 &amp;hellip; 2007-01-30T23:00:00&lt;/div>&lt;input id='attrs-6c1607dc-1565-4843-b5ef-af0ce7ec0115' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-6c1607dc-1565-4843-b5ef-af0ce7ec0115' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-81fc6d90-ce8e-4cd3-bd5d-26017c1dcc41' class='xr-var-data-in' type='checkbox'>&lt;label for='data-81fc6d90-ce8e-4cd3-bd5d-26017c1dcc41' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&amp;hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>peak_count_ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, threshold)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>24.0 24.0 24.0 24.0 &amp;hellip; 0.0 0.0 0.0&lt;/div>&lt;input id='attrs-d2d84dbe-a6d7-4e1c-9ccb-6eaa6f700f4d' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-d2d84dbe-a6d7-4e1c-9ccb-6eaa6f700f4d' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-51a6e0f6-57d4-4f3c-ac4a-2f6ac6f32a69' class='xr-var-data-in' type='checkbox'>&lt;label for='data-51a6e0f6-57d4-4f3c-ac4a-2f6ac6f32a69' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[24., 24., 24., &amp;hellip;, 0., 0., 0.],
[14., 14., 14., &amp;hellip;, 0., 0., 0.],
[21., 21., 21., &amp;hellip;, 0., 0., 0.],
&amp;hellip;,
[23., 23., 23., &amp;hellip;, 0., 0., 0.],
[30., 30., 30., &amp;hellip;, 0., 0., 0.],
[24., 24., 24., &amp;hellip;, 0., 0., 0.]])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>time_over_threshold_ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, threshold)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>671.0 671.0 671.0 &amp;hellip; 0.0 0.0 0.0&lt;/div>&lt;input id='attrs-4ce83047-b6e8-4f0e-af84-64aee4e12efa' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-4ce83047-b6e8-4f0e-af84-64aee4e12efa' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-5ca2b5d9-b567-4944-a777-81cf2caf4435' class='xr-var-data-in' type='checkbox'>&lt;label for='data-5ca2b5d9-b567-4944-a777-81cf2caf4435' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[671., 671., 671., &amp;hellip;, 0., 0., 0.],
[341., 341., 341., &amp;hellip;, 0., 0., 0.],
[671., 671., 671., &amp;hellip;, 0., 0., 0.],
&amp;hellip;,
[696., 696., 696., &amp;hellip;, 0., 0., 0.],
[696., 696., 696., &amp;hellip;, 0., 0., 0.],
[696., 696., 696., &amp;hellip;, 0., 0., 0.]])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>dailymax_count_ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, threshold)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>29.0 29.0 29.0 29.0 &amp;hellip; 0.0 0.0 0.0&lt;/div>&lt;input id='attrs-41f692f2-7a4d-4c33-9c7f-36b3fddec3b4' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-41f692f2-7a4d-4c33-9c7f-36b3fddec3b4' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-e62c1c3f-45fc-4ac3-b21f-f5cd471f649d' class='xr-var-data-in' type='checkbox'>&lt;label for='data-e62c1c3f-45fc-4ac3-b21f-f5cd471f649d' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[29., 29., 29., &amp;hellip;, 0., 0., 0.],
[15., 15., 15., &amp;hellip;, 0., 0., 0.],
[29., 29., 29., &amp;hellip;, 0., 0., 0.],
&amp;hellip;,
[29., 29., 29., &amp;hellip;, 0., 0., 0.],
[29., 29., 29., &amp;hellip;, 0., 0., 0.],
[29., 29., 29., &amp;hellip;, 0., 0., 0.]])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>monthlymax_count_ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, threshold)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 &amp;hellip; 0.0 0.0 0.0 0.0&lt;/div>&lt;input id='attrs-df778a08-2447-4bfc-8204-29e65dec0545' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-df778a08-2447-4bfc-8204-29e65dec0545' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-4e167f8f-3d57-4f62-bc92-0e4e29c790df' class='xr-var-data-in' type='checkbox'>&lt;label for='data-4e167f8f-3d57-4f62-bc92-0e4e29c790df' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[1., 1., 1., &amp;hellip;, 0., 0., 0.],
[1., 1., 1., &amp;hellip;, 0., 0., 0.],
[1., 1., 1., &amp;hellip;, 0., 0., 0.],
&amp;hellip;,
[1., 1., 1., &amp;hellip;, 0., 0., 0.],
[1., 1., 1., &amp;hellip;, 0., 0., 0.],
[1., 1., 1., &amp;hellip;, 0., 0., 0.]])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-eec88999-e951-4c90-a796-660a378b0ccd' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-eec88999-e951-4c90-a796-660a378b0ccd' class='xr-section-summary' title='Expand/collapse section'>Attributes: &lt;span>(0)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/div>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">thresh_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">threshold&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">thresh_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">peak_count_ntr&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">mean&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;id_dim&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#plt.ylim([0,15])&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">f&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Observed peaks over threshold&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">xlabel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;Analysis threshold (m)&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ylabel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;event count&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Text(0, 0.5, 'event count')
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_61_1.png" alt="png">&lt;/p>
&lt;p>Note that the non-tidal residual is a noisy timeseries (computed as a difference between two timeseries) so peaks do not necessarily correspond to peaks in total water level. For this reason &lt;code>time_over_threshold_*&lt;/code> can be useful. Below we see that about 6% (y-axis) of the observations of non-tidal residual exceed 20cm (x-axis). Again, threshold statistics are more useful with a longer record.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">normalised_event_count&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">100&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span> &lt;span style="color:#000">thresh_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time_over_threshold_ntr&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">/&lt;/span> &lt;span style="color:#000">thresh_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time_over_threshold_ntr&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id_dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">stn_id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">max&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span> &lt;span style="color:#000">thresh_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">threshold&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">normalised_event_count&lt;/span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ylim&lt;/span>&lt;span style="color:#000;font-weight:bold">([&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">20&lt;/span>&lt;span style="color:#000;font-weight:bold">])&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">xlim&lt;/span>&lt;span style="color:#000;font-weight:bold">([&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0.1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0.4&lt;/span>&lt;span style="color:#000;font-weight:bold">])&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">f&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;time over threshold&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">xlabel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;Analysis threshold (m)&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ylabel&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;normalised event count (%)&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">plt&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">thresh_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">threshold&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">22&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span> &lt;span style="color:#000">normalised_event_count&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">22&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;r+&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">markersize&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">20&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>[&amp;lt;matplotlib.lines.Line2D at 0x7f7f56a97c40&amp;gt;]
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_63_1.png" alt="png">&lt;/p>
&lt;h2 id="other-tidegaugeanalysis-methods">Other TidegaugeAnalysis methods&lt;/h2>
&lt;h3 id="calculate-errors">Calculate errors&lt;/h3>
&lt;p>The difference() routine will calculate differences, absolute_differences and squared differenced for all variables. Corresponding new variables are created with names &lt;code>diff_*&lt;/code>, &lt;code>abs_diff_*&lt;/code> and &lt;code>square_diff_*&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">ntr_diff&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">difference&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ntr_obs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ntr_mod&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">ssh_diff&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tganalysis&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">difference&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">obs_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">model_new&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Take a look&lt;/span>
&lt;span style="color:#000">ntr_diff&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
&lt;/code>&lt;/pre>
&lt;div>&lt;svg style="position: absolute; width: 0; height: 0; overflow: hidden">
&lt;defs>
&lt;symbol id="icon-database" viewBox="0 0 32 32">
&lt;path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z">&lt;/path>
&lt;path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z">&lt;/path>
&lt;/symbol>
&lt;symbol id="icon-file-text2" viewBox="0 0 32 32">
&lt;path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z">&lt;/path>
&lt;path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z">&lt;/path>
&lt;/symbol>
&lt;/defs>
&lt;/svg>
&lt;style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
*
*/
&lt;p>:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p>
&lt;p>html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p>
&lt;p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}&lt;/p>
&lt;p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p>
&lt;p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p>
&lt;p>.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p>
&lt;p>.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p>
&lt;p>.xr-section-item {
display: contents;
}&lt;/p>
&lt;p>.xr-section-item input {
display: none;
}&lt;/p>
&lt;p>.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p>
&lt;p>.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p>
&lt;p>.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;►&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p>
&lt;p>.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;▼&amp;rsquo;;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p>
&lt;p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p>
&lt;p>.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p>
&lt;p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p>
&lt;p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p>
&lt;p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p>
&lt;p>.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p>
&lt;p>.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p>
&lt;p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p>
&lt;p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p>
&lt;p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p>
&lt;p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p>
&lt;p>.xr-dim-list:before {
content: &amp;lsquo;(';
}&lt;/p>
&lt;p>.xr-dim-list:after {
content: &amp;lsquo;)';
}&lt;/p>
&lt;p>.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,';
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-has-index {
font-weight: bold;
}&lt;/p>
&lt;p>.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p>
&lt;p>.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p>
&lt;p>.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p>
&lt;p>.xr-var-name {
grid-column: 1;
}&lt;/p>
&lt;p>.xr-var-dims {
grid-column: 2;
}&lt;/p>
&lt;p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p>
&lt;p>.xr-var-preview {
grid-column: 4;
}&lt;/p>
&lt;p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p>
&lt;p>.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p>
&lt;p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p>
&lt;p>.xr-var-data &amp;gt; table {
float: right;
}&lt;/p>
&lt;p>.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p>
&lt;p>.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p>
&lt;p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p>
&lt;p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p>
&lt;p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p>
&lt;p>.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p>
&lt;p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p>
&lt;p>.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style>&lt;pre class='xr-text-repr-fallback'>&amp;lt;xarray.Dataset&amp;gt;
Dimensions: (t_dim: 720, id_dim: 61)
Coordinates:
time (t_dim) datetime64[ns] 2007-01-01 &amp;hellip; 2007-01-30T23:00:00
site_name (id_dim) object 'Harwich' 'Mumbles' &amp;hellip; 'N/A' 'N/A'
longitude (id_dim) float64 1.292 -3.975 -5.158 &amp;hellip; 7.567 350.8 8.717
latitude (id_dim) float64 51.95 51.57 57.9 &amp;hellip; 58.0 51.53 53.87
Dimensions without coordinates: t_dim, id_dim
Data variables:
diff_ntr (id_dim, t_dim) float64 nan nan nan &amp;hellip; -0.07105 0.03123
abs_diff_ntr (id_dim, t_dim) float64 nan nan nan &amp;hellip; 0.07105 0.03123
square_diff_ntr (id_dim, t_dim) float64 nan nan nan &amp;hellip; 0.005049 0.0009752&lt;/pre>&lt;div class='xr-wrap' style='display:none'>&lt;div class='xr-header'>&lt;div class='xr-obj-type'>xarray.Dataset&lt;/div>&lt;/div>&lt;ul class='xr-sections'>&lt;li class='xr-section-item'>&lt;input id='section-6c449353-357b-48a6-94af-02b2461b758a' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-6c449353-357b-48a6-94af-02b2461b758a' class='xr-section-summary' title='Expand/collapse section'>Dimensions:&lt;/label>&lt;div class='xr-section-inline-details'>&lt;ul class='xr-dim-list'>&lt;li>&lt;span>t_dim&lt;/span>: 720&lt;/li>&lt;li>&lt;span>id_dim&lt;/span>: 61&lt;/li>&lt;/ul>&lt;/div>&lt;div class='xr-section-details'>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-d2ca5e25-32f8-4650-b84b-f1955415a076' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-d2ca5e25-32f8-4650-b84b-f1955415a076' class='xr-section-summary' >Coordinates: &lt;span>(4)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>time&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(t_dim)&lt;/div>&lt;div class='xr-var-dtype'>datetime64[ns]&lt;/div>&lt;div class='xr-var-preview xr-preview'>2007-01-01 &amp;hellip; 2007-01-30T23:00:00&lt;/div>&lt;input id='attrs-a0092f46-f5e0-42f7-8248-52c805d27053' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-a0092f46-f5e0-42f7-8248-52c805d27053' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-9e5ecfb8-82b5-41b6-ad5a-b87b93e39e5c' class='xr-var-data-in' type='checkbox'>&lt;label for='data-9e5ecfb8-82b5-41b6-ad5a-b87b93e39e5c' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&amp;hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>site_name&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>object&lt;/div>&lt;div class='xr-var-preview xr-preview'>'Harwich' 'Mumbles' &amp;hellip; 'N/A' 'N/A'&lt;/div>&lt;input id='attrs-11ddd461-94b7-4470-86bf-547d5bca7947' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-11ddd461-94b7-4470-86bf-547d5bca7947' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-8833ce95-b586-4f74-9e7b-01944f60a954' class='xr-var-data-in' type='checkbox'>&lt;label for='data-8833ce95-b586-4f74-9e7b-01944f60a954' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &amp;quot;St. Mary's&amp;quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype=object)&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>longitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>1.292 -3.975 -5.158 &amp;hellip; 350.8 8.717&lt;/div>&lt;input id='attrs-926dbbd1-f9e6-43d0-b63d-232bff841fc9' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-926dbbd1-f9e6-43d0-b63d-232bff841fc9' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-70e355cd-9c7e-4f65-9399-afe44a216d7d' class='xr-var-data-in' type='checkbox'>&lt;label for='data-70e355cd-9c7e-4f65-9399-afe44a216d7d' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00, 1.34839000e+00, -4.62044000e+00, 1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01, 5.70300000e-02, -4.00220000e+00, 1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00, 1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00, 1.12150002e+01, 1.18000002e+01, 5.11700010e+00,
1.12500000e+01, 3.52666992e+02, 7.56699991e+00, 3.50816986e+02,
8.71700001e+00])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>latitude&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>51.95 51.57 57.9 &amp;hellip; 51.53 53.87&lt;/div>&lt;input id='attrs-d04f01cb-14ea-48d1-8664-63fde41b8c6a' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-d04f01cb-14ea-48d1-8664-63fde41b8c6a' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-ef81cae3-512a-4740-8baa-9b965ee22885' class='xr-var-data-in' type='checkbox'>&lt;label for='data-ef81cae3-512a-4740-8baa-9b965ee22885' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([51.94798 , 51.57 , 57.89525 , 51.7064 , 54.03167 ,
51.21525 , 58.45661 , 58.44097 , 55.00744 , 51.95675 ,
53.31394 , 52.93436 , 56.62311 , 50.6085 , 53.33167 ,
50.36839 , 51.44564 , 54.49008 , 50.103 , 54.84256 ,
55.00744 , 57.14406 , 60.15403 , 51.55 , 50.71433 ,
49.91847 , 53.44969 , 55.62742 , 53.63103 , 50.78178 ,
57.5987 , 51.11439 , 51.51089 , 49.18333 , 55.00744 ,
54.65081 , 55.00744 , 51.50002 , 55.98983 , 52.473 ,
52.01378 , 54.66475 , 51.21525 , 50.80256 , 58.20711 ,
55.74964 , 54.08539 , 55.20678 , 51.50002 , 55.00744 ,
52.71906 , 51.21097 , 55.00744 , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58. , 51.53300095,
53.86700058])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-50d2ce45-a14e-435f-b66c-ff3200167a65' class='xr-section-summary-in' type='checkbox' checked>&lt;label for='section-50d2ce45-a14e-435f-b66c-ff3200167a65' class='xr-section-summary' >Data variables: &lt;span>(3)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;ul class='xr-var-list'>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>diff_ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, t_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>nan nan nan &amp;hellip; -0.07105 0.03123&lt;/div>&lt;input id='attrs-2f196afa-96b7-48ba-bd3a-82d05aaa58fd' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-2f196afa-96b7-48ba-bd3a-82d05aaa58fd' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-b18e9ca9-a1ab-419d-a5ba-74ff69ec252f' class='xr-var-data-in' type='checkbox'>&lt;label for='data-b18e9ca9-a1ab-419d-a5ba-74ff69ec252f' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[ nan, nan, nan, &amp;hellip;, -0.27055282,
-0.24161073, -0.19948584],
[ nan, nan, nan, &amp;hellip;, nan,
nan, nan],
[ nan, nan, nan, &amp;hellip;, 0.26775999,
0.29183498, 0.31725988],
&amp;hellip;,
[ nan, nan, nan, &amp;hellip;, -0.13722572,
-0.15640233, -0.18539439],
[ nan, nan, nan, &amp;hellip;, 0.05165766,
0.07687488, 0.10824192],
[ nan, nan, nan, &amp;hellip;, -0.15185874,
-0.07105414, 0.03122864]])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>abs_diff_ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, t_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>nan nan nan &amp;hellip; 0.07105 0.03123&lt;/div>&lt;input id='attrs-1faf83b7-a4df-4b05-ba94-f734fdab38f1' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-1faf83b7-a4df-4b05-ba94-f734fdab38f1' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-34e46e85-d788-4417-97d2-e74cd6724a7e' class='xr-var-data-in' type='checkbox'>&lt;label for='data-34e46e85-d788-4417-97d2-e74cd6724a7e' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[ nan, nan, nan, &amp;hellip;, 0.27055282, 0.24161073,
0.19948584],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, 0.26775999, 0.29183498,
0.31725988],
&amp;hellip;,
[ nan, nan, nan, &amp;hellip;, 0.13722572, 0.15640233,
0.18539439],
[ nan, nan, nan, &amp;hellip;, 0.05165766, 0.07687488,
0.10824192],
[ nan, nan, nan, &amp;hellip;, 0.15185874, 0.07105414,
0.03122864]])&lt;/pre>&lt;/div>&lt;/li>&lt;li class='xr-var-item'>&lt;div class='xr-var-name'>&lt;span>square_diff_ntr&lt;/span>&lt;/div>&lt;div class='xr-var-dims'>(id_dim, t_dim)&lt;/div>&lt;div class='xr-var-dtype'>float64&lt;/div>&lt;div class='xr-var-preview xr-preview'>nan nan nan &amp;hellip; 0.005049 0.0009752&lt;/div>&lt;input id='attrs-91120bcc-f4c7-4582-b9b1-c32a3520cae7' class='xr-var-attrs-in' type='checkbox' disabled>&lt;label for='attrs-91120bcc-f4c7-4582-b9b1-c32a3520cae7' title='Show/Hide attributes'>&lt;svg class='icon xr-icon-file-text2'>&lt;use xlink:href='#icon-file-text2'>&lt;/use>&lt;/svg>&lt;/label>&lt;input id='data-65a8b825-c111-4642-90ef-180d23b18f6c' class='xr-var-data-in' type='checkbox'>&lt;label for='data-65a8b825-c111-4642-90ef-180d23b18f6c' title='Show/Hide data repr'>&lt;svg class='icon xr-icon-database'>&lt;use xlink:href='#icon-database'>&lt;/use>&lt;/svg>&lt;/label>&lt;div class='xr-var-attrs'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;div class='xr-var-data'>&lt;pre>array([[ nan, nan, nan, &amp;hellip;, 0.07319883, 0.05837574,
0.0397946 ],
[ nan, nan, nan, &amp;hellip;, nan, nan,
nan],
[ nan, nan, nan, &amp;hellip;, 0.07169541, 0.08516766,
0.10065383],
&amp;hellip;,
[ nan, nan, nan, &amp;hellip;, 0.0188309 , 0.02446169,
0.03437108],
[ nan, nan, nan, &amp;hellip;, 0.00266851, 0.00590975,
0.01171631],
[ nan, nan, nan, &amp;hellip;, 0.02306108, 0.00504869,
0.00097523]])&lt;/pre>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/li>&lt;li class='xr-section-item'>&lt;input id='section-640679e3-653d-472a-9a32-f5466d002c65' class='xr-section-summary-in' type='checkbox' disabled >&lt;label for='section-640679e3-653d-472a-9a32-f5466d002c65' class='xr-section-summary' title='Expand/collapse section'>Attributes: &lt;span>(0)&lt;/span>&lt;/label>&lt;div class='xr-section-inline-details'>&lt;/div>&lt;div class='xr-section-details'>&lt;dl class='xr-attrs'>&lt;/dl>&lt;/div>&lt;/li>&lt;/ul>&lt;/div>&lt;/div>&lt;/p>
&lt;p>We can then easily get mean errors, MAE and MSE&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">mean_stats&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">ntr_diff&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">mean&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dim&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;t_dim&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">skipna&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#3465a4">True&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: Tidetable tutorial</title><link>https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/tidetable_tutorial/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/tidetable_tutorial/</guid><description>
&lt;h3 id="tutorial-for-processing-tabulated-tide-gauge-data">Tutorial for processing tabulated tide gauge data.&lt;/h3>
&lt;p>Tidal highs and lows can be scraped from a website such as:&lt;br>
&lt;a href="https://www.ntslf.org/tides/tidepred?port=Liverpool">https://www.ntslf.org/tides/tidepred?port=Liverpool&lt;/a>&lt;br>
&lt;img src="https://www.ntslf.org/files/ntslf_php/plottide.php?port=Liverpool" alt="NTSLF tidal predictions">&lt;/p>
&lt;p>and format them into a csv file:&lt;br>&lt;/p>
&lt;p>LIVERPOOL (GLADSTONE DOCK) TZ: UT(GMT)/BST Units: METRES Datum: Chart Datum&lt;br>
01/10/2020 06:29 1.65&lt;br>
01/10/2020 11:54 9.01&lt;br>
01/10/2020 18:36 1.87&lt;br>&lt;/p>
&lt;p>The data can be used in the following demonstration.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">coast&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">numpy&lt;/span> &lt;span style="color:#204a87;font-weight:bold">as&lt;/span> &lt;span style="color:#000">np&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Load and plot High and Low Water data.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#204a87;font-weight:bold">print&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;load and plot HLW data&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">filnam&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;./example_files/Gladstone_2020-10_HLW.txt&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>load and plot HLW data
&lt;/code>&lt;/pre>
&lt;p>Set the start and end dates.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">date_start&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-12 23:59&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">date_end&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-14 00:01&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Initiate a TideGauge object, if a filename is passed it assumes it is a GESLA type object.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tg&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">coast&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Tidegauge&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Tidegauge object at 0x562ea4546fc0 initialised
&lt;/code>&lt;/pre>
&lt;p>Specify the data read as a High Low Water dataset.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">read_hlw&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">filnam&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">date_start&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">date_end&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Show dataset. If timezone is specified then it is presented as requested, otherwise uses UTC.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#204a87;font-weight:bold">print&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Try the TideGauge.show() method:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">show&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">timezone&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Europe/London&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Try the TideGauge.show() method:
&lt;/code>&lt;/pre>
&lt;p>Do a basic plot of these points.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">dataset&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">plot&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">scatter&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">x&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;time&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">y&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;ssh&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>&amp;lt;matplotlib.collections.PathCollection at 0x7f13b809efa0&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://british-oceanographic-data-centre.github.io/COAsT/COAsT/tidetable_tutorial_files/tidetable_tutorial_14_1.png" alt="png">&lt;/p>
&lt;p>There is a method to locate HLW events around an approximate date and time.
First state the time of interest.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">time_guess&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-13 12:48&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then recover all the HLW events in a +/- window, of specified size (iteger hrs).
The default winsize = 2 (hrs).&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">HLW&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">get_tide_table_times&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-13 12:48&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">method&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;window&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">winsize&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">24&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Alternatively recover the closest HLW event to the input timestamp.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">HLW&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">get_tide_table_times&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-13 12:48&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">method&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;nearest_1&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or the nearest two events to the input timestamp.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">HLW&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">get_tide_table_times&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-13 12:48&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">method&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;nearest_2&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Extract the Low Tide value.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#204a87;font-weight:bold">print&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Try the TideGauge.get_tidetabletimes() methods:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">print&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;LT:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">argmin&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)]&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">values&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;m at&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">argmin&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)]&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">values&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>Try the TideGauge.get_tidetabletimes() methods:
LT: 2.83 m at 2020-10-13T14:36:00.000000000
&lt;/code>&lt;/pre>
&lt;p>Extract the High Tide value.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#204a87;font-weight:bold">print&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;HT:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">argmax&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)]&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">values&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;m at&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">argmax&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">HLW&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)]&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">values&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>HT: 8.01 m at 2020-10-13T07:59:00.000000000
&lt;/code>&lt;/pre>
&lt;p>Or use the the nearest High Tide method to get High Tide.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">HT&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">get_tide_table_times&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-13 12:48&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">method&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;nearest_HW&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">print&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;HT:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">HT&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">values&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;m at&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">HT&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">time&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">values&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre>&lt;code>HT: [8.01] m at 2020-10-13T07:59:00.000000000
&lt;/code>&lt;/pre>
&lt;p>The get_tidetabletimes() method can take extra paremeters such as a window size, an integer number of hours to seek either side of the guess.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#000">HLW&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">get_tide_table_times&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-13 12:48&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">winsize&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">method&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;nearest_1&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">HLW&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tg&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">get_tide_table_times&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">np&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">.&lt;/span>&lt;span style="color:#000">datetime64&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2020-10-13 12:48&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#000">winsize&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">method&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;nearest_1&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">
&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>