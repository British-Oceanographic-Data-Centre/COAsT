<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.120.1"><meta name=robots content="index, follow"><script>(function(e,t,n,s,o,i){e.hj=e.hj||function(){(e.hj.q=e.hj.q||[]).push(arguments)},e._hjSettings={hjid:2044976,hjsv:6},o=t.getElementsByTagName("head")[0],i=t.createElement("script"),i.async=1,i.src=n+e._hjSettings.hjid+s+e._hjSettings.hjsv,o.appendChild(i)})(window,document,"https://static.hotjar.com/c/hotjar-",".js?sv=")</script><link rel="shortcut icon" href=/COAsT/favicons/favicon.ico><link rel=apple-touch-icon href=/COAsT/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/COAsT/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/COAsT/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/COAsT/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/COAsT/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/COAsT/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/COAsT/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/COAsT/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/COAsT/favicons/android-192x192.png sizes=192x192><title>Tidegauge validation tutorial | COAsT</title>
<meta name=description content="Tidegauge validation tutorial example.
"><meta property="og:title" content="Tidegauge validation tutorial"><meta property="og:description" content="Tidegauge validation tutorial example.
"><meta property="og:type" content="article"><meta property="og:url" content="https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/tidegauge_validation_tutorial/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-12-11T15:35:41+00:00"><meta property="og:site_name" content="COAsT"><meta itemprop=name content="Tidegauge validation tutorial"><meta itemprop=description content="Tidegauge validation tutorial example.
"><meta itemprop=dateModified content="2023-12-11T15:35:41+00:00"><meta itemprop=wordCount content="8656"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Tidegauge validation tutorial"><meta name=twitter:description content="Tidegauge validation tutorial example.
"><link rel=preload href=/COAsT/scss/main.min.9ea668271d9cdb20cf5fafff492172753cbe6b2901c4edde11672505be0584b4.css as=style><link href=/COAsT/scss/main.min.9ea668271d9cdb20cf5fafff492172753cbe6b2901c4edde11672505be0584b4.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.3.min.js integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-page><header><nav class="td-navbar navbar-dark js-navbar-scroll"><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/COAsT/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=navbar-brand__name>COAsT</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class="navbar-nav text-white"><li class=nav-item><a class="nav-link text-white" href=/COAsT/#home><span>Home</span></a></li><li class=nav-item><a class="nav-link text-white" href=/COAsT/#about><span>About</span></a></li><li class=nav-item><a class="nav-link text-white" href=/COAsT/#community><span>Community</span></a></li><li class=nav-item><a class="nav-link text-white" href=/COAsT/docs/><span>Documentation</span></a></li><li class=nav-item><a class="nav-link text-white" target=_blank href=https://github.com/British-Oceanographic-Data-Centre/COAsT><span><i class="fab fa-github ml-2"></i></span></a></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/COAsT/offline-search-index.17b95881d89c62e6fe9be92a87199edd.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/COAsT/offline-search-index.17b95881d89c62e6fe9be92a87199edd.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-coastdocs-li><a href=/COAsT/docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-coastdocs><span>COAsT Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-coastdocsoverview-li><a href=/COAsT/docs/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-coastdocsgetting-started-li><a href=/COAsT/docs/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsgetting-started><span>Getting Started</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-coastdocsexamples-li><a href=/COAsT/docs/examples/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsexamples><span>Usage</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-coastdocsexamplesnotebooks-li><a href=/COAsT/docs/examples/notebooks/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsexamplesnotebooks><span>Tutorials - Notebooks</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-coastdocsexamplesnotebooksgridded-li><a href=/COAsT/docs/examples/notebooks/gridded/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsexamplesnotebooksgridded><span>Gridded</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgriddedcontour_tutorial-li><a href=/COAsT/docs/examples/notebooks/gridded/contour_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedcontour_tutorial><span>Contour tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgriddedintroduction_to_gridded_class-li><a href=/COAsT/docs/examples/notebooks/gridded/introduction_to_gridded_class/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedintroduction_to_gridded_class><span>Introduction to gridded class</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgriddedpotential_energy_tutorial-li><a href=/COAsT/docs/examples/notebooks/gridded/potential_energy_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedpotential_energy_tutorial><span>Potential energy tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgriddedpycnocline_tutorial-li><a href=/COAsT/docs/examples/notebooks/gridded/pycnocline_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedpycnocline_tutorial><span>Pycnocline tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgriddedregridding_with_xesmf_tutorial-li><a href=/COAsT/docs/examples/notebooks/gridded/regridding_with_xesmf_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedregridding_with_xesmf_tutorial><span>Regridding with xesmf tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgriddedseasia_dic_example_plot_tutorial-li><a href=/COAsT/docs/examples/notebooks/gridded/seasia_dic_example_plot_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedseasia_dic_example_plot_tutorial><span>Seasia dic example plot tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgriddedtransect_tutorial-li><a href=/COAsT/docs/examples/notebooks/gridded/transect_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedtransect_tutorial><span>Transect tutorial</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-coastdocsexamplesnotebooksgeneral-li><a href=/COAsT/docs/examples/notebooks/general/ title="General utility and analysis tools" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsexamplesnotebooksgeneral><span>General utility</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneralclimatology_tutorial-li><a href=/COAsT/docs/examples/notebooks/general/climatology_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralclimatology_tutorial><span>Climatology tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneraldask_wrapper_template_tutorial-li><a href=/COAsT/docs/examples/notebooks/general/dask_wrapper_template_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneraldask_wrapper_template_tutorial><span>Dask wrapper template tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneraleof_tutorial-li><a href=/COAsT/docs/examples/notebooks/general/eof_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneraleof_tutorial><span>Eof tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneralexport_to_netcdf_tutorial-li><a href=/COAsT/docs/examples/notebooks/general/export_to_netcdf_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralexport_to_netcdf_tutorial><span>Export to netcdf tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneralmask_maker_tutorial-li><a href=/COAsT/docs/examples/notebooks/general/mask_maker_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralmask_maker_tutorial><span>Mask maker tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneralpolar_plotting-li><a href=/COAsT/docs/examples/notebooks/general/polar_plotting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralpolar_plotting><span>Polar plotting</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneralseasonal_decomp_example-li><a href=/COAsT/docs/examples/notebooks/general/seasonal_decomp_example/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralseasonal_decomp_example><span>Seasonal decomp example</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksgeneralzarr_files-li><a href=/COAsT/docs/examples/notebooks/general/zarr_files/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralzarr_files><span>Zarr files</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-coastdocsexamplesnotebooksaltimetry-li><a href=/COAsT/docs/examples/notebooks/altimetry/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsexamplesnotebooksaltimetry><span>Altimety</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksaltimetryaltimetry_tutorial-li><a href=/COAsT/docs/examples/notebooks/altimetry/altimetry_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksaltimetryaltimetry_tutorial><span>Altimetry tutorial</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-coastdocsexamplesnotebooksprofile-li><a href=/COAsT/docs/examples/notebooks/profile/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsexamplesnotebooksprofile><span>Profile</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksprofileintroduction_to_profile_class-li><a href=/COAsT/docs/examples/notebooks/profile/introduction_to_profile_class/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofileintroduction_to_profile_class><span>Introduction to profile class</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsexamplesnotebooksprofilewod_bgc_ragged_example-li><a href=/COAsT/docs/examples/notebooks/profile/wod_bgc_ragged_example/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofilewod_bgc_ragged_example><span>Wod bgc ragged example</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-coastdocsexamplesnotebookstidegauge-li><a href=/COAsT/docs/examples/notebooks/tidegauge/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsexamplesnotebookstidegauge><span>Tidegauge</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-coastdocsexamplesnotebookstidegaugetidegauge_validation_tutorial-li><a href=/COAsT/docs/examples/notebooks/tidegauge/tidegauge_validation_tutorial/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebookstidegaugetidegauge_validation_tutorial><span class=td-sidebar-nav-active-item>Tidegauge validation tutorial</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-coastdocsexamplesnotebookstidegaugetidetable_tutorial-li><a href=/COAsT/docs/examples/notebooks/tidegauge/tidetable_tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebookstidegaugetidetable_tutorial><span>Tidetable tutorial</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-coastdocsexamplesconfigs_gallery-li><a href=/COAsT/docs/examples/configs_gallery/ title="Example scripts and Gallery" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesconfigs_gallery><span>Example scripts and gallery</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-coastdocscontributing-li><a href=/COAsT/docs/contributing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocscontributing><span>Contributing to COAsT</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocscontributingbug_report-li><a href=/COAsT/docs/contributing/bug_report/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributingbug_report><span>Bug Report</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocscontributingcontributing-docs-li><a href=/COAsT/docs/contributing/contributing-docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributingcontributing-docs><span>Contributing: Documentation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-coastdocscontributingcontributing-package-li><a href=/COAsT/docs/contributing/contributing-package/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocscontributingcontributing-package><span>Contributing to the Package</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocscontributingcontributing-packagecode_styling-li><a href=/COAsT/docs/contributing/contributing-package/code_styling/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributingcontributing-packagecode_styling><span>Code styling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocscontributingcontributing-packagecode_structure-li><a href=/COAsT/docs/contributing/contributing-package/code_structure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributingcontributing-packagecode_structure><span>Code structure</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-coastdocsgeneral-information-li><a href=/COAsT/docs/general-information/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsgeneral-information><span>General Information</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsgeneral-informationpython_logging-li><a href=/COAsT/docs/general-information/python_logging/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsgeneral-informationpython_logging><span>Logging</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsgeneral-informationlazy-loading-li><a href=/COAsT/docs/general-information/lazy-loading/ title="Working Lazily" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsgeneral-informationlazy-loading><span>Lazy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsgeneral-informationdask-li><a href=/COAsT/docs/general-information/dask/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsgeneral-informationdask><span>Dask</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsgeneral-informationbuild_test-li><a href=/COAsT/docs/general-information/build_test/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsgeneral-informationbuild_test><span>Build test</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsgeneral-informationgithub_actions_flowchart-li><a href=/COAsT/docs/general-information/github_actions_flowchart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsgeneral-informationgithub_actions_flowchart><span>Github Actions Flowchart</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsgeneral-informationpush_to_master-li><a href=/COAsT/docs/general-information/push_to_master/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsgeneral-informationpush_to_master><span>Push to master</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-coastdocsreference-li><a href=/COAsT/docs/reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-coastdocsreference><span>API Reference</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencealtimetry-li><a href=/COAsT/docs/reference/altimetry/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencealtimetry><span>Altimetry</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceargos-li><a href=/COAsT/docs/reference/argos/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceargos><span>Argos</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceclimatology-li><a href=/COAsT/docs/reference/climatology/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceclimatology><span>Climatology</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencecoast-li><a href=/COAsT/docs/reference/coast/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecoast><span>Coast</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceconfig_parser-li><a href=/COAsT/docs/reference/config_parser/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceconfig_parser><span>Config_parser</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceconfig_structure-li><a href=/COAsT/docs/reference/config_structure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceconfig_structure><span>Config_structure</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencecontour-li><a href=/COAsT/docs/reference/contour/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecontour><span>Contour</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencecopernicus-li><a href=/COAsT/docs/reference/copernicus/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecopernicus><span>Copernicus</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencecrps_util-li><a href=/COAsT/docs/reference/crps_util/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecrps_util><span>Crps_util</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencedocsy_tools-li><a href=/COAsT/docs/reference/docsy_tools/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencedocsy_tools><span>Docsy_tools</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceeof-li><a href=/COAsT/docs/reference/eof/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceeof><span>Eof</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceexperiments_file_handling-li><a href=/COAsT/docs/reference/experiments_file_handling/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceexperiments_file_handling><span>Experiments_file_handling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencegeneral_utils-li><a href=/COAsT/docs/reference/general_utils/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencegeneral_utils><span>General_utils</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceglider-li><a href=/COAsT/docs/reference/glider/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceglider><span>Glider</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencegridded-li><a href=/COAsT/docs/reference/gridded/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencegridded><span>Gridded</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceindex_class-li><a href=/COAsT/docs/reference/index_class/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceindex_class><span>Index</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencelagrangian-li><a href=/COAsT/docs/reference/lagrangian/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencelagrangian><span>Lagrangian</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencelogging_util-li><a href=/COAsT/docs/reference/logging_util/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencelogging_util><span>Logging_util</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencemask_maker-li><a href=/COAsT/docs/reference/mask_maker/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencemask_maker><span>Mask_maker</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceoceanparcels-li><a href=/COAsT/docs/reference/oceanparcels/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceoceanparcels><span>Oceanparcels</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceopendap-li><a href=/COAsT/docs/reference/opendap/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceopendap><span>Opendap</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceplot_util-li><a href=/COAsT/docs/reference/plot_util/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceplot_util><span>Plot_util</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceprofile-li><a href=/COAsT/docs/reference/profile/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceprofile><span>Profile</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceprofile_analysis-li><a href=/COAsT/docs/reference/profile_analysis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceprofile_analysis><span>Profile_analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferenceseasons-li><a href=/COAsT/docs/reference/seasons/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceseasons><span>Seasons</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencestats_util-li><a href=/COAsT/docs/reference/stats_util/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencestats_util><span>Stats_util</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencetidegauge-li><a href=/COAsT/docs/reference/tidegauge/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetidegauge><span>Tidegauge</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencetidegauge_analysis-li><a href=/COAsT/docs/reference/tidegauge_analysis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetidegauge_analysis><span>Tidegauge_analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencetimeseries-li><a href=/COAsT/docs/reference/timeseries/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetimeseries><span>Timeseries</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencetrack-li><a href=/COAsT/docs/reference/track/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetrack><span>Track</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-coastdocsreferencexesmf_convert-li><a href=/COAsT/docs/reference/xesmf_convert/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencexesmf_convert><span>Xesmf_convert</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/British-Oceanographic-Data-Centre/COAsT-site/tree/main/content/en/docs/Examples/Notebooks/Tidegauge/tidegauge_validation_tutorial.md class=td-page-meta--view target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/British-Oceanographic-Data-Centre/COAsT-site/edit/main/content/en/docs/Examples/Notebooks/Tidegauge/tidegauge_validation_tutorial.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/British-Oceanographic-Data-Centre/COAsT-site/new/main/content/en/docs/Examples/Notebooks/Tidegauge/tidegauge_validation_tutorial.md?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/British-Oceanographic-Data-Centre/COAsT-site/issues/new?title=Tidegauge%20validation%20tutorial" class=td-page-meta--issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/British-Oceanographic-Data-Centre/COAsT/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><ul><li><a href=#import-necessary-libraries>Import necessary libraries</a></li><li><a href=#define-paths>Define paths</a></li><li><a href=#reading-data>Reading data</a></li></ul></li><li><a href=#quick-plotting-to-visualise-tidegauge-data>Quick plotting to visualise Tidegauge data</a></li><li><a href=#basic-manipulation-subsetting--plotting>Basic manipulation: subsetting + plotting</a><ul><li><a href=#gridded-model-comparison>Gridded model comparison</a></li><li><a href=#interpolate-model-data-onto-obs-locations>Interpolate model data onto obs locations</a></li></ul></li><li><a href=#tidegauge-analysis-methods>Tidegauge analysis methods</a><ul><li><a href=#harmonic-analysis--non-tidal-residuals>Harmonic Analysis & Non tidal-Residuals</a></li><li><a href=#calculate-non-tidal-residuals>Calculate non tidal residuals</a></li><li><a href=#threshold-statistics-for-non-tidal-residuals>Threshold Statistics for non-tidal residuals</a></li></ul></li><li><a href=#other-tidegaugeanalysis-methods>Other TidegaugeAnalysis methods</a><ul><li><a href=#calculate-errors>Calculate errors</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/>COAsT Documentation</a></li><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/>Usage</a></li><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/>Tutorials - Notebooks</a></li><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/>Tidegauge</a></li><li class="breadcrumb-item active" aria-current=page>Tidegauge validation tutorial</li></ol></nav><div class=td-content><h1>Tidegauge validation tutorial</h1><div class=lead>Tidegauge validation tutorial example.</div><header class=article-meta><p class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>&nbsp; 41 minute read &nbsp;</p></header><p>This tutorial gives an overview of some of validation tools available when
using the Tidegauge objects in COAsT.</p><p>This includes:</p><ul><li>creating tidegauge objects<ul><li>reading in tidegauge data</li><li>creating tidegauge object from gridded simulation data</li></ul></li><li>basic plotting<ul><li>on maps and timeseries</li></ul></li><li>analysis<ul><li>harmonic analysis and calculation of non-tidal residual</li><li>doodsonX0 tidal filtering</li><li>threshold statistics</li><li>error calculation: mean errors, mean absolute error (MAE), mean square error (MSE)</li></ul></li></ul><h3 id=import-necessary-libraries>Import necessary libraries</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>xarray</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>xr</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>coast</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>datetime</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>matplotlib.pyplot</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>plt</span>
</span></span></code></pre></div><pre><code>/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pydap/lib.py:5: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('pydap')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('pydap.responses')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('pydap')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('pydap.handlers')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('pydap')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('pydap.tests')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('pydap')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sphinxcontrib')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
</code></pre><h3 id=define-paths>Define paths</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>fn_dom</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_NEMO_DOMAIN&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000>fn_dat</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_NEMO_DATA&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000>fn_config</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_CONFIG.json&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000>fn_tg</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_TIDEGAUGE_NETCDF&gt;&#34;</span>  <span style=color:#8f5902;font-style:italic># This should already be processed, on the same time dimension</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Change this to 0 to not use default files.</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>#print(f&#34;Use default files&#34;)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;./example_files/&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fn_dom</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;coast_example_nemo_domain.nc&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fn_dat</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;coast_example_nemo_data.nc&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fn_config</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;./config/example_nemo_grid_t.json&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fn_tidegauge</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;tide_gauges/lowestoft-p024-uk-bodc&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fn_tidegauge_bodc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;tide_gauges/LIV2010.txt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fn_tg</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;tide_gauges/coast_example_tidegauges.nc&#34;</span>  <span style=color:#8f5902;font-style:italic># These are a collection (xr.DataSet) of tidegauge observations. Created for this demonstration, they are synthetic.</span>
</span></span></code></pre></div><h3 id=reading-data>Reading data</h3><p>We can create our empty tidegauge object:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>tidegauge</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Tidegauge</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><p>The <code>Tidegauge</code> class contains multiple methods for reading different typical
tidegauge formats. This includes reading from the GESLA and BODC databases.
To read a gesla file between two dates, we can use:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>date0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>date1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>tidegauge</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_gesla</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_tidegauge</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>date_start</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>date0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>date_end</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>date1</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>A Tidegauge object is a type of Timeseries object, so it has the form:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>tidegauge</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</span></span></code></pre></div><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,#000);&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body[data-theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1F1F1F;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111111;&ndash;xr-background-color-row-even:#111111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(&rsquo;; }</p> <p>.xr-dim-list:after { content: &lsquo;)&rsquo}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,&rsquo;padding-right:5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-index-preview{grid-column:2/5;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data,.xr-index-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data,.xr-index-data-in:checked~.xr-index-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-index-name div,.xr-index-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data,.xr-index-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2,.xr-no-icon{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:    (id_dim: 1, t_dim: 193)
Coordinates:
time       (t_dim) datetime64[ns] 2007-01-10 &hellip; 2007-01-12
longitude  (id_dim) float64 1.751
latitude   (id_dim) float64 52.47
site_name  (id_dim) &lt;U9 'Lowestoft'
Dimensions without coordinates: id_dim, t_dim
Data variables:
ssh        (id_dim, t_dim) float64 2.818 2.823 2.871 &hellip; 3.214 3.257 3.371
qc_flags   (id_dim, t_dim) int64 1 1 1 1 1 1 1 1 1 1 &hellip; 1 1 1 1 1 1 1 1 1 1</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-34ebdc94-c8d9-4b36-830a-86e3410b29fd class=xr-section-summary-in type=checkbox disabled><label for=section-34ebdc94-c8d9-4b36-830a-86e3410b29fd class=xr-section-summary title='Expand/collapse section'>Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>id_dim</span>: 1</li><li><span>t_dim</span>: 193</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-9dd31f22-4dfa-418f-9bf4-4c113328475a class=xr-section-summary-in type=checkbox checked><label for=section-9dd31f22-4dfa-418f-9bf4-4c113328475a class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2007-01-10 &mldr; 2007-01-12</div><input id=attrs-26d3752f-a73d-4c95-96ff-6b9dd7af6554 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-26d3752f-a73d-4c95-96ff-6b9dd7af6554 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-1ef99546-1bbc-4f19-a760-09fb4cf32012 class=xr-var-data-in type=checkbox><label for=data-1ef99546-1bbc-4f19-a760-09fb4cf32012 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-10T00:00:00.000000000', '2007-01-10T00:15:00.000000000',
'2007-01-10T00:30:00.000000000', '2007-01-10T00:45:00.000000000',
'2007-01-10T01:00:00.000000000', '2007-01-10T01:15:00.000000000',
'2007-01-10T01:30:00.000000000', '2007-01-10T01:45:00.000000000',
'2007-01-10T02:00:00.000000000', '2007-01-10T02:15:00.000000000',
'2007-01-10T02:30:00.000000000', '2007-01-10T02:45:00.000000000',
'2007-01-10T03:00:00.000000000', '2007-01-10T03:15:00.000000000',
'2007-01-10T03:30:00.000000000', '2007-01-10T03:45:00.000000000',
'2007-01-10T04:00:00.000000000', '2007-01-10T04:15:00.000000000',
'2007-01-10T04:30:00.000000000', '2007-01-10T04:45:00.000000000',
'2007-01-10T05:00:00.000000000', '2007-01-10T05:15:00.000000000',
'2007-01-10T05:30:00.000000000', '2007-01-10T05:45:00.000000000',
'2007-01-10T06:00:00.000000000', '2007-01-10T06:15:00.000000000',
'2007-01-10T06:30:00.000000000', '2007-01-10T06:45:00.000000000',
'2007-01-10T07:00:00.000000000', '2007-01-10T07:15:00.000000000',
'2007-01-10T07:30:00.000000000', '2007-01-10T07:45:00.000000000',
'2007-01-10T08:00:00.000000000', '2007-01-10T08:15:00.000000000',
'2007-01-10T08:30:00.000000000', '2007-01-10T08:45:00.000000000',
'2007-01-10T09:00:00.000000000', '2007-01-10T09:15:00.000000000',
'2007-01-10T09:30:00.000000000', '2007-01-10T09:45:00.000000000',
&hellip;
'2007-01-11T14:30:00.000000000', '2007-01-11T14:45:00.000000000',
'2007-01-11T15:00:00.000000000', '2007-01-11T15:15:00.000000000',
'2007-01-11T15:30:00.000000000', '2007-01-11T15:45:00.000000000',
'2007-01-11T16:00:00.000000000', '2007-01-11T16:15:00.000000000',
'2007-01-11T16:30:00.000000000', '2007-01-11T16:45:00.000000000',
'2007-01-11T17:00:00.000000000', '2007-01-11T17:15:00.000000000',
'2007-01-11T17:30:00.000000000', '2007-01-11T17:45:00.000000000',
'2007-01-11T18:00:00.000000000', '2007-01-11T18:15:00.000000000',
'2007-01-11T18:30:00.000000000', '2007-01-11T18:45:00.000000000',
'2007-01-11T19:00:00.000000000', '2007-01-11T19:15:00.000000000',
'2007-01-11T19:30:00.000000000', '2007-01-11T19:45:00.000000000',
'2007-01-11T20:00:00.000000000', '2007-01-11T20:15:00.000000000',
'2007-01-11T20:30:00.000000000', '2007-01-11T20:45:00.000000000',
'2007-01-11T21:00:00.000000000', '2007-01-11T21:15:00.000000000',
'2007-01-11T21:30:00.000000000', '2007-01-11T21:45:00.000000000',
'2007-01-11T22:00:00.000000000', '2007-01-11T22:15:00.000000000',
'2007-01-11T22:30:00.000000000', '2007-01-11T22:45:00.000000000',
'2007-01-11T23:00:00.000000000', '2007-01-11T23:15:00.000000000',
'2007-01-11T23:30:00.000000000', '2007-01-11T23:45:00.000000000',
'2007-01-12T00:00:00.000000000'], dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>1.751</div><input id=attrs-61d55d50-4e59-400a-875e-dbb34f547d1e class=xr-var-attrs-in type=checkbox disabled><label for=attrs-61d55d50-4e59-400a-875e-dbb34f547d1e title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-341ddb64-2d25-4ab2-8af1-cf80bddd6f70 class=xr-var-data-in type=checkbox><label for=data-341ddb64-2d25-4ab2-8af1-cf80bddd6f70 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([1.75083])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>52.47</div><input id=attrs-b1fc0a8d-7d7f-4af8-a87b-90ccc80d6ac5 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-b1fc0a8d-7d7f-4af8-a87b-90ccc80d6ac5 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-b05ed7e4-e771-4fed-a814-e939b98501b0 class=xr-var-data-in type=checkbox><label for=data-b05ed7e4-e771-4fed-a814-e939b98501b0 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([52.473])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>&lt;U9</div><div class='xr-var-preview xr-preview'>'Lowestoft'</div><input id=attrs-da1ea3c2-8a6b-4bdb-a508-961f7a50eb4b class=xr-var-attrs-in type=checkbox disabled><label for=attrs-da1ea3c2-8a6b-4bdb-a508-961f7a50eb4b title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-8db4d0ef-a1de-4b5d-a5f1-cb1dd4bc3ed4 class=xr-var-data-in type=checkbox><label for=data-8db4d0ef-a1de-4b5d-a5f1-cb1dd4bc3ed4 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Lowestoft'], dtype='&lt;U9')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-b2d1c5e7-5d91-4a60-974b-8416edbcacec class=xr-section-summary-in type=checkbox checked><label for=section-b2d1c5e7-5d91-4a60-974b-8416edbcacec class=xr-section-summary>Data variables: <span>(2)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>ssh</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>2.818 2.823 2.871 &mldr; 3.257 3.371</div><input id=attrs-676e4233-10ed-4b77-bae0-635320de3b5d class=xr-var-attrs-in type=checkbox disabled><label for=attrs-676e4233-10ed-4b77-bae0-635320de3b5d title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-6bf211a6-8623-4fa0-b231-c9da41c07460 class=xr-var-data-in type=checkbox><label for=data-6bf211a6-8623-4fa0-b231-c9da41c07460 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[ 2.818,  2.823,  2.871,  2.931,  2.961,  2.979,  2.953,  2.913,
2.864,  2.806,  2.723,  2.664,  2.606,  2.511,  2.43 ,  2.379,
2.296,  2.201,  2.105,  2.006,  1.908,  1.801,  1.684,  1.579,
1.494,  1.402,  1.306,  1.233,  1.171,  1.102,  1.054,  1.028,
0.989,  0.97 ,  0.983,  1.004,  1.026,  1.068,  1.153,  1.225,
1.296,  1.362,  1.436,  1.481,  1.536,  1.615,  1.695,  1.726,
1.802,  1.842,  1.86 ,  1.872,  1.897,  1.912,  1.946,  1.994,
2.006,  2.028,  2.067,  2.081,  2.098,  2.137,  2.113,  2.068,
2.053,  1.985,  1.917,  1.869,  1.803,  1.695,  1.642,  1.545,
1.463,  1.463,  1.466,  1.462,  1.476,  1.524,  1.574,  1.633,
1.661,  1.717,  1.818,  1.918,  2.018,  2.093,  2.14 ,  2.223,
2.278,  2.303,  2.372,  2.375,  2.395,  2.468,  2.481,  2.487,
2.535,  2.543,  2.578,  2.621,  2.627,  2.626,  2.585,  2.563,
2.529,  2.451,  2.335,  2.207,  2.086,  1.982,  1.855,  1.741,
1.618,  1.531,  1.429,  1.342,  1.246,  1.141,  1.031,  0.902,
0.784,  0.673,  0.571,  0.457,  0.323,  0.203,  0.13 ,  0.056,
-0.028, -0.077, -0.093, -0.143, -0.181, -0.211, -0.217, -0.182,
-0.1  , -0.046,  0.02 ,  0.121,  0.247,  0.358,  0.468,  0.65 ,
0.845,  0.987,  1.059,  1.199,  1.322,  1.38 ,  1.465,  1.519,
1.559,  1.691,  1.775,  1.844,  2.019,  2.113,  2.159,  2.266,
2.311,  2.406,  2.512,  2.533,  2.43 ,  2.309,  2.185,  2.136,
2.086,  2.066,  2.114,  2.114,  2.051,  2.033,  2.055,  2.1  ,
2.192,  2.278,  2.334,  2.421,  2.497,  2.548,  2.603,  2.679,
2.803,  2.859,  2.875,  3.001,  3.075,  3.135,  3.214,  3.257,
3.371]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>qc_flags</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 1 &mldr; 1 1 1 1 1 1 1 1</div><input id=attrs-7c069c7e-2653-4b9e-998d-2f6eb38ed1c4 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-7c069c7e-2653-4b9e-998d-2f6eb38ed1c4 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-c4285569-37b1-4568-ac1a-00c55633e8ab class=xr-var-data-in type=checkbox><label for=data-c4285569-37b1-4568-ac1a-00c55633e8ab title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-0f7c34b1-9fb4-4a0a-a4b8-fba86aac8382 class=xr-section-summary-in type=checkbox disabled><label for=section-0f7c34b1-9fb4-4a0a-a4b8-fba86aac8382 class=xr-section-summary title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list></ul></div></li><li class=xr-section-item><input id=section-354f749b-5cbe-47dd-a2dd-3ec8273af6b8 class=xr-section-summary-in type=checkbox disabled><label for=section-354f749b-5cbe-47dd-a2dd-3ec8273af6b8 class=xr-section-summary title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></p><p>You can do the same for BODC data:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>date0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime64</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;2020-10-11 07:59&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>date1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime64</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;2020-10-20 20:21&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>tidegauge</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_bodc</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_tidegauge_bodc</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>date0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>date1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>tidegauge</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</span></span></code></pre></div><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,#000);&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body[data-theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1F1F1F;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111111;&ndash;xr-background-color-row-even:#111111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(&rsquo;; }</p> <p>.xr-dim-list:after { content: &lsquo;)&rsquo}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,&rsquo;padding-right:5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-index-preview{grid-column:2/5;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data,.xr-index-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data,.xr-index-data-in:checked~.xr-index-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-index-name div,.xr-index-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data,.xr-index-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2,.xr-no-icon{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:    (id_dim: 1, t_dim: 914)
Coordinates:
time       (t_dim) datetime64[ns] 2020-10-11T08:00:00 &hellip; 2020-10-20T20:1&hellip;
longitude  (id_dim) float64 -3.018
latitude   (id_dim) float64 53.45
site_name  (id_dim) &lt;U25 'liverpool,_gladstone_dock'
Dimensions without coordinates: id_dim, t_dim
Data variables:
ssh        (id_dim, t_dim) float64 5.369 5.196 5.032 &hellip; 1.668 1.568 1.545
qc_flags   (id_dim, t_dim) &lt;U1 'M' 'M' 'M' 'M' 'M' &hellip; 'M' 'M' 'M' 'M' 'M'
Attributes:
port:               p234
site:               liverpool,<em>gladstone_dock
start_date:         01oct2020-00.00.00
end_date:           31oct2020-23.45.00
contributor:        national_oceanography_centre,<em>liverpool
datum_information:  the_data_refer_to_admiralty_chart_datum</em>(acd)
parameter_code:     aslvbg02</em>=<em>surface_elevation</em>(unspecified_datum)_of_t&hellip;</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-8a87da73-5465-4097-ab6c-9e30595a8814 class=xr-section-summary-in type=checkbox disabled><label for=section-8a87da73-5465-4097-ab6c-9e30595a8814 class=xr-section-summary title='Expand/collapse section'>Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>id_dim</span>: 1</li><li><span>t_dim</span>: 914</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-c1e7f6ad-f230-46b0-a964-941819cda5af class=xr-section-summary-in type=checkbox checked><label for=section-c1e7f6ad-f230-46b0-a964-941819cda5af class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-10-11T08:00:00 &mldr; 2020-10-&mldr;</div><input id=attrs-d73ab8bf-4078-4f2c-827e-b5910bae7735 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-d73ab8bf-4078-4f2c-827e-b5910bae7735 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-4f8e7c35-99f2-4162-a844-8291458188d1 class=xr-var-data-in type=checkbox><label for=data-4f8e7c35-99f2-4162-a844-8291458188d1 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2020-10-11T08:00:00.000000000', '2020-10-11T08:15:00.000000000',
'2020-10-11T08:30:00.000000000', '2020-10-11T08:45:00.000000000',
'2020-10-11T09:00:00.000000000', '2020-10-11T09:15:00.000000000',
'2020-10-11T09:30:00.000000000', '2020-10-11T09:45:00.000000000',
'2020-10-11T10:00:00.000000000', '2020-10-11T10:15:00.000000000',
'2020-10-11T10:30:00.000000000', '2020-10-11T10:45:00.000000000',
'2020-10-11T11:00:00.000000000', '2020-10-11T11:15:00.000000000',
'2020-10-11T11:30:00.000000000', '2020-10-11T11:45:00.000000000',
'2020-10-11T12:00:00.000000000', '2020-10-11T12:15:00.000000000',
'2020-10-11T12:30:00.000000000', '2020-10-11T12:45:00.000000000',
'2020-10-11T13:00:00.000000000', '2020-10-11T13:15:00.000000000',
'2020-10-11T13:30:00.000000000', '2020-10-11T13:45:00.000000000',
'2020-10-11T14:00:00.000000000', '2020-10-11T14:15:00.000000000',
'2020-10-11T14:30:00.000000000', '2020-10-11T14:45:00.000000000',
'2020-10-11T15:00:00.000000000', '2020-10-11T15:15:00.000000000',
'2020-10-11T15:30:00.000000000', '2020-10-11T15:45:00.000000000',
'2020-10-11T16:00:00.000000000', '2020-10-11T16:15:00.000000000',
'2020-10-11T16:30:00.000000000', '2020-10-11T16:45:00.000000000',
'2020-10-11T17:00:00.000000000', '2020-10-11T17:15:00.000000000',
'2020-10-11T17:30:00.000000000', '2020-10-11T17:45:00.000000000',
&hellip;
'2020-10-20T11:00:00.000000000', '2020-10-20T11:15:00.000000000',
'2020-10-20T11:30:00.000000000', '2020-10-20T11:45:00.000000000',
'2020-10-20T12:00:00.000000000', '2020-10-20T12:15:00.000000000',
'2020-10-20T12:30:00.000000000', '2020-10-20T12:45:00.000000000',
'2020-10-20T13:00:00.000000000', '2020-10-20T13:15:00.000000000',
'2020-10-20T13:30:00.000000000', '2020-10-20T13:45:00.000000000',
'2020-10-20T14:00:00.000000000', '2020-10-20T14:15:00.000000000',
'2020-10-20T14:30:00.000000000', '2020-10-20T14:45:00.000000000',
'2020-10-20T15:00:00.000000000', '2020-10-20T15:15:00.000000000',
'2020-10-20T15:30:00.000000000', '2020-10-20T15:45:00.000000000',
'2020-10-20T16:00:00.000000000', '2020-10-20T16:15:00.000000000',
'2020-10-20T16:30:00.000000000', '2020-10-20T16:45:00.000000000',
'2020-10-20T17:00:00.000000000', '2020-10-20T17:15:00.000000000',
'2020-10-20T17:30:00.000000000', '2020-10-20T17:45:00.000000000',
'2020-10-20T18:00:00.000000000', '2020-10-20T18:15:00.000000000',
'2020-10-20T18:30:00.000000000', '2020-10-20T18:45:00.000000000',
'2020-10-20T19:00:00.000000000', '2020-10-20T19:15:00.000000000',
'2020-10-20T19:30:00.000000000', '2020-10-20T19:45:00.000000000',
'2020-10-20T20:00:00.000000000', '2020-10-20T20:15:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>-3.018</div><input id=attrs-8d46c993-b9b4-4dde-8d81-92327bfe05cc class=xr-var-attrs-in type=checkbox disabled><label for=attrs-8d46c993-b9b4-4dde-8d81-92327bfe05cc title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-1798b577-0574-4d50-a7a3-eb183954b94f class=xr-var-data-in type=checkbox><label for=data-1798b577-0574-4d50-a7a3-eb183954b94f title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([-3.018])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>53.45</div><input id=attrs-5471fbc8-37ac-43ae-846e-6a77b869fb68 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-5471fbc8-37ac-43ae-846e-6a77b869fb68 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-c02b01cf-c864-4659-9e59-42c384066e8b class=xr-var-data-in type=checkbox><label for=data-c02b01cf-c864-4659-9e59-42c384066e8b title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([53.44969])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>&lt;U25</div><div class='xr-var-preview xr-preview'>'liverpool,_gladstone_dock'</div><input id=attrs-bb676344-f436-4b69-9236-af2fc06baa52 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-bb676344-f436-4b69-9236-af2fc06baa52 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-e445af1b-0720-4c18-8ef3-aa47bb37d465 class=xr-var-data-in type=checkbox><label for=data-e445af1b-0720-4c18-8ef3-aa47bb37d465 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['liverpool,_gladstone_dock'], dtype='&lt;U25')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-d75ee324-f0dd-41bc-b8ad-2014a2bb223a class=xr-section-summary-in type=checkbox checked><label for=section-d75ee324-f0dd-41bc-b8ad-2014a2bb223a class=xr-section-summary>Data variables: <span>(2)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>ssh</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>5.369 5.196 5.032 &mldr; 1.568 1.545</div><input id=attrs-e4c8c69e-9a4e-433d-ab90-c49ddb3aa65e class=xr-var-attrs-in type=checkbox disabled><label for=attrs-e4c8c69e-9a4e-433d-ab90-c49ddb3aa65e title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-935b23f8-a7ac-46cc-9c1c-4d8d3b1cd007 class=xr-var-data-in type=checkbox><label for=data-935b23f8-a7ac-46cc-9c1c-4d8d3b1cd007 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[ 5.369,  5.196,  5.032,  4.886,  4.731,  4.579,  4.415,  4.284,
4.171,  4.054,  3.943,  3.853,  3.77 ,  3.715,  3.663,  3.641,
3.645,  3.68 ,  3.727,  3.794,  3.905,  4.03 ,  4.18 ,  4.344,
4.542,  4.76 ,  4.977,  5.198,  5.438,  5.675,  5.87 ,  6.084,
6.283,  6.451,  6.593,  6.721,  6.819,  6.909,  6.974,  6.995,
6.992,  6.97 ,  6.916,  6.846,  6.744,  6.609,  6.468,  6.315,
6.164,  5.981,  5.792,  5.606,  5.407,  5.208,  5.025,  4.833,
4.644,  4.458,  4.278,  4.107,  3.965,  3.823,  3.686,  3.57 ,
3.457,  3.377,  3.324,  3.278,  3.252,  3.261,  3.308,  3.393,
3.508,  3.676,  3.896,  4.127,  4.363,  4.628,  4.895,  5.185,
5.479,  5.763,  6.013,  6.248,  6.467,  6.685,  6.845,  6.99 ,
7.107,  7.185,  7.233,  7.269,  7.281,  7.242,  7.188,  7.085,
6.97 ,  6.845,  6.687,  6.509,  6.287,  6.101,  5.917,  5.708,
5.493,  5.289,  5.092,  4.902,  4.723,  4.569,  4.427,  4.292,
4.185,  4.083,  3.978,  3.876,  3.806,  3.772,  3.734,  3.721,
3.721,  3.79 ,  3.857,  3.964,  4.127,  4.306,  4.513,  4.765,
5.011,  5.274,  5.566,  5.807,  6.066,  6.332,  6.559,  6.734,
6.915,  7.046,  7.148,  7.264,  7.245,  7.3  ,  7.345,  7.258,
7.201,  7.087,  6.913,  6.831,  6.567,  6.391,  6.2  ,  5.951,
5.681,  5.379,  5.155,  4.939,  4.717,  4.461,  4.235,  4.021,
&hellip;
1.458,  1.21 ,  0.984,  0.835,  0.708,  0.631,  0.669,  0.801,
1.062,  1.458,  2.037,  2.767,  3.555,  4.361,  5.136,  5.904,
6.613,  7.257,  7.804,  8.296,  8.731,  9.117,  9.421,  9.663,
9.852, 10.012, 10.071, 10.01 ,  9.831,  9.633,  9.375,  9.056,
8.648,  8.181,  7.693,  7.209,  6.71 ,  6.21 ,  5.736,  5.295,
4.839,  4.399,  3.987,  3.594,  3.217,  2.876,  2.551,  2.247,
1.959,  1.691,  1.45 ,  1.24 ,  1.071,  0.952,  0.917,  0.978,
1.126,  1.393,  1.795,  2.295,  2.939,  3.674,  4.435,  5.187,
5.94 ,  6.636,  7.285,  7.854,  8.349,  8.793,  9.169,  9.471,
9.72 ,  9.91 , 10.081, 10.143, 10.113,  9.996,  9.819,  9.597,
9.277,  8.924,  8.536,  8.044,  7.57 ,  7.12 ,  6.669,  6.225,
5.744,  5.313,  4.883,  4.469,  4.064,  3.68 ,  3.335,  3.003,
2.687,  2.391,  2.124,  1.857,  1.667,  1.49 ,  1.352,  1.277,
1.28 ,  1.365,  1.561,  1.859,  2.277,  2.808,  3.446,  4.11 ,
4.78 ,  5.489,  6.191,  6.855,  7.453,  7.995,  8.469,  8.886,
9.228,  9.516,  9.752,  9.95 , 10.09 , 10.13 , 10.08 ,  9.928,
9.754,  9.521,  9.2  ,  8.817,  8.406,  7.95 ,  7.49 ,  7.043,
6.583,  6.122,  5.682,  5.257,  4.825,  4.428,  4.054,  3.69 ,
3.354,  3.05 ,  2.765,  2.484,  2.228,  2.015,  1.821,  1.668,
1.568,  1.545]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>qc_flags</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>&lt;U1</div><div class='xr-var-preview xr-preview'>'M' 'M' 'M' 'M' &mldr; 'M' 'M' 'M' 'M'</div><input id=attrs-0b93bdde-9946-48b1-8842-86cf5ad02deb class=xr-var-attrs-in type=checkbox disabled><label for=attrs-0b93bdde-9946-48b1-8842-86cf5ad02deb title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-43b9a079-a55e-4918-a3cb-914c78b2e153 class=xr-var-data-in type=checkbox><label for=data-43b9a079-a55e-4918-a3cb-914c78b2e153 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([['M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
&hellip;
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
'M', 'M', 'M', 'M']], dtype='&lt;U1')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-40a5d88c-9913-4b0d-88c6-68f1a1ff9eaa class=xr-section-summary-in type=checkbox disabled><label for=section-40a5d88c-9913-4b0d-88c6-68f1a1ff9eaa class=xr-section-summary title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list></ul></div></li><li class=xr-section-item><input id=section-0768fc07-5359-46fb-8307-e02e42b5d115 class=xr-section-summary-in type=checkbox checked><label for=section-0768fc07-5359-46fb-8307-e02e42b5d115 class=xr-section-summary>Attributes: <span>(7)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs><dt><span>port :</span></dt><dd>p234</dd><dt><span>site :</span></dt><dd>liverpool,<em>gladstone_dock</dd><dt><span>start_date :</span></dt><dd>01oct2020-00.00.00</dd><dt><span>end_date :</span></dt><dd>31oct2020-23.45.00</dd><dt><span>contributor :</span></dt><dd>national_oceanography_centre,<em>liverpool</dd><dt><span>datum_information :</span></dt><dd>the_data_refer_to_admiralty_chart_datum</em>(acd)</dd><dt><span>parameter_code :</span></dt><dd>aslvbg02</em>=<em>surface_elevation</em>(unspecified_datum)<em>of_the_water_body_by_bubbler_tide_gauge</em>(second_sensor)</dd></dl></div></li></ul></div></div></p><p>An example data variable could be ssh, or ntr (non-tidal residual). This object can also be used for other instrument types, not just tide gauges. For example moorings.</p><p>Every id index for this object should use the same time coordinates. Therefore, timeseries need to be aligned before being placed into the object. If there is any padding needed, then NaNs should be used. NaNs should also be used for quality control/data rejection.</p><p>For the rest of our examples, we will use data from multiple tide gauges
on the same time dimension. It will be read in from a simple netCDF file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>tt</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>xr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>open_dataset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_tg</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Tidegauge</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>tt</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create the object and then inset the netcdf dataset</span>
</span></span><span style=display:flex><span><span style=color:#000>tt</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>xr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>open_dataset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_tg</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Tidegauge</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>tt</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>set_coords</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;time&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><h2 id=quick-plotting-to-visualise-tidegauge-data>Quick plotting to visualise Tidegauge data</h2><p>Tidegauge has ready made quick plotting routines for viewing time series and tide gauge location. To look at the tide gauge location:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>fig</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_on_map</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><pre><code>/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_18_1.png alt=png></p><p>There is also a slightly expanded version where you can plot multiple tidegauge objects, included as a list, and also the colour (if it is a dataarray with one value per location).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># plot a list tidegauge datasets (here repeating obs for the point of demonstration) and colour</span>
</span></span><span style=display:flex><span><span style=color:#000>fig</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_on_map_multiple</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>obs</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>obs</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>color_var_str</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;latitude&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_20_0.png alt=png></p><p>Time series can be plotted using <code>matplotlib.pyplot</code> methods. However <code>xarray</code> has its own plotting wrappers that can be used, which offers some conveniences with labelling</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>stn_id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>26</span>  <span style=color:#8f5902;font-style:italic># pick a gauge station</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>()</span>  <span style=color:#8f5902;font-style:italic># rename time dimension to enable automatic x-axis labelling</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>swap_dims</span><span style=color:#000;font-weight:700>({</span><span style=color:#4e9a06>&#39;t_dim&#39;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#39;time&#39;</span><span style=color:#000;font-weight:700>})</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>()</span>  <span style=color:#8f5902;font-style:italic># rename time dimension to enable automatic x-axis labelling</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>tight_layout</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_22_0.png alt=png></p><p>Or you can use the <code>Tidegauge.plot_timeseries()</code> method, in which start and end dates can also be specified.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_timeseries</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>date_start</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime64</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;2007-01-01&#39;</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000>date_end</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime64</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;2007-01-31&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>(&lt;Figure size 1000x1000 with 1 Axes&gt;,
 &lt;matplotlib.collections.PathCollection at 0x7f9521535870&gt;)
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_24_1.png alt=png></p><h2 id=basic-manipulation-subsetting--plotting>Basic manipulation: subsetting + plotting</h2><p>We can do some simple spatial and temporal manipulations of this data:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Cut out a time window</span>
</span></span><span style=display:flex><span><span style=color:#000>obs_cut</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_slice</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>date0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>date1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>31</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Cut out geographical boxes</span>
</span></span><span style=display:flex><span><span style=color:#000>obs_upper</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs_cut</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subset_indices_lonlat_box</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>lonbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000>latbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>55</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span><span style=color:#000>obs_lower</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs_cut</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subset_indices_lonlat_box</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>lonbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>9</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000>latbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>55.5</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>59</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#fig, ax = obs_cut.plot_on_map()</span>
</span></span><span style=display:flex><span><span style=color:#000>fig</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs_upper</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_on_map_multiple</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>obs_upper</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>obs_lower</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>color_var_str</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;latitude&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
Tidegauge object at 0x55a7d8e51980 initialised
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_26_1.png alt=png></p><h3 id=gridded-model-comparison>Gridded model comparison</h3><p>To compare our observations to the model, we will interpolate a model variable to the same time and geographical space as the tidegauge. This is done using the <code>obs_operator()</code> method.</p><p>But first load some gridded data and manipulate some variable names for convenience</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>nemo</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Gridded</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_dat</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fn_dom</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>multiple</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>True</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>fn_config</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Rename depth_0 to be depth</span>
</span></span><span style=display:flex><span><span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>rename</span><span style=color:#000;font-weight:700>({</span><span style=color:#4e9a06>&#34;depth_0&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;depth&#34;</span><span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#nemo.dataset = nemo.dataset[[&#34;ssh&#34;, &#34;landmask&#34;]]</span>
</span></span></code></pre></div><pre><code>/usr/share/miniconda/envs/coast/lib/python3.10/site-packages/xarray/core/dataset.py:282: UserWarning: The specified chunks separate the stored chunks along dimension &quot;time_counter&quot; starting at index 2. This could degrade performance. Instead, consider rechunking after loading.
</code></pre><p>interpolate model onto obs locations</p><pre tabindex=0><code>tidegauge_from_model = obs.obs_operator(nemo, time_interp=&#39;nearest&#39;)
</code></pre><p>Doing this would create a new interpolated tidegauge called <code>tidegauge_from_model</code>
Take a look at <code>tidegauge_from_model.dataset</code> to see for yourself. If a <code>landmask</code>
variable is present in the <code>Gridded</code> dataset then the nearest wet points will
be taken. Otherwise, just the nearest point is taken. If <code>landmask</code> is required
but not present you will need to insert it into the dataset yourself. For nemo
data, you could use the <code>bottom_level</code> or <code>mbathy</code> variables to do this. E.g:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create a landmask array and put it into the nemo object.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Here, using the bottom_level == 0 variable from the domain file is enough.</span>
</span></span><span style=display:flex><span><span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;landmask&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>bottom_level</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Then do the interpolation</span>
</span></span><span style=display:flex><span><span style=color:#000>tidegauge_from_model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>obs_operator</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nemo</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>time_interp</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;nearest&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>Calculating spatial indices.
Calculating time indices.
 Indexing model data at tide gauge locations.. 
Calculating interpolation distances.
Interpolating in time...
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><p>However, the new <code>tidegauge_from_model</code> will the same number of time entries as the <code>obs</code> data, rather than the model data (so this will include lots of empty values). So, for a more useful demonstration we trim the observed gauge data so it better matches the model data.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Cut down data to be only in 2007 to match model data.</span>
</span></span><span style=display:flex><span><span style=color:#000>start_date</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>end_date</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>31</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_slice</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>start_date</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>end_date</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><h3 id=interpolate-model-data-onto-obs-locations>Interpolate model data onto obs locations</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>model_timeseries</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>obs_operator</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nemo</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Take a look</span>
</span></span><span style=display:flex><span><span style=color:#000>model_timeseries</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</span></span></code></pre></div><pre><code>Calculating spatial indices.
Calculating time indices.
 Indexing model data at tide gauge locations.. 
Calculating interpolation distances.
Interpolating in time...
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,#000);&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body[data-theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1F1F1F;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111111;&ndash;xr-background-color-row-even:#111111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(&rsquo;; }</p> <p>.xr-dim-list:after { content: &lsquo;)&rsquo}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,&rsquo;padding-right:5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-index-preview{grid-column:2/5;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data,.xr-index-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data,.xr-index-data-in:checked~.xr-index-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-index-name div,.xr-index-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data,.xr-index-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2,.xr-no-icon{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:        (z_dim: 51, axis_nbounds: 2, t_dim: 720, id_dim: 61)
Coordinates:
longitude      (id_dim) float32 1.444 -4.0 -5.333 &hellip; 7.666 -9.111 8.777
latitude       (id_dim) float32 51.93 51.53 58.0 51.67 &hellip; 58.0 51.53 53.87
depth          (z_dim, id_dim) float32 0.1001 0.2183 0.2529 &hellip; 27.32 10.11</p>
<ul>
<li>
<p>time           (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00
Dimensions without coordinates: z_dim, axis_nbounds, t_dim, id_dim
Data variables:
deptht_bounds  (z_dim, axis_nbounds) float32 0.0 6.157 &hellip; 5.924e+03
ssh            (t_dim, id_dim) float32 nan nan nan &hellip; 0.3721 -0.0752 0.7412
temperature    (t_dim, z_dim, id_dim) float32 nan nan nan &hellip; nan nan nan
bathymetry     (id_dim) float32 10.0 21.81 6.075 15.56 &hellip; 17.8 14.06 10.0
e1             (id_dim) float32 7.618e+03 7.686e+03 &hellip; 7.686e+03 7.285e+03
e2             (id_dim) float32 7.414e+03 7.414e+03 &hellip; 7.414e+03 7.414e+03
e3_0           (z_dim, id_dim) float32 0.2002 0.4365 0.5059 &hellip; 0.541 0.2002
bottom_level   (id_dim) float32 50.0 50.0 12.0 32.0 &hellip; 44.0 17.0 26.0 50.0
landmask       (id_dim) bool False False False False &hellip; False False False
interp_dist    (id_dim) float64 10.56 4.33 15.65 6.018 &hellip; 5.835 4.96 3.957
Attributes:
name:         AMM7_1d_20070101_20070131_25hourm_grid_T
description:  ocean T grid variables, 25h meaned
title:        ocean T grid variables, 25h meaned
Conventions:  CF-1.6
timeStamp:    2019-Dec-26 04:35:28 GMT
uuid:         96cae459-d3a1-4f4f-b82b-9259179f95f7
history:      Tue May 19 12:07:51 2020: ncks -v votemper,sossheig -d time&hellip;
NCO:          4.4.7</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-b51089a8-b547-4b1b-8697-5712c4ca0909 class=xr-section-summary-in type=checkbox disabled><label for=section-b51089a8-b547-4b1b-8697-5712c4ca0909 class=xr-section-summary title='Expand/collapse section'>Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>z_dim</span>: 51</li><li><span>axis_nbounds</span>: 2</li><li><span class=xr-has-index>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-16dc73cd-383e-4261-af87-492e4188a647 class=xr-section-summary-in type=checkbox checked><label for=section-16dc73cd-383e-4261-af87-492e4188a647 class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>1.444 -4.0 -5.333 &mldr; -9.111 8.777</div><input id=attrs-910d80df-52bc-4a5c-aa1b-eb844104df56 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-910d80df-52bc-4a5c-aa1b-eb844104df56 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-711688af-8d14-4beb-a9b0-1c01a64614ad class=xr-var-data-in type=checkbox><label for=data-711688af-8d14-4beb-a9b0-1c01a64614ad title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.4443359 , -4.        , -5.333008  , -5.111328  , -3.        ,
-3.1113281 , -5.2226562 , -3.        , -1.4443359 ,  1.4443359 ,
-4.666992  ,  1.3330078 , -6.2226562 , -2.555664  , -3.7783203 ,
-4.333008  ,  1.1113281 , -0.55566406, -5.555664  , -5.111328  ,
-1.4443359 , -2.        , -1.1113281 , -2.8886719 , -1.8886719 ,
-6.333008  , -3.1113281 , -6.2226562 , -0.        ,  0.11132812,
-4.        ,  1.3330078 , -2.7783203 , -2.1113281 , -1.4443359 ,
-3.555664  , -1.4443359 , -2.7783203 , -3.2226562 ,  1.7773438 ,
-5.        , -5.555664  , -3.1113281 , -1.1113281 , -6.333008  ,
-5.        , -4.7783203 , -6.666992  , -2.7783203 , -1.4443359 ,
-4.111328  , -4.111328  , -1.4443359 , 11.22168   , 11.777344  ,
4.888672  , 11.22168   , -7.333008  ,  7.6660156 , -9.111328  ,
8.777344  ], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>51.93 51.53 58.0 &mldr; 51.53 53.87</div><input id=attrs-4f1e7752-7421-486b-af60-ce0aef63922a class=xr-var-attrs-in type=checkbox disabled><label for=attrs-4f1e7752-7421-486b-af60-ce0aef63922a title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-869fb78d-2d7b-44ef-b690-17a7b91ff71c class=xr-var-data-in type=checkbox><label for=data-869fb78d-2d7b-44ef-b690-17a7b91ff71c title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.933594, 51.53418 , 58.000977, 51.666992, 54.000977, 51.26758 ,
58.467773, 58.467773, 55.067383, 51.933594, 53.333984, 52.933594,
56.66797 , 50.600586, 53.333984, 50.333984, 51.53418 , 54.467773,
50.067383, 54.80078 , 55.067383, 57.13379 , 60.20117 , 51.53418 ,
50.666992, 49.933594, 53.467773, 55.600586, 53.600586, 50.7334  ,
57.600586, 51.067383, 51.53418 , 49.13379 , 55.067383, 54.666992,
55.067383, 51.53418 , 56.000977, 52.467773, 52.067383, 54.666992,
51.26758 , 50.7334  , 58.13379 , 55.734375, 54.067383, 55.26758 ,
51.53418 , 55.067383, 52.734375, 51.26758 , 55.067383, 58.333984,
57.66797 , 61.93457 , 64.868164, 55.40039 , 58.000977, 51.53418 ,
53.867188], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>depth</span></div><div class=xr-var-dims>(z_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>0.1001 0.2183 &mldr; 27.32 10.11</div><input id=attrs-677bac16-eed5-42b5-9c3c-2f1e913a8ea0 class=xr-var-attrs-in type=checkbox><label for=attrs-677bac16-eed5-42b5-9c3c-2f1e913a8ea0 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-377c6b4e-523a-46c0-b19d-da10a628be5f class=xr-var-data-in type=checkbox><label for=data-377c6b4e-523a-46c0-b19d-da10a628be5f title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>m</dd><dt><span>standard_name :</span></dt><dd>Depth at time zero on the t-grid</dd></dl></div><div class=xr-var-data><pre>array([[1.00097656e-01, 2.18261719e-01, 2.52929688e-01, &hellip;,
5.02441406e-01, 2.70507812e-01, 1.00097656e-01],
[3.00292969e-01, 6.54785156e-01, 7.58789062e-01, &hellip;,
1.49365234e+00, 8.11523438e-01, 3.00292969e-01],
[5.00488281e-01, 1.09130859e+00, 1.26464844e+00, &hellip;,
2.46826172e+00, 1.35253906e+00, 5.00488281e-01],
&hellip;,
[9.70947266e+00, 2.11713867e+01, 2.45341797e+01, &hellip;,
1.70940918e+02, 2.62392578e+01, 9.70947266e+00],
[9.90966797e+00, 2.16079102e+01, 2.50400391e+01, &hellip;,
1.75505371e+02, 2.67802734e+01, 9.90966797e+00],
[1.01098633e+01, 2.20444336e+01, 2.55458984e+01, &hellip;,
1.79002441e+02, 2.73212891e+01, 1.01098633e+01]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span class=xr-has-index>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-83b918ce-fa90-47a3-8679-5a572e846037 class=xr-var-attrs-in type=checkbox><label for=attrs-83b918ce-fa90-47a3-8679-5a572e846037 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-c04a2570-3058-48be-87a3-5a7ad7900ef4 class=xr-var-data-in type=checkbox><label for=data-c04a2570-3058-48be-87a3-5a7ad7900ef4 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>axis :</span></dt><dd>T</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time axis</dd><dt><span>time_origin :</span></dt><dd>1900-01-01 00:00:00</dd><dt><span>bounds :</span></dt><dd>time_counter_bounds</dd></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', &hellip;, '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-c70c23f1-294a-4cf9-915f-9d6018f2829c class=xr-section-summary-in type=checkbox checked><label for=section-c70c23f1-294a-4cf9-915f-9d6018f2829c class=xr-section-summary>Data variables: <span>(10)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>deptht_bounds</span></div><div class=xr-var-dims>(z_dim, axis_nbounds)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>0.0 6.157 &mldr; 5.72e+03 5.924e+03</div><input id=attrs-32b0eb85-c351-4ba7-bba1-6ca44fb1a6a4 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-32b0eb85-c351-4ba7-bba1-6ca44fb1a6a4 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-22a8fd82-4934-4451-bac4-0835502514bd class=xr-var-data-in type=checkbox><label for=data-22a8fd82-4934-4451-bac4-0835502514bd title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[   0.       ,    6.1572266],
[   6.1572266,   12.678711 ],
[  12.678711 ,   19.65332  ],
[  19.65332  ,   27.19043  ],
[  27.19043  ,   35.426758 ],
[  35.426758 ,   44.527344 ],
[  44.527344 ,   54.69922  ],
[  54.69922  ,   66.19141  ],
[  66.19141  ,   79.305664 ],
[  79.305664 ,   94.41016  ],
[  94.41016  ,  111.94238  ],
[ 111.94238  ,  132.41895  ],
[ 132.41895  ,  156.44531  ],
[ 156.44531  ,  184.71582  ],
[ 184.71582  ,  218.01562  ],
[ 218.01562  ,  257.20605  ],
[ 257.20605  ,  303.20508  ],
[ 303.20508  ,  356.95898  ],
[ 356.95898  ,  419.39258  ],
[ 419.39258  ,  491.35645  ],
&hellip;
[1955.7686   , 2136.3613   ],
[2136.3613   , 2321.292    ],
[2321.292    , 2509.8564   ],
[2509.8564   , 2701.4355   ],
[2701.4355   , 2895.504    ],
[2895.504    , 3091.6123   ],
[3091.6123   , 3289.3867   ],
[3289.3867   , 3488.5156   ],
[3488.5156   , 3688.7441   ],
[3688.7441   , 3889.8613   ],
[3889.8613   , 4091.6963   ],
[4091.6963   , 4294.1094   ],
[4294.1094   , 4496.9893   ],
[4496.9893   , 4700.242    ],
[4700.242    , 4903.797    ],
[4903.797    , 5107.5938   ],
[5107.5938   , 5311.584    ],
[5311.584    , 5515.7295   ],
[5515.7295   , 5720.       ],
[5720.       , 5924.2705   ]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>ssh</span></div><div class=xr-var-dims>(t_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>nan nan nan &mldr; -0.0752 0.7412</div><input id=attrs-6f24bb40-67e1-48cd-848a-0bc743432d3d class=xr-var-attrs-in type=checkbox><label for=attrs-6f24bb40-67e1-48cd-848a-0bc743432d3d title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-8a8c0da5-35ce-4f9f-add4-e718dec4cd49 class=xr-var-data-in type=checkbox><label for=data-8a8c0da5-35ce-4f9f-add4-e718dec4cd49 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>m</dd><dt><span>online_operation :</span></dt><dd>instant</dd><dt><span>interval_operation :</span></dt><dd>300 s</dd><dt><span>interval_write :</span></dt><dd>1 d</dd><dt><span>cell_methods :</span></dt><dd>time: point (interval: 300 s)</dd></dl></div><div class=xr-var-data><pre>array([[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
&hellip;,
[ 0.24902344, -0.046875  ,  0.20019531, &hellip;,  0.3720703 ,
-0.07519531,  0.74121094],
[ 0.24902344, -0.046875  ,  0.20019531, &hellip;,  0.3720703 ,
-0.07519531,  0.74121094],
[ 0.24902344, -0.046875  ,  0.20019531, &hellip;,  0.3720703 ,
-0.07519531,  0.74121094]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>temperature</span></div><div class=xr-var-dims>(t_dim, z_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan &mldr; nan nan nan nan</div><input id=attrs-c01f0030-47cf-47c0-9b3a-7d06dbbae455 class=xr-var-attrs-in type=checkbox><label for=attrs-c01f0030-47cf-47c0-9b3a-7d06dbbae455 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-eba73d58-7bb2-4350-a9c0-d017395ed713 class=xr-var-data-in type=checkbox><label for=data-eba73d58-7bb2-4350-a9c0-d017395ed713 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>degC</dd><dt><span>online_operation :</span></dt><dd>instant</dd><dt><span>interval_operation :</span></dt><dd>300 s</dd><dt><span>interval_write :</span></dt><dd>1 d</dd><dt><span>cell_methods :</span></dt><dd>time: point (interval: 300 s)</dd></dl></div><div class=xr-var-data><pre>array([[[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
&hellip;,
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan]],</p>
<p>[[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
&hellip;
[7.4384766, 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[7.439453 , 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan]],</p>
<p>[[7.4335938, 8.217773 , 7.245117 , &hellip;, 5.8652344, 8.924805 ,
5.0322266],
[7.4345703, 8.219727 , 7.245117 , &hellip;, 5.8671875, 8.926758 ,
5.0322266],
[7.4345703, 8.219727 , 7.2421875, &hellip;, 5.8691406, 8.926758 ,
5.0322266],
&hellip;,
[7.4384766, 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[7.439453 , 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan]]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>bathymetry</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>10.0 21.81 6.075 &mldr; 14.06 10.0</div><input id=attrs-75e360ed-ad85-4b97-860a-4d856177d1fe class=xr-var-attrs-in type=checkbox><label for=attrs-75e360ed-ad85-4b97-860a-4d856177d1fe title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-d7ea0589-f071-4650-9183-8987bb0f16d6 class=xr-var-data-in type=checkbox><label for=data-d7ea0589-f071-4650-9183-8987bb0f16d6 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>m</dd><dt><span>standard_name :</span></dt><dd>bathymetry</dd><dt><span>description :</span></dt><dd>depth of last wet w-level on the horizontal t-grid</dd></dl></div><div class=xr-var-data><pre>array([10.       , 21.80957  ,  6.0751953, 15.558594 , 10.65625  ,
12.145508 , 53.125    , 47.216797 , 10.3125   , 10.       ,
21.898438 , 10.095703 , 11.674805 , 15.611328 , 11.230469 ,
20.368164 , 10.25293  , 14.34082  , 23.28418  , 37.7666   ,
10.3125   , 34.78711  , 15.394531 , 10.       , 12.630859 ,
21.493164 , 10.       , 18.167969 , 10.       , 17.354492 ,
10.       , 24.625    , 10.       ,  9.915039 , 10.3125   ,
10.       , 10.3125   , 10.       , 10.       , 10.0703125,
37.003906 , 10.40918  , 12.145508 , 10.       , 30.885742 ,
35.280273 , 17.089844 , 33.78711  , 10.       , 10.3125   ,
10.       , 37.25879  , 10.3125   , 12.712891 ,  8.652344 ,
14.458984 , 83.96973  , 19.424805 , 17.804688 , 14.060547 ,
10.       ], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>e1</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>7.618e+03 7.686e+03 &mldr; 7.285e+03</div><input id=attrs-a21d1874-22ab-41c7-905a-c5be2b5b2d2e class=xr-var-attrs-in type=checkbox disabled><label for=attrs-a21d1874-22ab-41c7-905a-c5be2b5b2d2e title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-abcc5401-61b7-4796-8377-54c006f33519 class=xr-var-data-in type=checkbox><label for=data-abcc5401-61b7-4796-8377-54c006f33519 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([7617.912 , 7685.6387, 6547.1533, 7663.1045, 7262.1484, 7730.582 ,
6461.591 , 6461.591 , 7074.802 , 7617.912 , 7377.966 , 7446.9775,
6789.205 , 7842.205 , 7377.966 , 7886.5586, 7685.6387, 7180.49  ,
7930.74  , 7121.871 , 7074.802 , 6704.8984, 6140.08  , 7685.6387,
7831.091 , 7952.7676, 7354.881 , 6980.205 , 7331.758 , 7819.965 ,
6620.1465, 7764.1797, 7685.6387, 8084.0186, 7074.802 , 7145.3477,
7074.802 , 7685.6387, 6908.8594, 7527.032 , 7595.254 , 7145.3477,
7730.582 , 7819.965 , 6522.751 , 6956.461 , 7250.5117, 7039.3994,
7685.6387, 7074.802 , 7481.3477, 7730.582 , 7074.802 , 6486.082 ,
6608.004 , 5812.949 , 5247.382 , 7015.75  , 6547.1533, 7685.6387,
7285.3906], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>e2</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>7.414e+03 7.414e+03 &mldr; 7.414e+03</div><input id=attrs-ee885ea2-8114-4547-b3ad-ba9444d89082 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-ee885ea2-8114-4547-b3ad-ba9444d89082 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-f87afc61-b45a-4d21-8575-2b545b1b5c24 class=xr-var-data-in type=checkbox><label for=data-f87afc61-b45a-4d21-8575-2b545b1b5c24 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>e3_0</span></div><div class=xr-var-dims>(z_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>0.2002 0.4365 &mldr; 0.541 0.2002</div><input id=attrs-e13f1b2c-552b-4206-b864-3ba00743b2f8 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-e13f1b2c-552b-4206-b864-3ba00743b2f8 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-4eac80cc-9fe2-48fe-83ac-30aa93c87491 class=xr-var-data-in type=checkbox><label for=data-4eac80cc-9fe2-48fe-83ac-30aa93c87491 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[0.20019531, 0.43652344, 0.5058594 , &hellip;, 1.        , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 0.9824219 , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 0.96777344, 0.5410156 ,
0.20019531],
&hellip;,
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 5.0214844 , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 4.057617  , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 3.203125  , 0.5410156 ,
0.20019531]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>bottom_level</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class='xr-var-preview xr-preview'>50.0 50.0 12.0 &mldr; 17.0 26.0 50.0</div><input id=attrs-653d0405-e65a-41bc-8593-d0f5d6c05121 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-653d0405-e65a-41bc-8593-d0f5d6c05121 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-c9b92dae-a547-448d-afd0-a0b79eb909ad class=xr-var-data-in type=checkbox><label for=data-c9b92dae-a547-448d-afd0-a0b79eb909ad title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([50., 50., 12., 32., 50., 50., 50., 50., 21., 50., 29., 42., 32.,
42., 40., 33., 50., 25., 37., 32., 21., 50., 20., 50., 44., 24.,
50., 24., 50., 43., 50., 50., 50., 34., 21., 50., 21., 50., 50.,
33., 50., 11., 50., 50., 33., 45., 29., 39., 50., 21., 50., 50.,
21., 19., 25., 25., 50., 44., 17., 26., 50.], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>landmask</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>bool</div><div class='xr-var-preview xr-preview'>False False False &mldr; False False</div><input id=attrs-9c9c8180-71ff-4f56-9bb2-3dbc5b43f0e5 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-9c9c8180-71ff-4f56-9bb2-3dbc5b43f0e5 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-f1266fb0-3a76-417b-9399-8495e541c93a class=xr-var-data-in type=checkbox><label for=data-f1266fb0-3a76-417b-9399-8495e541c93a title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>interp_dist</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>10.56 4.33 15.65 &mldr; 4.96 3.957</div><input id=attrs-fd58e38c-492e-4859-8746-8ea44b63f7c5 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-fd58e38c-492e-4859-8746-8ea44b63f7c5 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-df68a086-f6a4-48e3-a941-10ab3b2e76da class=xr-var-data-in type=checkbox><label for=data-df68a086-f6a4-48e3-a941-10ab3b2e76da title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([10.55753639,  4.3298596 , 15.65224834,  6.01847521,  6.21944535,
6.03485965, 10.09762811,  5.83889348,  6.6716266 ,  7.06250586,
3.81132755,  2.10403027, 10.89520817,  7.65307627,  3.12483581,
11.15992752, 27.30753169,  4.52090493,  4.06485834,  4.67908778,
6.6716266 ,  4.96772739,  5.4813996 ,  7.053344  ,  5.35290231,
2.05865294,  6.49778121,  3.61860367, 12.72904061,  6.59773619,
0.24707792,  5.27676859,  5.09090741,  5.52241217,  6.6716266 ,
1.95744877,  6.6716266 ,  5.13046117,  2.83309362,  1.88771332,
6.06839329,  7.32299892,  6.03485965,  7.69045765,  8.78690904,
6.13400869,  2.11138548,  6.79115084,  5.13046117,  6.6716266 ,
4.76955022,  6.29453137,  6.6716266 ,  1.82312538,  2.14643925,
11.94656233,  1.34373275,  3.71293547,  5.83537153,  4.96020927,
3.9566329 ])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-22e0141d-eb1f-4a6e-ae9b-49c0a76db9cb class=xr-section-summary-in type=checkbox><label for=section-22e0141d-eb1f-4a6e-ae9b-49c0a76db9cb class=xr-section-summary>Indexes: <span>(1)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-index-name><div>time</div></div><div class=xr-index-preview>PandasIndex</div><div></div><input id=index-86753ad2-746f-4eb7-864d-a1535aad40b9 class=xr-index-data-in type=checkbox><label for=index-86753ad2-746f-4eb7-864d-a1535aad40b9 title='Show/Hide index repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-index-data><pre>PandasIndex(DatetimeIndex(['2007-01-01 00:00:00', '2007-01-01 01:00:00',
'2007-01-01 02:00:00', '2007-01-01 03:00:00',
'2007-01-01 04:00:00', '2007-01-01 05:00:00',
'2007-01-01 06:00:00', '2007-01-01 07:00:00',
'2007-01-01 08:00:00', '2007-01-01 09:00:00',
&hellip;
'2007-01-30 14:00:00', '2007-01-30 15:00:00',
'2007-01-30 16:00:00', '2007-01-30 17:00:00',
'2007-01-30 18:00:00', '2007-01-30 19:00:00',
'2007-01-30 20:00:00', '2007-01-30 21:00:00',
'2007-01-30 22:00:00', '2007-01-30 23:00:00'],
dtype='datetime64[ns]', name='time', length=720, freq=None))</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-90348e8a-6834-4857-abc3-33361d70256f class=xr-section-summary-in type=checkbox checked><label for=section-90348e8a-6834-4857-abc3-33361d70256f class=xr-section-summary>Attributes: <span>(8)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs><dt><span>name :</span></dt><dd>AMM7_1d_20070101_20070131_25hourm_grid_T</dd><dt><span>description :</span></dt><dd>ocean T grid variables, 25h meaned</dd><dt><span>title :</span></dt><dd>ocean T grid variables, 25h meaned</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>timeStamp :</span></dt><dd>2019-Dec-26 04:35:28 GMT</dd><dt><span>uuid :</span></dt><dd>96cae459-d3a1-4f4f-b82b-9259179f95f7</dd><dt><span>history :</span></dt><dd>Tue May 19 12:07:51 2020: ncks -v votemper,sossheig -d time_counter,0,30,5 AMM7_1d_20070101_20070131_25hourm_grid_T.nc example_data.nc</dd><dt><span>NCO :</span></dt><dd>4.4.7</dd></dl></div></li></ul></div></div></p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>stn_id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>26</span>  <span style=color:#8f5902;font-style:italic># pick a gauge station</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>model_timeseries</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>()</span>  <span style=color:#8f5902;font-style:italic># rename time dimension to enable automatic x-axis labelling</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>swap_dims</span><span style=color:#000;font-weight:700>({</span><span style=color:#4e9a06>&#39;t_dim&#39;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#39;time&#39;</span><span style=color:#000;font-weight:700>})</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>()</span>  <span style=color:#8f5902;font-style:italic># rename time dimension to enable automatic x-axis labelling</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>tight_layout</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_37_0.png alt=png></p><p>We can see that the structure for the new dataset <code>model_timeseries</code>, generated from the gridded model simulation, is that of a <code>tidegauge</code> object. NB in the example simulation data the ssh variable is output as 5-day means. So it is not particulatly useful for high frequency validation but serves as a demonstration of the workflow.</p><h2 id=tidegauge-analysis-methods>Tidegauge analysis methods</h2><p>For a good comparison, we would like to make sure that both the observed and
modelled <code>Tidegauge</code> objects contain the same missing values. <code>TidegaugeAnalysis</code>
contains a routine for ensuring this. First create our analysis object:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>tganalysis</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>TidegaugeAnalysis</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># This routine searches for missing values in each dataset and applies them</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># equally to each corresponding dataset</span>
</span></span><span style=display:flex><span><span style=color:#000>obs_new</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_new</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>match_missing_values</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_timeseries</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><p>Although we input data arrays to the above routine, it returns two new Tidegauge objects. Now you have equivalent and comparable sets of time series that can be easily compared.</p><h3 id=harmonic-analysis--non-tidal-residuals>Harmonic Analysis & Non tidal-Residuals</h3><p>The <code>Tidegauge</code> object contains some routines which make harmonic analysis and
the calculation/comparison of non-tidal residuals easier. Harmonic analysis is
done using the <code>utide</code> package. Please see <a href=https://pypi.org/project/UTide/>here</a> for more info.</p><p>First we can use the <code>TidegaugeAnalysis</code> class to do a harmonic analysis. Suppose
we have two <code>Tidegauge</code> objects called <code>obs</code> and <code>model_timeseries</code> generated from tidegauge observations and model simulations respectively.</p><p>Then subtract means from all the time series</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Subtract means from all time series</span>
</span></span><span style=display:flex><span><span style=color:#000>obs_new</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>demean_timeseries</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>model_new</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>demean_timeseries</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Now you have equivalent and comparable sets of time series that can be</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># easily compared.</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>figure</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>         <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;model - demeaned&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;orange&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>         <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs - demeaned&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#39;model and observed timeseries : </span><span style=color:#4e9a06>{</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>site_name</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>coords</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_46_0.png alt=png></p><p>Then we can apply the harmonic analysis (though the example data is too short for this example to be that meaningful and the model data is only saved as 5-day means! Nevertheless we proceed):</p><h3 id=calculate-non-tidal-residuals>Calculate non tidal residuals</h3><p>First, do a harmonic analysis. This routine uses utide</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>ha_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>harmonic_analysis_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>min_datapoints</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>ha_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>harmonic_analysis_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>min_datapoints</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
</code></pre><p>The <code>harmonic_analysis_utide</code> routine returns a list of <code>utide</code> structure object,
one for each <code>id_dim</code> in the <code>Tidegauge</code> object. It can be passed any of the
arguments that go to <code>utide</code>. It also has an additional argument <code>min_datapoints</code>
which determines a minimum number of data points for the harmonics analysis.
If a tidegauge <code>id_dim</code> has less than this number, it will not return an analysis.</p><p>Now, create new <code>TidegaugeMultiple</code> objects containing reconstructed tides:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>tide_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstruct_tide_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ha_mod</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>tide_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstruct_tide_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ha_obs</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
Tidegauge object at 0x55a7d8e51980 initialised
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><p>Get new TidegaugeMultiple objects containing non tidal residuals:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>ntr_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>calculate_non_tidal_residuals</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>tide_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstructed</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>apply_filter</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>False</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>ntr_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>calculate_non_tidal_residuals</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>tide_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstructed</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>apply_filter</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>True</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>window_length</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>polyorder</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Take a look</span>
</span></span><span style=display:flex><span><span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,#000);&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body[data-theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1F1F1F;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111111;&ndash;xr-background-color-row-even:#111111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(&rsquo;; }</p> <p>.xr-dim-list:after { content: &lsquo;)&rsquo}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,&rsquo;padding-right:5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-index-preview{grid-column:2/5;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data,.xr-index-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data,.xr-index-data-in:checked~.xr-index-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-index-name div,.xr-index-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data,.xr-index-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2,.xr-no-icon{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:    (t_dim: 720, id_dim: 61)
Coordinates:
time       (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00
longitude  (id_dim) float64 1.292 -3.975 -5.158 -5.051 &hellip; 7.567 350.8 8.717
latitude   (id_dim) float64 51.95 51.57 57.9 51.71 &hellip; 58.0 51.53 53.87
site_name  (id_dim) &lt;U25 'Harwich' 'Mumbles' 'Ullapool' &hellip; 'N/A' 'N/A'
Dimensions without coordinates: t_dim, id_dim
Data variables:
ntr        (id_dim, t_dim) float64 0.4182 0.4182 0.4182 &hellip; -0.02699 0.2945</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-8673171d-f8b5-402b-93a9-db5f43a6c61b class=xr-section-summary-in type=checkbox disabled><label for=section-8673171d-f8b5-402b-93a9-db5f43a6c61b class=xr-section-summary title='Expand/collapse section'>Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-f9b61f3e-881e-4c21-9353-339c755c8409 class=xr-section-summary-in type=checkbox checked><label for=section-f9b61f3e-881e-4c21-9353-339c755c8409 class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-26c4121f-8169-443c-994f-56f7d37ac71e class=xr-var-attrs-in type=checkbox disabled><label for=attrs-26c4121f-8169-443c-994f-56f7d37ac71e title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-8a779c8e-803d-46c5-966f-62eed5743a27 class=xr-var-data-in type=checkbox><label for=data-8a779c8e-803d-46c5-966f-62eed5743a27 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>1.292 -3.975 -5.158 &mldr; 350.8 8.717</div><input id=attrs-1ebb4565-091b-4f3b-97cd-4bb1894ec237 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-1ebb4565-091b-4f3b-97cd-4bb1894ec237 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-3c87cb3c-1455-4f1d-9790-0ffbf7eba0e5 class=xr-var-data-in type=checkbox><label for=data-3c87cb3c-1455-4f1d-9790-0ffbf7eba0e5 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00,  1.34839000e+00, -4.62044000e+00,  1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01,  5.70300000e-02, -4.00220000e+00,  1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00,  1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00,  1.12150002e+01,  1.18000002e+01,  5.11700010e+00,
1.12500000e+01,  3.52666992e+02,  7.56699991e+00,  3.50816986e+02,
8.71700001e+00])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>51.95 51.57 57.9 &mldr; 51.53 53.87</div><input id=attrs-515179bc-45ec-485f-afdc-f038a29533ac class=xr-var-attrs-in type=checkbox disabled><label for=attrs-515179bc-45ec-485f-afdc-f038a29533ac title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-d66714a6-b14d-4587-a11f-2858980b6562 class=xr-var-data-in type=checkbox><label for=data-d66714a6-b14d-4587-a11f-2858980b6562 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.94798   , 51.57      , 57.89525   , 51.7064    , 54.03167   ,
51.21525   , 58.45661   , 58.44097   , 55.00744   , 51.95675   ,
53.31394   , 52.93436   , 56.62311   , 50.6085    , 53.33167   ,
50.36839   , 51.44564   , 54.49008   , 50.103     , 54.84256   ,
55.00744   , 57.14406   , 60.15403   , 51.55      , 50.71433   ,
49.91847   , 53.44969   , 55.62742   , 53.63103   , 50.78178   ,
57.5987    , 51.11439   , 51.51089   , 49.18333   , 55.00744   ,
54.65081   , 55.00744   , 51.50002   , 55.98983   , 52.473     ,
52.01378   , 54.66475   , 51.21525   , 50.80256   , 58.20711   ,
55.74964   , 54.08539   , 55.20678   , 51.50002   , 55.00744   ,
52.71906   , 51.21097   , 55.00744   , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58.        , 51.53300095,
53.86700058])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>&lt;U25</div><div class='xr-var-preview xr-preview'>'Harwich' 'Mumbles' &mldr; 'N/A' 'N/A'</div><input id=attrs-4999d420-81ff-4903-96f8-c6830381f8bd class=xr-var-attrs-in type=checkbox disabled><label for=attrs-4999d420-81ff-4903-96f8-c6830381f8bd title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-bc5207ed-82e1-4e7b-8887-347816e1d68e class=xr-var-data-in type=checkbox><label for=data-bc5207ed-82e1-4e7b-8887-347816e1d68e title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &quot;St. Mary's&quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype='&lt;U25')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-b76d021d-9824-4ac9-9726-e0630d17b995 class=xr-section-summary-in type=checkbox checked><label for=section-b76d021d-9824-4ac9-9726-e0630d17b995 class=xr-section-summary>Data variables: <span>(1)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>0.4182 0.4182 &mldr; -0.02699 0.2945</div><input id=attrs-ac43cc3f-914b-4f37-8f9d-878a859eaa87 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-ac43cc3f-914b-4f37-8f9d-878a859eaa87 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-e68cadd0-5eb5-4c76-b585-392fc5026291 class=xr-var-data-in type=checkbox><label for=data-e68cadd0-5eb5-4c76-b585-392fc5026291 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[ 0.41824902,  0.41824902,  0.41824902, &hellip;, -0.34442645,
-0.14399667,  0.11602685],
[ 0.21228445,  0.21228445,  0.21228445, &hellip;,  0.11863819,
0.11863819,  0.11863819],
[ 0.1459287 ,  0.1459287 ,  0.1459287 , &hellip;,  0.1846614 ,
0.2464215 ,  0.31395693],
&hellip;,
[-0.17406373, -0.17406373, -0.17406373, &hellip;, -0.1497518 ,
-0.18778463, -0.23589221],
[-0.09974818, -0.09974818, -0.09974818, &hellip;, -0.00720227,
-0.07338597, -0.16374877],
[ 0.75580794,  0.75580794,  0.75580794, &hellip;, -0.2887721 ,
-0.0269909 ,  0.29453278]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-fd6c236a-f6ac-42a9-8048-1ccb46893187 class=xr-section-summary-in type=checkbox disabled><label for=section-fd6c236a-f6ac-42a9-8048-1ccb46893187 class=xr-section-summary title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list></ul></div></li><li class=xr-section-item><input id=section-a429fb62-22e3-4d94-8910-8ee01b3cef9b class=xr-section-summary-in type=checkbox disabled><label for=section-a429fb62-22e3-4d94-8910-8ee01b3cef9b class=xr-section-summary title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></p><p>The dataset structure is preserved and has created a new variable called <code>ntr</code> - non-tidal residual.</p><p>By default, this routines will apply <code>scipy.signal.savgol_filter</code> to the non-tidal residuals
to remove some noise. This can be switched off using <code>apply_filter = False</code>.</p><p>The Doodson X0 filter is an alternative way of estimating non-tidal residuals. This will return a new Tidegauge() object containing filtered ssh data:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>dx0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>doodson_x0_filter</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ssh&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># take a look</span>
</span></span><span style=display:flex><span><span style=color:#000>dx0</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,#000);&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body[data-theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1F1F1F;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111111;&ndash;xr-background-color-row-even:#111111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(&rsquo;; }</p> <p>.xr-dim-list:after { content: &lsquo;)&rsquo}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,&rsquo;padding-right:5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-index-preview{grid-column:2/5;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data,.xr-index-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data,.xr-index-data-in:checked~.xr-index-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-index-name div,.xr-index-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data,.xr-index-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2,.xr-no-icon{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:    (t_dim: 720, id_dim: 61)
Coordinates:
longitude  (id_dim) float64 1.292 -3.975 -5.158 -5.051 &hellip; 7.567 350.8 8.717
latitude   (id_dim) float64 51.95 51.57 57.9 51.71 &hellip; 58.0 51.53 53.87
site_name  (id_dim) &lt;U25 'Harwich' 'Mumbles' 'Ullapool' &hellip; 'N/A' 'N/A'
Dimensions without coordinates: t_dim, id_dim
Data variables:
time       (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00
ssh        (id_dim, t_dim) float64 nan nan nan nan nan &hellip; nan nan nan nan</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-7312d402-5fec-409f-8ea4-cbcc1988c158 class=xr-section-summary-in type=checkbox disabled><label for=section-7312d402-5fec-409f-8ea4-cbcc1988c158 class=xr-section-summary title='Expand/collapse section'>Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-82cada81-7627-4f9a-abb1-c7d37459dae2 class=xr-section-summary-in type=checkbox checked><label for=section-82cada81-7627-4f9a-abb1-c7d37459dae2 class=xr-section-summary>Coordinates: <span>(3)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>1.292 -3.975 -5.158 &mldr; 350.8 8.717</div><input id=attrs-59cf3fa8-1c57-46da-b38c-69d480d4abb8 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-59cf3fa8-1c57-46da-b38c-69d480d4abb8 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-72949f0d-0a42-4ef7-8977-616c1c33141d class=xr-var-data-in type=checkbox><label for=data-72949f0d-0a42-4ef7-8977-616c1c33141d title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00,  1.34839000e+00, -4.62044000e+00,  1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01,  5.70300000e-02, -4.00220000e+00,  1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00,  1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00,  1.12150002e+01,  1.18000002e+01,  5.11700010e+00,
1.12500000e+01,  3.52666992e+02,  7.56699991e+00,  3.50816986e+02,
8.71700001e+00])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>51.95 51.57 57.9 &mldr; 51.53 53.87</div><input id=attrs-f304b2eb-0ba3-473f-ae55-c40486b429a7 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-f304b2eb-0ba3-473f-ae55-c40486b429a7 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-f8f236e8-dd3a-4bf5-8b3a-78838689e220 class=xr-var-data-in type=checkbox><label for=data-f8f236e8-dd3a-4bf5-8b3a-78838689e220 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.94798   , 51.57      , 57.89525   , 51.7064    , 54.03167   ,
51.21525   , 58.45661   , 58.44097   , 55.00744   , 51.95675   ,
53.31394   , 52.93436   , 56.62311   , 50.6085    , 53.33167   ,
50.36839   , 51.44564   , 54.49008   , 50.103     , 54.84256   ,
55.00744   , 57.14406   , 60.15403   , 51.55      , 50.71433   ,
49.91847   , 53.44969   , 55.62742   , 53.63103   , 50.78178   ,
57.5987    , 51.11439   , 51.51089   , 49.18333   , 55.00744   ,
54.65081   , 55.00744   , 51.50002   , 55.98983   , 52.473     ,
52.01378   , 54.66475   , 51.21525   , 50.80256   , 58.20711   ,
55.74964   , 54.08539   , 55.20678   , 51.50002   , 55.00744   ,
52.71906   , 51.21097   , 55.00744   , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58.        , 51.53300095,
53.86700058])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>&lt;U25</div><div class='xr-var-preview xr-preview'>'Harwich' 'Mumbles' &mldr; 'N/A' 'N/A'</div><input id=attrs-81521355-9652-4eab-a50c-57cf17119f0d class=xr-var-attrs-in type=checkbox disabled><label for=attrs-81521355-9652-4eab-a50c-57cf17119f0d title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-bed0abac-5db5-4ad0-abca-a900b08b5aac class=xr-var-data-in type=checkbox><label for=data-bed0abac-5db5-4ad0-abca-a900b08b5aac title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &quot;St. Mary's&quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype='&lt;U25')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-9dda7f45-20c1-4c0a-a398-85784f7a5b58 class=xr-section-summary-in type=checkbox checked><label for=section-9dda7f45-20c1-4c0a-a398-85784f7a5b58 class=xr-section-summary>Data variables: <span>(2)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-72510beb-7059-4a50-91f5-5a7836766e60 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-72510beb-7059-4a50-91f5-5a7836766e60 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-cf34106e-cca3-4fd3-9107-5ab06bc68b2e class=xr-var-data-in type=checkbox><label for=data-cf34106e-cca3-4fd3-9107-5ab06bc68b2e title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>ssh</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan &mldr; nan nan nan nan</div><input id=attrs-f6ffbcef-9f9d-4e6f-a7fc-d40611126cb0 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-f6ffbcef-9f9d-4e6f-a7fc-d40611126cb0 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-cd18ff4c-b872-4cdd-8b64-3d1abe33e59a class=xr-var-data-in type=checkbox><label for=data-cd18ff4c-b872-4cdd-8b64-3d1abe33e59a title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan],
&hellip;,
[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-c212bd63-8498-475b-9aeb-c711613153ba class=xr-section-summary-in type=checkbox disabled><label for=section-c212bd63-8498-475b-9aeb-c711613153ba class=xr-section-summary title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list></ul></div></li><li class=xr-section-item><input id=section-548069c9-436a-45d5-b9aa-60a370e5bbf5 class=xr-section-summary-in type=checkbox disabled><label for=section-548069c9-436a-45d5-b9aa-60a370e5bbf5 class=xr-section-summary title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python></code></pre></div><p>We can compare these analyses e.g. the observed timeseries against the harmonic reconstruction. Noting we can in principle extend the harmoninc reconstruction beyond the observation time window.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>figure</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>tide_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>tide_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstructed</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;reconstructed from harmonics&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;orange&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;observed&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_59_0.png alt=png></p><p>We can also look closer at the difference between the observed timeseries and the harmonic reconstruction, that is the non-tidal residual. And we can compare the observed and modelled non-harmonic residual and contrast the different methods of removing the tides. Here we contrast using a harmonic analysis (and creating a &ldquo;non-tidal residual&rdquo;) with the DoodsonX0 filter. Note that the timeseries is far too short for a sensible analysis and that this is really a demonstration of concept.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>figure</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>dx0</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>dx0</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs: doodsonX0 filtered&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;orange&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ntr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;analysis comparison: non-tidal residual vs doodsonX0&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ntr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;model: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;g&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ntr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;model vs observation: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>tight_layout</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_61_0.png alt=png></p><h3 id=threshold-statistics-for-non-tidal-residuals>Threshold Statistics for non-tidal residuals</h3><p>This is a simple extreme value analysis of whatever data you use. It will count the number of peaks and the total time spent over each threshold provided. It will also count the numbers of daily and monthly maxima over each threshold. To this, a Tidegauge object and an array of thresholds (in metres) should be passed. The method return <code>peak_count_*</code>, <code>time_over_threshold_*</code>, <code>dailymax_count_*</code>, <code>monthlymax_count_*</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>thresh_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold_statistics</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>thresholds</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>arange</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0.1</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#000>thresh_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold_statistics</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>thresholds</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>arange</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0.1</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Have a look</span>
</span></span><span style=display:flex><span><span style=color:#000>thresh_obs</span>
</span></span></code></pre></div><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,#000);&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body[data-theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1F1F1F;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111111;&ndash;xr-background-color-row-even:#111111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(&rsquo;; }</p> <p>.xr-dim-list:after { content: &lsquo;)&rsquo}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,&rsquo;padding-right:5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-index-preview{grid-column:2/5;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data,.xr-index-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data,.xr-index-data-in:checked~.xr-index-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-index-name div,.xr-index-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data,.xr-index-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2,.xr-no-icon{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:                  (t_dim: 720, id_dim: 61, threshold: 40)
Coordinates:
longitude                (id_dim) float64 1.292 -3.975 &hellip; 350.8 8.717
latitude                 (id_dim) float64 51.95 51.57 57.9 &hellip; 51.53 53.87
site_name                (id_dim) &lt;U25 'Harwich' 'Mumbles' &hellip; 'N/A' 'N/A'</p>
<ul>
<li>threshold                (threshold) float64 -2.0 -1.9 -1.8 &hellip; 1.7 1.8 1.9
Dimensions without coordinates: t_dim, id_dim
Data variables:
time                     (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30&hellip;
peak_count_ntr           (id_dim, threshold) float64 40.0 40.0 &hellip; 2.0 1.0
time_over_threshold_ntr  (id_dim, threshold) float64 720.0 720.0 &hellip; 5.0 4.0
dailymax_count_ntr       (id_dim, threshold) float64 30.0 30.0 &hellip; 2.0 1.0
monthlymax_count_ntr     (id_dim, threshold) float64 1.0 1.0 1.0 &hellip; 1.0 1.0</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-c6970f69-af0f-4115-9d7d-5d2b627e946f class=xr-section-summary-in type=checkbox disabled><label for=section-c6970f69-af0f-4115-9d7d-5d2b627e946f class=xr-section-summary title='Expand/collapse section'>Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li><li><span class=xr-has-index>threshold</span>: 40</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-2228fca0-740f-437f-ae8f-e4da9b8cd98f class=xr-section-summary-in type=checkbox checked><label for=section-2228fca0-740f-437f-ae8f-e4da9b8cd98f class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>1.292 -3.975 -5.158 &mldr; 350.8 8.717</div><input id=attrs-0924fddf-8913-4ce5-99a3-5d67792ddd8c class=xr-var-attrs-in type=checkbox disabled><label for=attrs-0924fddf-8913-4ce5-99a3-5d67792ddd8c title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-2bd09a20-32d2-4eed-bdf4-a9fc1a9e0b66 class=xr-var-data-in type=checkbox><label for=data-2bd09a20-32d2-4eed-bdf4-a9fc1a9e0b66 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00,  1.34839000e+00, -4.62044000e+00,  1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01,  5.70300000e-02, -4.00220000e+00,  1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00,  1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00,  1.12150002e+01,  1.18000002e+01,  5.11700010e+00,
1.12500000e+01,  3.52666992e+02,  7.56699991e+00,  3.50816986e+02,
8.71700001e+00])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>51.95 51.57 57.9 &mldr; 51.53 53.87</div><input id=attrs-b0e71bee-dc6f-4117-b9a9-1041945da49c class=xr-var-attrs-in type=checkbox disabled><label for=attrs-b0e71bee-dc6f-4117-b9a9-1041945da49c title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-3a277006-aa2a-477d-ba97-061a76e36f30 class=xr-var-data-in type=checkbox><label for=data-3a277006-aa2a-477d-ba97-061a76e36f30 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.94798   , 51.57      , 57.89525   , 51.7064    , 54.03167   ,
51.21525   , 58.45661   , 58.44097   , 55.00744   , 51.95675   ,
53.31394   , 52.93436   , 56.62311   , 50.6085    , 53.33167   ,
50.36839   , 51.44564   , 54.49008   , 50.103     , 54.84256   ,
55.00744   , 57.14406   , 60.15403   , 51.55      , 50.71433   ,
49.91847   , 53.44969   , 55.62742   , 53.63103   , 50.78178   ,
57.5987    , 51.11439   , 51.51089   , 49.18333   , 55.00744   ,
54.65081   , 55.00744   , 51.50002   , 55.98983   , 52.473     ,
52.01378   , 54.66475   , 51.21525   , 50.80256   , 58.20711   ,
55.74964   , 54.08539   , 55.20678   , 51.50002   , 55.00744   ,
52.71906   , 51.21097   , 55.00744   , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58.        , 51.53300095,
53.86700058])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>&lt;U25</div><div class='xr-var-preview xr-preview'>'Harwich' 'Mumbles' &mldr; 'N/A' 'N/A'</div><input id=attrs-3f94474c-62f4-470e-8844-1b9b91442501 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-3f94474c-62f4-470e-8844-1b9b91442501 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-0be70566-832f-485f-a1b2-9f3cf283baf4 class=xr-var-data-in type=checkbox><label for=data-0be70566-832f-485f-a1b2-9f3cf283baf4 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &quot;St. Mary's&quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype='&lt;U25')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span class=xr-has-index>threshold</span></div><div class=xr-var-dims>(threshold)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>-2.0 -1.9 -1.8 -1.7 &mldr; 1.7 1.8 1.9</div><input id=attrs-e41f56f8-c53d-4ba5-8ce6-f6d9131d74ae class=xr-var-attrs-in type=checkbox disabled><label for=attrs-e41f56f8-c53d-4ba5-8ce6-f6d9131d74ae title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-0dcccf51-cc27-46c2-bcc8-b967121c0aa9 class=xr-var-data-in type=checkbox><label for=data-0dcccf51-cc27-46c2-bcc8-b967121c0aa9 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([-2.000000e+00, -1.900000e+00, -1.800000e+00, -1.700000e+00,
-1.600000e+00, -1.500000e+00, -1.400000e+00, -1.300000e+00,
-1.200000e+00, -1.100000e+00, -1.000000e+00, -9.000000e-01,
-8.000000e-01, -7.000000e-01, -6.000000e-01, -5.000000e-01,
-4.000000e-01, -3.000000e-01, -2.000000e-01, -1.000000e-01,
1.776357e-15,  1.000000e-01,  2.000000e-01,  3.000000e-01,
4.000000e-01,  5.000000e-01,  6.000000e-01,  7.000000e-01,
8.000000e-01,  9.000000e-01,  1.000000e+00,  1.100000e+00,
1.200000e+00,  1.300000e+00,  1.400000e+00,  1.500000e+00,
1.600000e+00,  1.700000e+00,  1.800000e+00,  1.900000e+00])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-7ccd207a-2b1d-4d7d-b286-43442cc4a523 class=xr-section-summary-in type=checkbox checked><label for=section-7ccd207a-2b1d-4d7d-b286-43442cc4a523 class=xr-section-summary>Data variables: <span>(5)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-8ad6cde5-961a-44a7-a2d0-f0fae2dbb8d5 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-8ad6cde5-961a-44a7-a2d0-f0fae2dbb8d5 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-a0d163f8-2fec-4c57-b58f-b27499335bd3 class=xr-var-data-in type=checkbox><label for=data-a0d163f8-2fec-4c57-b58f-b27499335bd3 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>peak_count_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>40.0 40.0 40.0 40.0 &mldr; 2.0 2.0 1.0</div><input id=attrs-c352b80d-6804-46fb-84fd-f174f7f8c6b7 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-c352b80d-6804-46fb-84fd-f174f7f8c6b7 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-7dc95d68-2bd4-458c-948b-c2f7cdb07289 class=xr-var-data-in type=checkbox><label for=data-7dc95d68-2bd4-458c-948b-c2f7cdb07289 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[40., 40., 40., &hellip;,  0.,  0.,  0.],
[22., 22., 22., &hellip;,  0.,  0.,  0.],
[35., 35., 35., &hellip;,  0.,  0.,  0.],
&hellip;,
[39., 39., 39., &hellip;,  0.,  0.,  0.],
[42., 42., 42., &hellip;,  0.,  0.,  0.],
[38., 38., 38., &hellip;,  2.,  2.,  1.]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>time_over_threshold_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>720.0 720.0 720.0 &mldr; 8.0 5.0 4.0</div><input id=attrs-fc71fb8e-622c-4f5b-aab7-2473b9402373 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-fc71fb8e-622c-4f5b-aab7-2473b9402373 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-46c40dd9-0848-48b3-870f-151a18dfc36b class=xr-var-data-in type=checkbox><label for=data-46c40dd9-0848-48b3-870f-151a18dfc36b title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[720., 720., 720., &hellip;,   0.,   0.,   0.],
[720., 720., 720., &hellip;,   0.,   0.,   0.],
[720., 720., 720., &hellip;,   0.,   0.,   0.],
&hellip;,
[720., 720., 720., &hellip;,   0.,   0.,   0.],
[720., 720., 720., &hellip;,   0.,   0.,   0.],
[720., 720., 720., &hellip;,   8.,   5.,   4.]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>dailymax_count_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>30.0 30.0 30.0 30.0 &mldr; 3.0 2.0 1.0</div><input id=attrs-f0535e16-8e54-418f-89dd-67cb3a8158d0 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-f0535e16-8e54-418f-89dd-67cb3a8158d0 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-8a5b62b2-7369-49fc-a4f1-18f73fee0cad class=xr-var-data-in type=checkbox><label for=data-8a5b62b2-7369-49fc-a4f1-18f73fee0cad title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[30., 30., 30., &hellip;,  0.,  0.,  0.],
[30., 30., 30., &hellip;,  0.,  0.,  0.],
[30., 30., 30., &hellip;,  0.,  0.,  0.],
&hellip;,
[30., 30., 30., &hellip;,  0.,  0.,  0.],
[30., 30., 30., &hellip;,  0.,  0.,  0.],
[30., 30., 30., &hellip;,  3.,  2.,  1.]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>monthlymax_count_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 &mldr; 1.0 1.0 1.0 1.0</div><input id=attrs-7c328af1-7df9-4e04-998c-560c945e8151 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-7c328af1-7df9-4e04-998c-560c945e8151 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-4d5fc11a-fd3c-495a-b253-29eaf5d2ff04 class=xr-var-data-in type=checkbox><label for=data-4d5fc11a-fd3c-495a-b253-29eaf5d2ff04 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 0., 0., 0.],
&hellip;,
[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 1., 1., 1.]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-e4884f8f-cdbe-4d60-93c7-95c6bf5e385e class=xr-section-summary-in type=checkbox><label for=section-e4884f8f-cdbe-4d60-93c7-95c6bf5e385e class=xr-section-summary>Indexes: <span>(1)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-index-name><div>threshold</div></div><div class=xr-index-preview>PandasIndex</div><div></div><input id=index-d802db09-6d30-4613-9d27-c58edf08ab0a class=xr-index-data-in type=checkbox><label for=index-d802db09-6d30-4613-9d27-c58edf08ab0a title='Show/Hide index repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-index-data><pre>PandasIndex(Index([                  -2.0,                   -1.9,    -1.7999999999999998,
-1.6999999999999997,    -1.5999999999999996,    -1.4999999999999996,
-1.3999999999999995,    -1.2999999999999994,    -1.1999999999999993,
-1.0999999999999992,    -0.9999999999999991,     -0.899999999999999,
-0.7999999999999989,    -0.6999999999999988,    -0.5999999999999988,
-0.49999999999999867,    -0.3999999999999986,    -0.2999999999999985,
-0.1999999999999984,   -0.09999999999999831, 1.7763568394002505e-15,
0.10000000000000187,    0.20000000000000195,    0.30000000000000204,
0.40000000000000213,     0.5000000000000022,     0.6000000000000023,
0.7000000000000024,     0.8000000000000025,     0.9000000000000026,
1.0000000000000027,     1.1000000000000028,     1.2000000000000028,
1.300000000000003,      1.400000000000003,      1.500000000000003,
1.6000000000000032,     1.7000000000000033,     1.8000000000000034,
1.9000000000000035],
dtype='float64', name='threshold'))</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-75041ef9-1565-4e5a-9ba4-3a2d0b1cdb47 class=xr-section-summary-in type=checkbox disabled><label for=section-75041ef9-1565-4e5a-9ba4-3a2d0b1cdb47 class=xr-section-summary title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>peak_count_ntr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>mean</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;id_dim&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#plt.ylim([0,15])</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#34;Observed peaks over threshold&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xlabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Analysis threshold (m)&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ylabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;event count&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>Text(0, 0.5, 'event count')
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_65_1.png alt=png></p><p>Note that the non-tidal residual is a noisy timeseries (computed as a difference between two timeseries) so peaks do not necessarily correspond to peaks in total water level. For this reason <code>time_over_threshold_*</code> can be useful. Below we see that about 28% (y-axis) of the observations of non-tidal residual exceed 20cm (x-axis). Again, threshold statistics are more useful with a longer record.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>normalised_event_count</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>100</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_over_threshold_ntr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_over_threshold_ntr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>max</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>normalised_event_count</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ylim</span><span style=color:#000;font-weight:700>([</span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>40</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xlim</span><span style=color:#000;font-weight:700>([</span><span style=color:#0000cf;font-weight:700>0.0</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>0.4</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#34;time over threshold&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xlabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Analysis threshold (m)&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ylabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;normalised event count (%)&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>22</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>normalised_event_count</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>22</span><span style=color:#000;font-weight:700>],</span> <span style=color:#4e9a06>&#39;r+&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>markersize</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre><code>[&lt;matplotlib.lines.Line2D at 0x7f951b9ce560&gt;]
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_67_1.png alt=png></p><h2 id=other-tidegaugeanalysis-methods>Other TidegaugeAnalysis methods</h2><h3 id=calculate-errors>Calculate errors</h3><p>The difference() routine will calculate differences, absolute_differences and squared differenced for all variables. Corresponding new variables are created with names <code>diff_*</code>, <code>abs_diff_*</code> and <code>square_diff_*</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>ntr_diff</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>difference</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>ssh_diff</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>difference</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Take a look</span>
</span></span><span style=display:flex><span><span style=color:#000>ntr_diff</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</span></span></code></pre></div><pre><code>Tidegauge object at 0x55a7d8e51980 initialised
Tidegauge object at 0x55a7d8e51980 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,#000);&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body[data-theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1F1F1F;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111111;&ndash;xr-background-color-row-even:#111111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(&rsquo;; }</p> <p>.xr-dim-list:after { content: &lsquo;)&rsquo}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,&rsquo;padding-right:5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-index-preview{grid-column:2/5;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data,.xr-index-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data,.xr-index-data-in:checked~.xr-index-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-index-name div,.xr-index-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data,.xr-index-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2,.xr-no-icon{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:          (t_dim: 720, id_dim: 61)
Coordinates:</p>
<ul>
<li>time             (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00
site_name        (id_dim) &lt;U25 'Harwich' 'Mumbles' &hellip; 'N/A' 'N/A'
longitude        (id_dim) float64 1.292 -3.975 -5.158 &hellip; 7.567 350.8 8.717
latitude         (id_dim) float64 51.95 51.57 57.9 &hellip; 58.0 51.53 53.87
Dimensions without coordinates: t_dim, id_dim
Data variables:
diff_ntr         (id_dim, t_dim) float64 nan nan nan &hellip; 0.05885 0.3435
abs_diff_ntr     (id_dim, t_dim) float64 nan nan nan &hellip; 0.05885 0.3435
square_diff_ntr  (id_dim, t_dim) float64 nan nan nan &hellip; 0.003464 0.118</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-f4135273-9513-4a1c-aa84-109f1feb251b class=xr-section-summary-in type=checkbox disabled><label for=section-f4135273-9513-4a1c-aa84-109f1feb251b class=xr-section-summary title='Expand/collapse section'>Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span class=xr-has-index>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-ca25a250-6903-457d-8caa-4cd5250d3297 class=xr-section-summary-in type=checkbox checked><label for=section-ca25a250-6903-457d-8caa-4cd5250d3297 class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span class=xr-has-index>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-6917b05b-8c8a-4fc4-b0a8-437f71d67905 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-6917b05b-8c8a-4fc4-b0a8-437f71d67905 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-1b32c2e4-4aef-4ca4-8aec-1ddc521da0ee class=xr-var-data-in type=checkbox><label for=data-1b32c2e4-4aef-4ca4-8aec-1ddc521da0ee title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', &hellip;, '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>&lt;U25</div><div class='xr-var-preview xr-preview'>'Harwich' 'Mumbles' &mldr; 'N/A' 'N/A'</div><input id=attrs-a936fc95-4b76-411e-bb1e-6eeb17eeb52f class=xr-var-attrs-in type=checkbox disabled><label for=attrs-a936fc95-4b76-411e-bb1e-6eeb17eeb52f title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-038a939f-f168-4ca2-99b6-dc9e4b1f8813 class=xr-var-data-in type=checkbox><label for=data-038a939f-f168-4ca2-99b6-dc9e4b1f8813 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &quot;St. Mary's&quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype='&lt;U25')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>1.292 -3.975 -5.158 &mldr; 350.8 8.717</div><input id=attrs-35b04698-6c9e-4b95-a577-e6b6d440db5e class=xr-var-attrs-in type=checkbox disabled><label for=attrs-35b04698-6c9e-4b95-a577-e6b6d440db5e title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-38e0e444-8d2e-48c3-8957-ca0d08c33418 class=xr-var-data-in type=checkbox><label for=data-38e0e444-8d2e-48c3-8957-ca0d08c33418 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00,  1.34839000e+00, -4.62044000e+00,  1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01,  5.70300000e-02, -4.00220000e+00,  1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00,  1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00,  1.12150002e+01,  1.18000002e+01,  5.11700010e+00,
1.12500000e+01,  3.52666992e+02,  7.56699991e+00,  3.50816986e+02,
8.71700001e+00])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>51.95 51.57 57.9 &mldr; 51.53 53.87</div><input id=attrs-e5c04778-0d24-46b7-81be-3ec33063e90e class=xr-var-attrs-in type=checkbox disabled><label for=attrs-e5c04778-0d24-46b7-81be-3ec33063e90e title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-6be9f5bf-a32d-4ad2-b733-5e4dbfc4f967 class=xr-var-data-in type=checkbox><label for=data-6be9f5bf-a32d-4ad2-b733-5e4dbfc4f967 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.94798   , 51.57      , 57.89525   , 51.7064    , 54.03167   ,
51.21525   , 58.45661   , 58.44097   , 55.00744   , 51.95675   ,
53.31394   , 52.93436   , 56.62311   , 50.6085    , 53.33167   ,
50.36839   , 51.44564   , 54.49008   , 50.103     , 54.84256   ,
55.00744   , 57.14406   , 60.15403   , 51.55      , 50.71433   ,
49.91847   , 53.44969   , 55.62742   , 53.63103   , 50.78178   ,
57.5987    , 51.11439   , 51.51089   , 49.18333   , 55.00744   ,
54.65081   , 55.00744   , 51.50002   , 55.98983   , 52.473     ,
52.01378   , 54.66475   , 51.21525   , 50.80256   , 58.20711   ,
55.74964   , 54.08539   , 55.20678   , 51.50002   , 55.00744   ,
52.71906   , 51.21097   , 55.00744   , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58.        , 51.53300095,
53.86700058])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-5433c9e5-ebc7-4ff7-bd28-4f1b1bdb3ef5 class=xr-section-summary-in type=checkbox checked><label for=section-5433c9e5-ebc7-4ff7-bd28-4f1b1bdb3ef5 class=xr-section-summary>Data variables: <span>(3)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>diff_ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>nan nan nan &mldr; 0.05885 0.3435</div><input id=attrs-26abef9a-cb47-4432-b6f8-aa5fd5d5bd82 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-26abef9a-cb47-4432-b6f8-aa5fd5d5bd82 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-61d2cf0f-11e1-41de-bd3f-0db72cbef720 class=xr-var-data-in type=checkbox><label for=data-61d2cf0f-11e1-41de-bd3f-0db72cbef720 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[        nan,         nan,         nan, &hellip;, -0.32699312,
-0.12564265,  0.13424107],
[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
[        nan,         nan,         nan, &hellip;,  0.27731735,
0.3287257 ,  0.39544093],
&hellip;,
[        nan,         nan,         nan, &hellip;, -0.13998686,
-0.18434602, -0.23884966],
[        nan,         nan,         nan, &hellip;,  0.09161719,
0.03131287, -0.05355329],
[        nan,         nan,         nan, &hellip;, -0.16968976,
0.05885439,  0.34348952]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>abs_diff_ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>nan nan nan &mldr; 0.05885 0.3435</div><input id=attrs-b5cb29a5-15a4-4742-b40c-848a3035e1e8 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-b5cb29a5-15a4-4742-b40c-848a3035e1e8 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-a3b39a98-2de7-45c3-8ca6-ff188de68aa4 class=xr-var-data-in type=checkbox><label for=data-a3b39a98-2de7-45c3-8ca6-ff188de68aa4 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[       nan,        nan,        nan, &hellip;, 0.32699312, 0.12564265,
0.13424107],
[       nan,        nan,        nan, &hellip;,        nan,        nan,
nan],
[       nan,        nan,        nan, &hellip;, 0.27731735, 0.3287257 ,
0.39544093],
&hellip;,
[       nan,        nan,        nan, &hellip;, 0.13998686, 0.18434602,
0.23884966],
[       nan,        nan,        nan, &hellip;, 0.09161719, 0.03131287,
0.05355329],
[       nan,        nan,        nan, &hellip;, 0.16968976, 0.05885439,
0.34348952]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>square_diff_ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class='xr-var-preview xr-preview'>nan nan nan &mldr; 0.003464 0.118</div><input id=attrs-7892d6b0-db6c-4eb5-b7b4-d03946789b30 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-7892d6b0-db6c-4eb5-b7b4-d03946789b30 title='Show/Hide attributes'><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-6eab87b4-05ca-4d9f-88ec-32ee70ca6550 class=xr-var-data-in type=checkbox><label for=data-6eab87b4-05ca-4d9f-88ec-32ee70ca6550 title='Show/Hide data repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[       nan,        nan,        nan, &hellip;, 0.1069245 , 0.01578608,
0.01802066],
[       nan,        nan,        nan, &hellip;,        nan,        nan,
nan],
[       nan,        nan,        nan, &hellip;, 0.07690491, 0.10806059,
0.15637353],
&hellip;,
[       nan,        nan,        nan, &hellip;, 0.01959632, 0.03398346,
0.05704916],
[       nan,        nan,        nan, &hellip;, 0.00839371, 0.0009805 ,
0.00286796],
[       nan,        nan,        nan, &hellip;, 0.02879461, 0.00346384,
0.11798505]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-6ba0bb6c-83c8-4405-9dff-3006c26ffa3d class=xr-section-summary-in type=checkbox><label for=section-6ba0bb6c-83c8-4405-9dff-3006c26ffa3d class=xr-section-summary>Indexes: <span>(1)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-index-name><div>time</div></div><div class=xr-index-preview>PandasIndex</div><div></div><input id=index-56b8bbc2-da07-4c21-8c93-a3d9493d7c2f class=xr-index-data-in type=checkbox><label for=index-56b8bbc2-da07-4c21-8c93-a3d9493d7c2f title='Show/Hide index repr'><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-index-data><pre>PandasIndex(DatetimeIndex(['2007-01-01 00:00:00', '2007-01-01 01:00:00',
'2007-01-01 02:00:00', '2007-01-01 03:00:00',
'2007-01-01 04:00:00', '2007-01-01 05:00:00',
'2007-01-01 06:00:00', '2007-01-01 07:00:00',
'2007-01-01 08:00:00', '2007-01-01 09:00:00',
&hellip;
'2007-01-30 14:00:00', '2007-01-30 15:00:00',
'2007-01-30 16:00:00', '2007-01-30 17:00:00',
'2007-01-30 18:00:00', '2007-01-30 19:00:00',
'2007-01-30 20:00:00', '2007-01-30 21:00:00',
'2007-01-30 22:00:00', '2007-01-30 23:00:00'],
dtype='datetime64[ns]', name='time', length=720, freq=None))</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-8490accf-21b8-41d6-82f4-79543ffa6af5 class=xr-section-summary-in type=checkbox disabled><label for=section-8490accf-21b8-41d6-82f4-79543ffa6af5 class=xr-section-summary title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></li></ul><p>We can then easily get mean errors, MAE and MSE</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>mean_stats</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ntr_diff</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>mean</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;t_dim&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>skipna</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>True</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python></code></pre></div><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it!</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/British-Oceanographic-Data-Centre/COAsT/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified December 11, 2023: <a href=https://github.com/British-Oceanographic-Data-Centre/COAsT-site/commit/b62c6038765e7e4be6673fa5c81b65e889ed1967>Updated Altimetry notebook pages from coast repo. (b62c603)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2 justify-content-center"><div class="td-footer__copyright-etc col-12 col-sm-12 text-center py-2 order-sm-2"><div><span>&copy; Copyright (c) 2023 British Oceanographic Data Centre</span></div><div class=p-2><span class="foot-link ms-1"><a class="foot-link text-white" href=https://github.com/British-Oceanographic-Data-Centre/COAsT/blob/develop/LICENSE target=_blank rel=noopener>Privacy Policy</a></span></div><div class=foot-link><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/British-Oceanographic-Data-Centre/COAsT aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div></div></div></div></footer></div><script src=/COAsT/js/main.min.dbce55f458627803159d33e2018963753f9167a6a592df6f4676b05b7265571c.js integrity="sha256-285V9FhieAMVnTPiAYljdT+RZ6alkt9vRnawW3JlVxw=" crossorigin=anonymous></script><script defer src=/COAsT/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin=anonymous></script><script src=/COAsT/js/tabpane-persist.js></script></body></html>