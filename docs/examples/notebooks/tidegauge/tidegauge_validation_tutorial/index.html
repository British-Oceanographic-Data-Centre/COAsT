<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.70.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><script>(function(h,o,t,j,a,r){h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};h._hjSettings={hjid:2044976,hjsv:6};a=o.getElementsByTagName('head')[0];r=o.createElement('script');r.async=1;r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;a.appendChild(r);})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');</script><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/COAsT/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/COAsT/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/COAsT/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/COAsT/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/COAsT/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/COAsT/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/COAsT/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/COAsT/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/COAsT/favicons/android-192x192.png sizes=192x192><title>Tidegauge validation tutorial | COAsT</title><meta property="og:title" content="Tidegauge validation tutorial"><meta property="og:description" content="Tidegauge validation tutorial example."><meta property="og:type" content="article"><meta property="og:url" content="https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/tidegauge_validation_tutorial/"><meta property="article:modified_time" content="2022-10-20T10:56:25+00:00"><meta property="og:site_name" content="COAsT"><meta itemprop=name content="Tidegauge validation tutorial"><meta itemprop=description content="Tidegauge validation tutorial example."><meta itemprop=dateModified content="2022-10-20T10:56:25+00:00"><meta itemprop=wordCount content="10850"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Tidegauge validation tutorial"><meta name=twitter:description content="Tidegauge validation tutorial example."><link rel=preload href=/COAsT/scss/main.min.bb1ca766e41a0e946ad64cf4afe1ef9cda4b8f5ac09cb29881652bb359f0df3c.css as=style><link href=/COAsT/scss/main.min.bb1ca766e41a0e946ad64cf4afe1ef9cda4b8f5ac09cb29881652bb359f0df3c.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/COAsT/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zM197.0804 232.033c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zM197.0839 232.0372c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zM197.0839 232.0372c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zM197.0804 177.6188c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zM197.0839 177.623c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zM197.0839 177.623c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zM197.5309 286.4723c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zM197.5344 286.4765c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zM197.5344 286.4765c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zM197.0804 340.5784c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zM197.0839 340.5826c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zM197.0839 340.5826c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">COAsT</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/COAsT/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/COAsT/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/COAsT/community/><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/COAsT/offline-search-index.6f000397ff6554b2b4f4a4d04392d416c1dac5af908cc3b18e6510fa429de088e20c3d3b33014cd43fff67a66daf2f31232d4eb29657ef68f83a9ba8b09f22a5.json data-offline-search-base-href=/></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/COAsT/offline-search-index.6f000397ff6554b2b4f4a4d04392d416c1dac5af908cc3b18e6510fa429de088e20c3d3b33014cd43fff67a66daf2f31232d4eb29657ef68f83a9ba8b09f22a5.json data-offline-search-base-href=/>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav pt-2 pl-4" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a></li><ul><li class="collapse show" id=coastdocs><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/overview/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Overview</a></li><ul><li class=collapse id=coastdocsoverview></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/getting-started/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Getting Started</a></li><ul><li class=collapse id=coastdocsgetting-started><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/getting-started/getting-started-at-liverpool/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Getting started at Liverpool</a></li><ul><li class=collapse id=coastdocsgetting-startedgetting-started-at-liverpool></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Examples</a></li><ul><li class="collapse show" id=coastdocsexamples><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/notebooks/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Notebooks</a></li><ul><li class="collapse show" id=coastdocsexamplesnotebooks><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/notebooks/gridded/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Gridded</a></li><ul><li class=collapse id=coastdocsexamplesnotebooksgridded><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedcontour_tutorial href=/COAsT/docs/examples/notebooks/gridded/contour_tutorial/>Contour tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedintroduction_to_gridded_class href=/COAsT/docs/examples/notebooks/gridded/introduction_to_gridded_class/>Introduction to gridded class</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedpotential_energy_tutorial href=/COAsT/docs/examples/notebooks/gridded/potential_energy_tutorial/>Potential energy tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedpycnocline_tutorial href=/COAsT/docs/examples/notebooks/gridded/pycnocline_tutorial/>Pycnocline tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedregridding_with_xesmf_tutorial href=/COAsT/docs/examples/notebooks/gridded/regridding_with_xesmf_tutorial/>Regridding with xesmf tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedseasia_dic_example_plot_tutorial href=/COAsT/docs/examples/notebooks/gridded/seasia_dic_example_plot_tutorial/>Seasia dic example plot tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgriddedtransect_tutorial href=/COAsT/docs/examples/notebooks/gridded/transect_tutorial/>Transect tutorial</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/notebooks/general/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">General utility</a></li><ul><li class=collapse id=coastdocsexamplesnotebooksgeneral><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralclimatology_tutorial href=/COAsT/docs/examples/notebooks/general/climatology_tutorial/>Climatology tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneraldask_wrapper_template_tutorial href=/COAsT/docs/examples/notebooks/general/dask_wrapper_template_tutorial/>Dask wrapper template tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneraleof_tutorial href=/COAsT/docs/examples/notebooks/general/eof_tutorial/>Eof tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralexport_to_netcdf_tutorial href=/COAsT/docs/examples/notebooks/general/export_to_netcdf_tutorial/>Export to netcdf tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksgeneralseasonal_decomp_example href=/COAsT/docs/examples/notebooks/general/seasonal_decomp_example/>Seasonal decomp example</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/notebooks/altimetry/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Altimety</a></li><ul><li class=collapse id=coastdocsexamplesnotebooksaltimetry><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksaltimetryaltimetry_tutorial href=/COAsT/docs/examples/notebooks/altimetry/altimetry_tutorial/>Altimetry tutorial</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/notebooks/profile/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Profile</a></li><ul><li class=collapse id=coastdocsexamplesnotebooksprofile><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofile0_profile_introduction href=/COAsT/docs/examples/notebooks/profile/0._profile_introduction/>0. profile introduction</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofile1_analysis_preprocess_en4 href=/COAsT/docs/examples/notebooks/profile/1._analysis_preprocess_en4/>1. analysis preprocess en4</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofile2_analysis_extract_and_compare href=/COAsT/docs/examples/notebooks/profile/2._analysis_extract_and_compare/>2. analysis extract and compare</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofile3_analysis_extract_and_compare_single_process_tutorial href=/COAsT/docs/examples/notebooks/profile/3._analysis_extract_and_compare_single_process_tutorial/>3. analysis extract and compare single process tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofile4_analysis_mask_means_tutorial href=/COAsT/docs/examples/notebooks/profile/4._analysis_mask_means_tutorial/>4. analysis mask means tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofile5_analysis_average_into_grid_boxes href=/COAsT/docs/examples/notebooks/profile/5._analysis_average_into_grid_boxes/>5. analysis average into grid boxes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebooksprofilewod_bgc_ragged_example href=/COAsT/docs/examples/notebooks/profile/wod_bgc_ragged_example/>Wod bgc ragged example</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/notebooks/tidegauge/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Tidegauge</a></li><ul><li class="collapse show" id=coastdocsexamplesnotebookstidegauge><a class="td-sidebar-link td-sidebar-link__page active" id=m-coastdocsexamplesnotebookstidegaugetidegauge_validation_tutorial href=/COAsT/docs/examples/notebooks/tidegauge/tidegauge_validation_tutorial/>Tidegauge validation tutorial</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesnotebookstidegaugetidetable_tutorial href=/COAsT/docs/examples/notebooks/tidegauge/tidetable_tutorial/>Tidetable tutorial</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/examples/remote-datasets/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Remote Datasets</a></li><ul><li class=collapse id=coastdocsexamplesremote-datasets><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesremote-datasetscopernicus href=/COAsT/docs/examples/remote-datasets/copernicus/>Copernicus</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsexamplesconfigs_gallery href=/COAsT/docs/examples/configs_gallery/>Gallery</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/contributing_package/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Contributing: COAsT</a></li><ul><li class=collapse id=coastdocscontributing_package><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing_packagepython_style href=/COAsT/docs/contributing_package/python_style/>Python: Style</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing_packagepython_structure href=/COAsT/docs/contributing_package/python_structure/>Python: Structure</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing_packagepython_logging href=/COAsT/docs/contributing_package/python_logging/>Logging</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing_packagelazy-loading href=/COAsT/docs/contributing_package/lazy-loading/>Lazy</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing_packagedask href=/COAsT/docs/contributing_package/dask/>Dask</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing_packagebuild_test href=/COAsT/docs/contributing_package/build_test/>Build test</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing_packagepush_to_master href=/COAsT/docs/contributing_package/push_to_master/>Push to master</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/contributing-docs/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Contributing: Documentation</a></li><ul><li class=collapse id=coastdocscontributing-docs><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing-docsgithub_actions_flowchart href=/COAsT/docs/contributing-docs/github_actions_flowchart/>Github Actions Flowchart</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing-docsgithub_workflow href=/COAsT/docs/contributing-docs/github_workflow/>Github Workflow</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocscontributing-docshugo href=/COAsT/docs/contributing-docs/hugo/>hugo</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/COAsT/docs/reference/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Reference</a></li><ul><li class=collapse id=coastdocsreference><a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencealtimetry href=/COAsT/docs/reference/altimetry/>Altimetry</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceargos href=/COAsT/docs/reference/argos/>Argos</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceclimatology href=/COAsT/docs/reference/climatology/>Climatology</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecoast href=/COAsT/docs/reference/coast/>Coast</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceconfig_parser href=/COAsT/docs/reference/config_parser/>Config_parser</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceconfig_structure href=/COAsT/docs/reference/config_structure/>Config_structure</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecontour href=/COAsT/docs/reference/contour/>Contour</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecopernicus href=/COAsT/docs/reference/copernicus/>Copernicus</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencecrps_util href=/COAsT/docs/reference/crps_util/>Crps_util</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencedocsy_tools href=/COAsT/docs/reference/docsy_tools/>Docsy_tools</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceeof href=/COAsT/docs/reference/eof/>Eof</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceexperiments_file_handling href=/COAsT/docs/reference/experiments_file_handling/>Experiments_file_handling</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencegeneral_utils href=/COAsT/docs/reference/general_utils/>General_utils</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceglider href=/COAsT/docs/reference/glider/>Glider</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencegridded href=/COAsT/docs/reference/gridded/>Gridded</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreference href=/COAsT/docs/reference/>Index</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencelagrangian href=/COAsT/docs/reference/lagrangian/>Lagrangian</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencelogging_util href=/COAsT/docs/reference/logging_util/>Logging_util</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencemask_maker href=/COAsT/docs/reference/mask_maker/>Mask_maker</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceoceanparcels href=/COAsT/docs/reference/oceanparcels/>Oceanparcels</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceopendap href=/COAsT/docs/reference/opendap/>Opendap</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceplot_util href=/COAsT/docs/reference/plot_util/>Plot_util</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceprofile href=/COAsT/docs/reference/profile/>Profile</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceprofile_analysis href=/COAsT/docs/reference/profile_analysis/>Profile_analysis</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferenceseasons href=/COAsT/docs/reference/seasons/>Seasons</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencestats_util href=/COAsT/docs/reference/stats_util/>Stats_util</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetidegauge href=/COAsT/docs/reference/tidegauge/>Tidegauge</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetidegauge_analysis href=/COAsT/docs/reference/tidegauge_analysis/>Tidegauge_analysis</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetimeseries href=/COAsT/docs/reference/timeseries/>Timeseries</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencetrack href=/COAsT/docs/reference/track/>Track</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coastdocsreferencexesmf_convert href=/COAsT/docs/reference/xesmf_convert/>Xesmf_convert</a></li></ul></ul></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/British-Oceanographic-Data-Centre/COAsT-site/edit/master/content/en/docs/Examples/Notebooks/Tidegauge/tidegauge_validation_tutorial.md target=_blank><i class="fa fa-edit fa-fw"></i>Edit this page</a>
<a href="https://github.com/British-Oceanographic-Data-Centre/COAsT-site/issues/new?title=Tidegauge%20validation%20tutorial" target=_blank><i class="fab fa-github fa-fw"></i>Create documentation issue</a>
<a href=https://github.com/British-Oceanographic-Data-Centre/COAsT/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i>Create project issue</a></div><nav id=TableOfContents><ul><li><ul><li><a href=#import-necessary-libraries>Import necessary libraries</a></li><li><a href=#define-paths>Define paths</a></li><li><a href=#reading-data>Reading data</a></li></ul></li><li><a href=#quick-plotting-to-visualise-tidegauge-data>Quick plotting to visualise Tidegauge data</a></li><li><a href=#basic-manipulation-subsetting--plotting>Basic manipulation: subsetting + plotting</a><ul><li><a href=#gridded-model-comparison>Gridded model comparison</a></li><li><a href=#interpolate-model-data-onto-obs-locations>Interpolate model data onto obs locations</a></li></ul></li><li><a href=#tidegauge-analysis-methods>Tidegauge analysis methods</a><ul><li><a href=#harmonic-analysis--non-tidal-residuals>Harmonic Analysis & Non tidal-Residuals</a></li><li><a href=#calculate-non-tidal-residuals>Calculate non tidal residuals</a></li><li><a href=#threshold-statistics-for-non-tidal-residuals>Threshold Statistics for non-tidal residuals</a></li></ul></li><li><a href=#other-tidegaugeanalysis-methods>Other TidegaugeAnalysis methods</a><ul><li><a href=#calculate-errors>Calculate errors</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/>Examples</a></li><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/>Notebooks</a></li><li class=breadcrumb-item><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/>Tidegauge</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://british-oceanographic-data-centre.github.io/COAsT/docs/examples/notebooks/tidegauge/tidegauge_validation_tutorial/>Tidegauge validation tutorial</a></li></ol></nav><div class=td-content><h1>Tidegauge validation tutorial</h1><div class=lead>Tidegauge validation tutorial example.</div><p class=reading-time><i class="fa fa-clock" aria-hidden=true></i>51 minute read</p><p>This tutorial gives an overview of some of validation tools available when
using the Tidegauge objects in COAsT.</p><p>This includes:</p><ul><li>creating tidegauge objects<ul><li>reading in tidegauge data</li><li>creating tidegauge object from gridded simulation data</li></ul></li><li>basic plotting<ul><li>on maps and timeseries</li></ul></li><li>analysis<ul><li>harmonic analysis and calculation of non-tidal residual</li><li>doodsonX0 tidal filtering</li><li>threshold statistics</li><li>error calculation: mean errors, mean absolute error (MAE), mean square error (MSE)</li></ul></li></ul><h3 id=import-necessary-libraries>Import necessary libraries</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>xarray</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>xr</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>coast</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>datetime</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>matplotlib.pyplot</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>plt</span>
</code></pre></div><h3 id=define-paths>Define paths</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>fn_dom</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_NEMO_DOMAIN&gt;&#34;</span>
<span style=color:#000>fn_dat</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_NEMO_DATA&gt;&#34;</span>
<span style=color:#000>fn_config</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_CONFIG.json&gt;&#34;</span>
<span style=color:#000>fn_tg</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;PATH_TO_TIDEGAUGE_NETCDF&gt;&#34;</span>  <span style=color:#8f5902;font-style:italic># This should already be processed, on the same time dimension</span>

<span style=color:#8f5902;font-style:italic># Change this to 0 to not use default files.</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span>
    <span style=color:#8f5902;font-style:italic>#print(f&#34;Use default files&#34;)</span>
    <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;./example_files/&#34;</span>
    <span style=color:#000>fn_dom</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;coast_example_nemo_domain.nc&#34;</span>
    <span style=color:#000>fn_dat</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;coast_example_nemo_data.nc&#34;</span>
    <span style=color:#000>fn_config</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;./config/example_nemo_grid_t.json&#34;</span>
    <span style=color:#000>fn_tidegauge</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;tide_gauges/lowestoft-p024-uk-bodc&#34;</span>
    <span style=color:#000>fn_tg</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>dir</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;tide_gauges/coast_example_tidegauges.nc&#34;</span>  <span style=color:#8f5902;font-style:italic># These are a collection (xr.DataSet) of tidegauge observations. Created for this demonstration, they are synthetic.</span>
</code></pre></div><h3 id=reading-data>Reading data</h3><p>We can create our empty tidegauge object:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>tidegauge</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Tidegauge</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><p>The <code>Tidegauge</code> class contains multiple methods for reading different typical
tidegauge formats. This includes reading from the GESLA and BODC databases.
To read a gesla file between two dates, we can use:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>date0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>date1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>tidegauge</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_gesla_v3</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_tidegauge</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>date_start</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>date0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>date_end</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>date1</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>A Tidegauge object is a type of Timeseries object, so it has the form:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>tidegauge</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</code></pre></div><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,rgba(0,0,0,1));&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,0.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,0.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1f1f1f;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111;&ndash;xr-background-color-row-even:#111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(';
}</p> <p>.xr-dim-list:after { content: &lsquo;)';
}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,';
padding-right: 5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:    (id_dim: 1, t_dim: 193)
Coordinates:
time       (t_dim) datetime64[ns] 2007-01-10 &hellip; 2007-01-12
longitude  (id_dim) float64 1.751
latitude   (id_dim) float64 52.47
id_name    (id_dim) &lt;U9 'Lowestoft'
Dimensions without coordinates: id_dim, t_dim
Data variables:
ssh        (id_dim, t_dim) float64 2.818 2.823 2.871 &hellip; 3.214 3.257 3.371
qc_flags   (id_dim, t_dim) int64 1 1 1 1 1 1 1 1 1 1 &hellip; 1 1 1 1 1 1 1 1 1 1</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-6f996409-8392-4f2f-84eb-b814709b937d class=xr-section-summary-in type=checkbox disabled><label for=section-6f996409-8392-4f2f-84eb-b814709b937d class=xr-section-summary title="Expand/collapse section">Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>id_dim</span>: 1</li><li><span>t_dim</span>: 193</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-bdc76214-ab25-4250-9ca2-17b788e6d6b6 class=xr-section-summary-in type=checkbox checked><label for=section-bdc76214-ab25-4250-9ca2-17b788e6d6b6 class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class="xr-var-preview xr-preview">2007-01-10 &mldr; 2007-01-12</div><input id=attrs-458e0adf-2ab8-4ed3-b788-06a8746752e5 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-458e0adf-2ab8-4ed3-b788-06a8746752e5 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-b04d2bb0-8dd0-452c-af3e-faea58c04f8d class=xr-var-data-in type=checkbox><label for=data-b04d2bb0-8dd0-452c-af3e-faea58c04f8d title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-10T00:00:00.000000000', '2007-01-10T00:15:00.000000000',
'2007-01-10T00:30:00.000000000', '2007-01-10T00:45:00.000000000',
'2007-01-10T01:00:00.000000000', '2007-01-10T01:15:00.000000000',
'2007-01-10T01:30:00.000000000', '2007-01-10T01:45:00.000000000',
'2007-01-10T02:00:00.000000000', '2007-01-10T02:15:00.000000000',
'2007-01-10T02:30:00.000000000', '2007-01-10T02:45:00.000000000',
'2007-01-10T03:00:00.000000000', '2007-01-10T03:15:00.000000000',
'2007-01-10T03:30:00.000000000', '2007-01-10T03:45:00.000000000',
'2007-01-10T04:00:00.000000000', '2007-01-10T04:15:00.000000000',
'2007-01-10T04:30:00.000000000', '2007-01-10T04:45:00.000000000',
'2007-01-10T05:00:00.000000000', '2007-01-10T05:15:00.000000000',
'2007-01-10T05:30:00.000000000', '2007-01-10T05:45:00.000000000',
'2007-01-10T06:00:00.000000000', '2007-01-10T06:15:00.000000000',
'2007-01-10T06:30:00.000000000', '2007-01-10T06:45:00.000000000',
'2007-01-10T07:00:00.000000000', '2007-01-10T07:15:00.000000000',
'2007-01-10T07:30:00.000000000', '2007-01-10T07:45:00.000000000',
'2007-01-10T08:00:00.000000000', '2007-01-10T08:15:00.000000000',
'2007-01-10T08:30:00.000000000', '2007-01-10T08:45:00.000000000',
'2007-01-10T09:00:00.000000000', '2007-01-10T09:15:00.000000000',
'2007-01-10T09:30:00.000000000', '2007-01-10T09:45:00.000000000',
&hellip;
'2007-01-11T14:30:00.000000000', '2007-01-11T14:45:00.000000000',
'2007-01-11T15:00:00.000000000', '2007-01-11T15:15:00.000000000',
'2007-01-11T15:30:00.000000000', '2007-01-11T15:45:00.000000000',
'2007-01-11T16:00:00.000000000', '2007-01-11T16:15:00.000000000',
'2007-01-11T16:30:00.000000000', '2007-01-11T16:45:00.000000000',
'2007-01-11T17:00:00.000000000', '2007-01-11T17:15:00.000000000',
'2007-01-11T17:30:00.000000000', '2007-01-11T17:45:00.000000000',
'2007-01-11T18:00:00.000000000', '2007-01-11T18:15:00.000000000',
'2007-01-11T18:30:00.000000000', '2007-01-11T18:45:00.000000000',
'2007-01-11T19:00:00.000000000', '2007-01-11T19:15:00.000000000',
'2007-01-11T19:30:00.000000000', '2007-01-11T19:45:00.000000000',
'2007-01-11T20:00:00.000000000', '2007-01-11T20:15:00.000000000',
'2007-01-11T20:30:00.000000000', '2007-01-11T20:45:00.000000000',
'2007-01-11T21:00:00.000000000', '2007-01-11T21:15:00.000000000',
'2007-01-11T21:30:00.000000000', '2007-01-11T21:45:00.000000000',
'2007-01-11T22:00:00.000000000', '2007-01-11T22:15:00.000000000',
'2007-01-11T22:30:00.000000000', '2007-01-11T22:45:00.000000000',
'2007-01-11T23:00:00.000000000', '2007-01-11T23:15:00.000000000',
'2007-01-11T23:30:00.000000000', '2007-01-11T23:45:00.000000000',
'2007-01-12T00:00:00.000000000'], dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">1.751</div><input id=attrs-d54bd4ac-bc23-4ed1-a450-cc7f08b9e69c class=xr-var-attrs-in type=checkbox disabled><label for=attrs-d54bd4ac-bc23-4ed1-a450-cc7f08b9e69c title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-c6cdb637-eebd-4120-9252-cb0d9c153006 class=xr-var-data-in type=checkbox><label for=data-c6cdb637-eebd-4120-9252-cb0d9c153006 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([1.75083])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">52.47</div><input id=attrs-0098f799-c5ba-4d2f-ba8a-ea90c2d23e30 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-0098f799-c5ba-4d2f-ba8a-ea90c2d23e30 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-f69f4971-aba1-4652-90aa-9350d4af9717 class=xr-var-data-in type=checkbox><label for=data-f69f4971-aba1-4652-90aa-9350d4af9717 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([52.473])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>id_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>&lt;U9</div><div class="xr-var-preview xr-preview">'Lowestoft'</div><input id=attrs-1aed8b1e-fd84-408d-9d43-41c1cb8d3b6e class=xr-var-attrs-in type=checkbox disabled><label for=attrs-1aed8b1e-fd84-408d-9d43-41c1cb8d3b6e title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-5e94b051-4cfa-4ebe-8282-4f5c90b61b7e class=xr-var-data-in type=checkbox><label for=data-5e94b051-4cfa-4ebe-8282-4f5c90b61b7e title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Lowestoft'], dtype='&lt;U9')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-ccd53266-52ec-46a7-a932-7cd41ef29693 class=xr-section-summary-in type=checkbox checked><label for=section-ccd53266-52ec-46a7-a932-7cd41ef29693 class=xr-section-summary>Data variables: <span>(2)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>ssh</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">2.818 2.823 2.871 &mldr; 3.257 3.371</div><input id=attrs-e776eeba-b655-4c57-b4be-5191b8d8f3ba class=xr-var-attrs-in type=checkbox disabled><label for=attrs-e776eeba-b655-4c57-b4be-5191b8d8f3ba title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-d5c9395b-9361-4a3a-ae11-a4509ca660f2 class=xr-var-data-in type=checkbox><label for=data-d5c9395b-9361-4a3a-ae11-a4509ca660f2 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[ 2.818,  2.823,  2.871,  2.931,  2.961,  2.979,  2.953,  2.913,
2.864,  2.806,  2.723,  2.664,  2.606,  2.511,  2.43 ,  2.379,
2.296,  2.201,  2.105,  2.006,  1.908,  1.801,  1.684,  1.579,
1.494,  1.402,  1.306,  1.233,  1.171,  1.102,  1.054,  1.028,
0.989,  0.97 ,  0.983,  1.004,  1.026,  1.068,  1.153,  1.225,
1.296,  1.362,  1.436,  1.481,  1.536,  1.615,  1.695,  1.726,
1.802,  1.842,  1.86 ,  1.872,  1.897,  1.912,  1.946,  1.994,
2.006,  2.028,  2.067,  2.081,  2.098,  2.137,  2.113,  2.068,
2.053,  1.985,  1.917,  1.869,  1.803,  1.695,  1.642,  1.545,
1.463,  1.463,  1.466,  1.462,  1.476,  1.524,  1.574,  1.633,
1.661,  1.717,  1.818,  1.918,  2.018,  2.093,  2.14 ,  2.223,
2.278,  2.303,  2.372,  2.375,  2.395,  2.468,  2.481,  2.487,
2.535,  2.543,  2.578,  2.621,  2.627,  2.626,  2.585,  2.563,
2.529,  2.451,  2.335,  2.207,  2.086,  1.982,  1.855,  1.741,
1.618,  1.531,  1.429,  1.342,  1.246,  1.141,  1.031,  0.902,
0.784,  0.673,  0.571,  0.457,  0.323,  0.203,  0.13 ,  0.056,
-0.028, -0.077, -0.093, -0.143, -0.181, -0.211, -0.217, -0.182,
-0.1  , -0.046,  0.02 ,  0.121,  0.247,  0.358,  0.468,  0.65 ,
0.845,  0.987,  1.059,  1.199,  1.322,  1.38 ,  1.465,  1.519,
1.559,  1.691,  1.775,  1.844,  2.019,  2.113,  2.159,  2.266,
2.311,  2.406,  2.512,  2.533,  2.43 ,  2.309,  2.185,  2.136,
2.086,  2.066,  2.114,  2.114,  2.051,  2.033,  2.055,  2.1  ,
2.192,  2.278,  2.334,  2.421,  2.497,  2.548,  2.603,  2.679,
2.803,  2.859,  2.875,  3.001,  3.075,  3.135,  3.214,  3.257,
3.371]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>qc_flags</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>int64</div><div class="xr-var-preview xr-preview">1 1 1 1 1 1 1 1 &mldr; 1 1 1 1 1 1 1 1</div><input id=attrs-a85108f6-467f-4c00-b7ea-2ab4f1359ba6 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-a85108f6-467f-4c00-b7ea-2ab4f1359ba6 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-41a40df4-c5d6-48b0-ae72-2ec40a0a74c1 class=xr-var-data-in type=checkbox><label for=data-41a40df4-c5d6-48b0-ae72-2ec40a0a74c1 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-84954f72-9280-4679-970e-16c80b84946f class=xr-section-summary-in type=checkbox disabled><label for=section-84954f72-9280-4679-970e-16c80b84946f class=xr-section-summary title="Expand/collapse section">Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></p><p>An example data variable could be ssh, or ntr (non-tidal residual). This object can also be used for other instrument types, not just tide gauges. For example moorings.</p><p>Every id index for this object should use the same time coordinates. Therefore, timeseries need to be aligned before being placed into the object. If there is any padding needed, then NaNs should be used. NaNs should also be used for quality control/data rejection.</p><p>For the rest of our examples, we will use data from multiple tide gauges
on the same time dimension. It will be read in from a simple netCDF file:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>tt</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>xr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>open_dataset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_tg</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Tidegauge</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>tt</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Create the object and then inset the netcdf dataset</span>
<span style=color:#000>tt</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>xr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>open_dataset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_tg</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Tidegauge</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>tt</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>set_coords</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;time&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><h2 id=quick-plotting-to-visualise-tidegauge-data>Quick plotting to visualise Tidegauge data</h2><p>Tidegauge has ready made quick plotting routines for viewing time series and tide gauge location. To look at the tide gauge location:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>fig</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_on_map</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><pre><code>/usr/share/miniconda/envs/coast/lib/python3.8/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip
  warnings.warn(f'Downloading: {url}', DownloadWarning)
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_16_1.png alt=png></p><p>There is also a slightly expanded version where you can plot multiple tidegauge objects, included as a list, and also the colour (if it is a dataarray with one value per location).</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># plot a list tidegauge datasets (here repeating obs for the point of demonstration) and colour</span>
<span style=color:#000>fig</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_on_map_multiple</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>obs</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>obs</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>color_var_str</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;latitude&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_18_0.png alt=png></p><p>Time series can be plotted using <code>matplotlib.pyplot</code> methods. However <code>xarray</code> has its own plotting wrappers that can be used, which offers some conveniences with labelling</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>stn_id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>  <span style=color:#8f5902;font-style:italic># pick a gauge station</span>

<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>()</span>  <span style=color:#8f5902;font-style:italic># rename time dimension to enable automatic x-axis labelling</span>

<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>rename</span><span style=color:#000;font-weight:700>({</span><span style=color:#4e9a06>&#39;t_dim&#39;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#39;time&#39;</span><span style=color:#000;font-weight:700>})</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>()</span>  <span style=color:#8f5902;font-style:italic># rename time dimension to enable automatic x-axis labelling</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>tight_layout</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_20_0.png alt=png></p><p>Or you can use the <code>Tidegauge.plot_timeseries()</code> method, in which start and end dates can also be specified.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_timeseries</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>date_start</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime64</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;2007-01-01&#39;</span><span style=color:#000;font-weight:700>),</span>
                                        <span style=color:#000>date_end</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime64</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;2007-01-31&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>(&lt;Figure size 1000x1000 with 1 Axes&gt;,
 &lt;matplotlib.collections.PathCollection at 0x7f7f56e9cd00&gt;)
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_22_1.png alt=png></p><h2 id=basic-manipulation-subsetting--plotting>Basic manipulation: subsetting + plotting</h2><p>We can do some simple spatial and temporal manipulations of this data:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Cut out a time window</span>
<span style=color:#000>obs_cut</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_slice</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>date0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>date1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>31</span><span style=color:#000;font-weight:700>))</span>

<span style=color:#8f5902;font-style:italic># Cut out geographical boxes</span>
<span style=color:#000>obs_upper</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs_cut</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subset_indices_lonlat_box</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>lonbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>],</span>
                                            <span style=color:#000>latbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>55</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>obs_lower</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs_cut</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subset_indices_lonlat_box</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>lonbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>9</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>],</span>
                                            <span style=color:#000>latbounds</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>55.5</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>59</span><span style=color:#000;font-weight:700>])</span>

<span style=color:#8f5902;font-style:italic>#fig, ax = obs_cut.plot_on_map()</span>
<span style=color:#000>fig</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs_upper</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot_on_map_multiple</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>obs_upper</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>obs_lower</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>color_var_str</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;latitude&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_24_1.png alt=png></p><h3 id=gridded-model-comparison>Gridded model comparison</h3><p>To compare our observations to the model, we will interpolate a model variable to the same time and geographical space as the tidegauge. This is done using the <code>obs_operator()</code> method.</p><p>But first load some gridded data and manipulate some variable names for convenience</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>nemo</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Gridded</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn_dat</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fn_dom</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>multiple</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>fn_config</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#8f5902;font-style:italic># Rename depth_0 to be depth</span>
<span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>rename</span><span style=color:#000;font-weight:700>({</span><span style=color:#4e9a06>&#34;depth_0&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;depth&#34;</span><span style=color:#000;font-weight:700>})</span>
<span style=color:#8f5902;font-style:italic>#nemo.dataset = nemo.dataset[[&#34;ssh&#34;, &#34;landmask&#34;]]</span>
</code></pre></div><p>interpolate model onto obs locations</p><pre><code>tidegauge_from_model = obs.obs_operator(nemo, time_interp='nearest')
</code></pre><p>Doing this would create a new interpolated tidegauge called <code>tidegauge_from_model</code>
Take a look at <code>tidegauge_from_model.dataset</code> to see for yourself. If a <code>landmask</code>
variable is present in the <code>Gridded</code> dataset then the nearest wet points will
be taken. Otherwise, just the nearest point is taken. If <code>landmask</code> is required
but not present you will need to insert it into the dataset yourself. For nemo
data, you could use the <code>bottom_level</code> or <code>mbathy</code> variables to do this. E.g:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Create a landmask array and put it into the nemo object.</span>
<span style=color:#8f5902;font-style:italic># Here, using the bottom_level == 0 variable from the domain file is enough.</span>
<span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;landmask&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>nemo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>bottom_level</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span>

<span style=color:#8f5902;font-style:italic># Then do the interpolation</span>
<span style=color:#000>tidegauge_from_model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>obs_operator</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nemo</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>time_interp</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;nearest&#39;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Calculating spatial indices.
Calculating time indices.
 Indexing model data at tide gauge locations.. 
Calculating interpolation distances.
Interpolating in time...
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><p>However, the new <code>tidegauge_from_model</code> will the same number of time entries as the <code>obs</code> data (rather than the model data). So, for a more useful demonstration we trim the observed gauge data so it better matches the model data.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Cut down data to be only in 2007 to match model data.</span>
<span style=color:#000>start_date</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>end_date</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2007</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>31</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_slice</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>start_date</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>end_date</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><h3 id=interpolate-model-data-onto-obs-locations>Interpolate model data onto obs locations</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>model_timeseries</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>obs_operator</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nemo</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># Take a look</span>
<span style=color:#000>model_timeseries</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</code></pre></div><pre><code>Calculating spatial indices.
Calculating time indices.
 Indexing model data at tide gauge locations.. 
Calculating interpolation distances.
Interpolating in time...
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,rgba(0,0,0,1));&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,0.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,0.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1f1f1f;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111;&ndash;xr-background-color-row-even:#111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(';
}</p> <p>.xr-dim-list:after { content: &lsquo;)';
}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,';
padding-right: 5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:        (z_dim: 51, axis_nbounds: 2, t_dim: 720, id_dim: 61,
interp_dist: 61)
Coordinates:
longitude      (id_dim) float32 1.444 -4.0 -5.333 &hellip; 7.666 -9.111 8.777
latitude       (id_dim) float32 51.93 51.53 58.0 51.67 &hellip; 58.0 51.53 53.87
depth          (z_dim, id_dim) float32 0.1001 0.2183 0.2529 &hellip; 27.32 10.11
time           (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00</p>
<ul>
<li>
<p>interp_dist    (interp_dist) float64 10.56 4.33 15.65 &hellip; 5.835 4.96 3.957
Dimensions without coordinates: z_dim, axis_nbounds, t_dim, id_dim
Data variables:
deptht_bounds  (z_dim, axis_nbounds) float32 0.0 6.157 &hellip; 5.924e+03
ssh            (t_dim, id_dim) float32 nan nan nan &hellip; 0.3721 -0.0752 0.7412
temperature    (t_dim, z_dim, id_dim) float32 nan nan nan &hellip; nan nan nan
bathymetry     (id_dim) float32 10.0 21.81 6.075 15.56 &hellip; 17.8 14.06 10.0
e1             (id_dim) float32 7.618e+03 7.686e+03 &hellip; 7.686e+03 7.285e+03
e2             (id_dim) float32 7.414e+03 7.414e+03 &hellip; 7.414e+03 7.414e+03
e3_0           (z_dim, id_dim) float32 0.2002 0.4365 0.5059 &hellip; 0.541 0.2002
bottom_level   (id_dim) float32 50.0 50.0 12.0 32.0 &hellip; 44.0 17.0 26.0 50.0
landmask       (id_dim) bool False False False False &hellip; False False False
Attributes:
name:         AMM7_1d_20070101_20070131_25hourm_grid_T
description:  ocean T grid variables, 25h meaned
title:        ocean T grid variables, 25h meaned
Conventions:  CF-1.6
timeStamp:    2019-Dec-26 04:35:28 GMT
uuid:         96cae459-d3a1-4f4f-b82b-9259179f95f7
history:      Tue May 19 12:07:51 2020: ncks -v votemper,sossheig -d time&hellip;
NCO:          4.4.7</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-adbcc442-771d-4114-b76e-1e80ea36a848 class=xr-section-summary-in type=checkbox disabled><label for=section-adbcc442-771d-4114-b76e-1e80ea36a848 class=xr-section-summary title="Expand/collapse section">Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>z_dim</span>: 51</li><li><span>axis_nbounds</span>: 2</li><li><span>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li><li><span class=xr-has-index>interp_dist</span>: 61</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-8fc74827-3941-4c1c-9eda-11b9eabfd0e3 class=xr-section-summary-in type=checkbox checked><label for=section-8fc74827-3941-4c1c-9eda-11b9eabfd0e3 class=xr-section-summary>Coordinates: <span>(5)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">1.444 -4.0 -5.333 &mldr; -9.111 8.777</div><input id=attrs-3afa8a4b-16b2-4e2c-90b0-8e3829078bbc class=xr-var-attrs-in type=checkbox disabled><label for=attrs-3afa8a4b-16b2-4e2c-90b0-8e3829078bbc title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-528536c2-2a47-4281-a874-f12b15c7df90 class=xr-var-data-in type=checkbox><label for=data-528536c2-2a47-4281-a874-f12b15c7df90 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.4443359 , -4.        , -5.333008  , -5.111328  , -3.        ,
-3.1113281 , -5.2226562 , -3.        , -1.4443359 ,  1.4443359 ,
-4.666992  ,  1.3330078 , -6.2226562 , -2.555664  , -3.7783203 ,
-4.333008  ,  1.1113281 , -0.55566406, -5.555664  , -5.111328  ,
-1.4443359 , -2.        , -1.1113281 , -2.8886719 , -1.8886719 ,
-6.333008  , -3.1113281 , -6.2226562 , -0.        ,  0.11132812,
-4.        ,  1.3330078 , -2.7783203 , -2.1113281 , -1.4443359 ,
-3.555664  , -1.4443359 , -2.7783203 , -3.2226562 ,  1.7773438 ,
-5.        , -5.555664  , -3.1113281 , -1.1113281 , -6.333008  ,
-5.        , -4.7783203 , -6.666992  , -2.7783203 , -1.4443359 ,
-4.111328  , -4.111328  , -1.4443359 , 11.22168   , 11.777344  ,
4.888672  , 11.22168   , -7.333008  ,  7.6660156 , -9.111328  ,
8.777344  ], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">51.93 51.53 58.0 &mldr; 51.53 53.87</div><input id=attrs-ed94f379-5e3c-4abe-84b3-0eab07c4d921 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-ed94f379-5e3c-4abe-84b3-0eab07c4d921 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-67462e50-042b-4e44-9527-2605d1335348 class=xr-var-data-in type=checkbox><label for=data-67462e50-042b-4e44-9527-2605d1335348 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.933594, 51.53418 , 58.000977, 51.666992, 54.000977, 51.26758 ,
58.467773, 58.467773, 55.067383, 51.933594, 53.333984, 52.933594,
56.66797 , 50.600586, 53.333984, 50.333984, 51.53418 , 54.467773,
50.067383, 54.80078 , 55.067383, 57.13379 , 60.20117 , 51.53418 ,
50.666992, 49.933594, 53.467773, 55.600586, 53.600586, 50.7334  ,
57.600586, 51.067383, 51.53418 , 49.13379 , 55.067383, 54.666992,
55.067383, 51.53418 , 56.000977, 52.467773, 52.067383, 54.666992,
51.26758 , 50.7334  , 58.13379 , 55.734375, 54.067383, 55.26758 ,
51.53418 , 55.067383, 52.734375, 51.26758 , 55.067383, 58.333984,
57.66797 , 61.93457 , 64.868164, 55.40039 , 58.000977, 51.53418 ,
53.867188], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>depth</span></div><div class=xr-var-dims>(z_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">0.1001 0.2183 &mldr; 27.32 10.11</div><input id=attrs-398d79b6-c7ae-493c-bc2f-17dc43204ff9 class=xr-var-attrs-in type=checkbox><label for=attrs-398d79b6-c7ae-493c-bc2f-17dc43204ff9 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-256af0ff-a869-4850-b1c4-a542a8ea745b class=xr-var-data-in type=checkbox><label for=data-256af0ff-a869-4850-b1c4-a542a8ea745b title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>m</dd><dt><span>standard_name :</span></dt><dd>Depth at time zero on the t-grid</dd></dl></div><div class=xr-var-data><pre>array([[1.00097656e-01, 2.18261719e-01, 2.52929688e-01, &hellip;,
5.02441406e-01, 2.70507812e-01, 1.00097656e-01],
[3.00292969e-01, 6.54785156e-01, 7.58789062e-01, &hellip;,
1.49365234e+00, 8.11523438e-01, 3.00292969e-01],
[5.00488281e-01, 1.09130859e+00, 1.26464844e+00, &hellip;,
2.46826172e+00, 1.35253906e+00, 5.00488281e-01],
&hellip;,
[9.70947266e+00, 2.11713867e+01, 2.45341797e+01, &hellip;,
1.70940918e+02, 2.62392578e+01, 9.70947266e+00],
[9.90966797e+00, 2.16079102e+01, 2.50400391e+01, &hellip;,
1.75505371e+02, 2.67802734e+01, 9.90966797e+00],
[1.01098633e+01, 2.20444336e+01, 2.55458984e+01, &hellip;,
1.79002441e+02, 2.73212891e+01, 1.01098633e+01]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class="xr-var-preview xr-preview">2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-e7c38591-551c-4df8-8a41-e4dc8d098b04 class=xr-var-attrs-in type=checkbox><label for=attrs-e7c38591-551c-4df8-8a41-e4dc8d098b04 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-6c8c2321-34b5-421d-9834-6aa0b86d0f46 class=xr-var-data-in type=checkbox><label for=data-6c8c2321-34b5-421d-9834-6aa0b86d0f46 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>axis :</span></dt><dd>T</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time axis</dd><dt><span>time_origin :</span></dt><dd>1900-01-01 00:00:00</dd><dt><span>bounds :</span></dt><dd>time_counter_bounds</dd></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', &hellip;, '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span class=xr-has-index>interp_dist</span></div><div class=xr-var-dims>(interp_dist)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">10.56 4.33 15.65 &mldr; 4.96 3.957</div><input id=attrs-d34d5c6c-89d6-49b9-af86-266198dc55eb class=xr-var-attrs-in type=checkbox disabled><label for=attrs-d34d5c6c-89d6-49b9-af86-266198dc55eb title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-9fcd23ef-bdda-45d4-9551-f11ea6220fbc class=xr-var-data-in type=checkbox><label for=data-9fcd23ef-bdda-45d4-9551-f11ea6220fbc title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([10.557536,  4.32986 , 15.652248,  6.018475,  6.219445,  6.03486 ,
10.097628,  5.838893,  6.671627,  7.062506,  3.811328,  2.10403 ,
10.895208,  7.653076,  3.124836, 11.159928, 27.307532,  4.520905,
4.064858,  4.679088,  6.671627,  4.967727,  5.4814  ,  7.053344,
5.352902,  2.058653,  6.497781,  3.618604, 12.729041,  6.597736,
0.247078,  5.276769,  5.090907,  5.522412,  6.671627,  1.957449,
6.671627,  5.130461,  2.833094,  1.887713,  6.068393,  7.322999,
6.03486 ,  7.690458,  8.786909,  6.134009,  2.111385,  6.791151,
5.130461,  6.671627,  4.76955 ,  6.294531,  6.671627,  1.823125,
2.146439, 11.946562,  1.343733,  3.712935,  5.835372,  4.960209,
3.956633])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-4649ce9a-5022-4189-8227-39a084172c03 class=xr-section-summary-in type=checkbox checked><label for=section-4649ce9a-5022-4189-8227-39a084172c03 class=xr-section-summary>Data variables: <span>(9)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>deptht_bounds</span></div><div class=xr-var-dims>(z_dim, axis_nbounds)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">0.0 6.157 &mldr; 5.72e+03 5.924e+03</div><input id=attrs-a671a142-a768-4491-8167-9010562442be class=xr-var-attrs-in type=checkbox disabled><label for=attrs-a671a142-a768-4491-8167-9010562442be title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-48511575-a91a-43f7-b768-a6ed9ecd4066 class=xr-var-data-in type=checkbox><label for=data-48511575-a91a-43f7-b768-a6ed9ecd4066 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[   0.       ,    6.1572266],
[   6.1572266,   12.678711 ],
[  12.678711 ,   19.65332  ],
[  19.65332  ,   27.19043  ],
[  27.19043  ,   35.426758 ],
[  35.426758 ,   44.527344 ],
[  44.527344 ,   54.69922  ],
[  54.69922  ,   66.19141  ],
[  66.19141  ,   79.305664 ],
[  79.305664 ,   94.41016  ],
[  94.41016  ,  111.94238  ],
[ 111.94238  ,  132.41895  ],
[ 132.41895  ,  156.44531  ],
[ 156.44531  ,  184.71582  ],
[ 184.71582  ,  218.01562  ],
[ 218.01562  ,  257.20605  ],
[ 257.20605  ,  303.20508  ],
[ 303.20508  ,  356.95898  ],
[ 356.95898  ,  419.39258  ],
[ 419.39258  ,  491.35645  ],
&hellip;
[1955.7686   , 2136.3613   ],
[2136.3613   , 2321.292    ],
[2321.292    , 2509.8564   ],
[2509.8564   , 2701.4355   ],
[2701.4355   , 2895.504    ],
[2895.504    , 3091.6123   ],
[3091.6123   , 3289.3867   ],
[3289.3867   , 3488.5156   ],
[3488.5156   , 3688.7441   ],
[3688.7441   , 3889.8613   ],
[3889.8613   , 4091.6963   ],
[4091.6963   , 4294.1094   ],
[4294.1094   , 4496.9893   ],
[4496.9893   , 4700.242    ],
[4700.242    , 4903.797    ],
[4903.797    , 5107.5938   ],
[5107.5938   , 5311.584    ],
[5311.584    , 5515.7295   ],
[5515.7295   , 5720.       ],
[5720.       , 5924.2705   ]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>ssh</span></div><div class=xr-var-dims>(t_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">nan nan nan &mldr; -0.0752 0.7412</div><input id=attrs-aa6eb0ee-b010-46fc-b44f-4ebe0794bf75 class=xr-var-attrs-in type=checkbox><label for=attrs-aa6eb0ee-b010-46fc-b44f-4ebe0794bf75 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-75ac61b0-e7ea-4894-973c-4a0dcb80b214 class=xr-var-data-in type=checkbox><label for=data-75ac61b0-e7ea-4894-973c-4a0dcb80b214 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>m</dd><dt><span>online_operation :</span></dt><dd>instant</dd><dt><span>interval_operation :</span></dt><dd>300 s</dd><dt><span>interval_write :</span></dt><dd>1 d</dd><dt><span>cell_methods :</span></dt><dd>time: point (interval: 300 s)</dd></dl></div><div class=xr-var-data><pre>array([[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
&hellip;,
[ 0.24902344, -0.046875  ,  0.20019531, &hellip;,  0.3720703 ,
-0.07519531,  0.74121094],
[ 0.24902344, -0.046875  ,  0.20019531, &hellip;,  0.3720703 ,
-0.07519531,  0.74121094],
[ 0.24902344, -0.046875  ,  0.20019531, &hellip;,  0.3720703 ,
-0.07519531,  0.74121094]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>temperature</span></div><div class=xr-var-dims>(t_dim, z_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">nan nan nan nan &mldr; nan nan nan nan</div><input id=attrs-44a9bf1b-dfd7-4d99-bd6a-06a14caa3427 class=xr-var-attrs-in type=checkbox><label for=attrs-44a9bf1b-dfd7-4d99-bd6a-06a14caa3427 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-faeafbdc-8889-4c8a-969a-55e3e39cdf6f class=xr-var-data-in type=checkbox><label for=data-faeafbdc-8889-4c8a-969a-55e3e39cdf6f title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>degC</dd><dt><span>online_operation :</span></dt><dd>instant</dd><dt><span>interval_operation :</span></dt><dd>300 s</dd><dt><span>interval_write :</span></dt><dd>1 d</dd><dt><span>cell_methods :</span></dt><dd>time: point (interval: 300 s)</dd></dl></div><div class=xr-var-data><pre>array([[[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
&hellip;,
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan]],</p>
<p>[[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan],
&hellip;
[7.4384766, 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[7.439453 , 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan]],</p>
<p>[[7.4335938, 8.217773 , 7.245117 , &hellip;, 5.8652344, 8.924805 ,
5.0322266],
[7.4345703, 8.219727 , 7.245117 , &hellip;, 5.8671875, 8.926758 ,
5.0322266],
[7.4345703, 8.219727 , 7.2421875, &hellip;, 5.8691406, 8.926758 ,
5.0322266],
&hellip;,
[7.4384766, 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[7.439453 , 8.22168  ,       nan, &hellip;,       nan,       nan,
5.0009766],
[      nan,       nan,       nan, &hellip;,       nan,       nan,
nan]]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>bathymetry</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">10.0 21.81 6.075 &mldr; 14.06 10.0</div><input id=attrs-1ef1c015-b9a4-441b-90e8-9c716cbc2beb class=xr-var-attrs-in type=checkbox><label for=attrs-1ef1c015-b9a4-441b-90e8-9c716cbc2beb title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-163abc53-6777-4477-92a2-03010ca84861 class=xr-var-data-in type=checkbox><label for=data-163abc53-6777-4477-92a2-03010ca84861 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>units :</span></dt><dd>m</dd><dt><span>standard_name :</span></dt><dd>bathymetry</dd><dt><span>description :</span></dt><dd>depth of last wet w-level on the horizontal t-grid</dd></dl></div><div class=xr-var-data><pre>array([10.       , 21.80957  ,  6.0751953, 15.558594 , 10.65625  ,
12.145508 , 53.125    , 47.216797 , 10.3125   , 10.       ,
21.898438 , 10.095703 , 11.674805 , 15.611328 , 11.230469 ,
20.368164 , 10.25293  , 14.34082  , 23.28418  , 37.7666   ,
10.3125   , 34.78711  , 15.394531 , 10.       , 12.630859 ,
21.493164 , 10.       , 18.167969 , 10.       , 17.354492 ,
10.       , 24.625    , 10.       ,  9.915039 , 10.3125   ,
10.       , 10.3125   , 10.       , 10.       , 10.0703125,
37.003906 , 10.40918  , 12.145508 , 10.       , 30.885742 ,
35.280273 , 17.089844 , 33.78711  , 10.       , 10.3125   ,
10.       , 37.25879  , 10.3125   , 12.712891 ,  8.652344 ,
14.458984 , 83.96973  , 19.424805 , 17.804688 , 14.060547 ,
10.       ], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>e1</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">7.618e+03 7.686e+03 &mldr; 7.285e+03</div><input id=attrs-058e6d2f-0b04-48a0-98ac-c09d4e37b6a1 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-058e6d2f-0b04-48a0-98ac-c09d4e37b6a1 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-dd928a5f-5531-490f-9e3d-2b14d60bca14 class=xr-var-data-in type=checkbox><label for=data-dd928a5f-5531-490f-9e3d-2b14d60bca14 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([7617.912 , 7685.6387, 6547.1533, 7663.1045, 7262.1484, 7730.582 ,
6461.591 , 6461.591 , 7074.802 , 7617.912 , 7377.966 , 7446.9775,
6789.205 , 7842.205 , 7377.966 , 7886.5586, 7685.6387, 7180.49  ,
7930.74  , 7121.871 , 7074.802 , 6704.8984, 6140.08  , 7685.6387,
7831.091 , 7952.7676, 7354.881 , 6980.205 , 7331.758 , 7819.965 ,
6620.1465, 7764.1797, 7685.6387, 8084.0186, 7074.802 , 7145.3477,
7074.802 , 7685.6387, 6908.8594, 7527.032 , 7595.254 , 7145.3477,
7730.582 , 7819.965 , 6522.751 , 6956.461 , 7250.5117, 7039.3994,
7685.6387, 7074.802 , 7481.3477, 7730.582 , 7074.802 , 6486.082 ,
6608.004 , 5812.949 , 5247.382 , 7015.75  , 6547.1533, 7685.6387,
7285.3906], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>e2</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">7.414e+03 7.414e+03 &mldr; 7.414e+03</div><input id=attrs-1bef09b0-30ab-4b29-b5e5-fc2e9eee34be class=xr-var-attrs-in type=checkbox disabled><label for=attrs-1bef09b0-30ab-4b29-b5e5-fc2e9eee34be title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-31228d46-83c5-4bde-b6fe-2b758ab3f47f class=xr-var-data-in type=checkbox><label for=data-31228d46-83c5-4bde-b6fe-2b758ab3f47f title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633, 7413.633, 7413.633, 7413.633, 7413.633, 7413.633,
7413.633], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>e3_0</span></div><div class=xr-var-dims>(z_dim, id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">0.2002 0.4365 &mldr; 0.541 0.2002</div><input id=attrs-746d118f-4e8f-47be-824b-982053d3624a class=xr-var-attrs-in type=checkbox disabled><label for=attrs-746d118f-4e8f-47be-824b-982053d3624a title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-06009bc6-0338-461d-b438-ecca02c52b27 class=xr-var-data-in type=checkbox><label for=data-06009bc6-0338-461d-b438-ecca02c52b27 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[0.20019531, 0.43652344, 0.5058594 , &hellip;, 1.        , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 0.9824219 , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 0.96777344, 0.5410156 ,
0.20019531],
&hellip;,
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 5.0214844 , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 4.057617  , 0.5410156 ,
0.20019531],
[0.20019531, 0.43652344, 0.5058594 , &hellip;, 3.203125  , 0.5410156 ,
0.20019531]], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>bottom_level</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">50.0 50.0 12.0 &mldr; 17.0 26.0 50.0</div><input id=attrs-32212a92-138a-4b79-aebf-10dd45f58c97 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-32212a92-138a-4b79-aebf-10dd45f58c97 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-5dfe20c7-835a-4c48-90bd-fb7265178570 class=xr-var-data-in type=checkbox><label for=data-5dfe20c7-835a-4c48-90bd-fb7265178570 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([50., 50., 12., 32., 50., 50., 50., 50., 21., 50., 29., 42., 32.,
42., 40., 33., 50., 25., 37., 32., 21., 50., 20., 50., 44., 24.,
50., 24., 50., 43., 50., 50., 50., 34., 21., 50., 21., 50., 50.,
33., 50., 11., 50., 50., 33., 45., 29., 39., 50., 21., 50., 50.,
21., 19., 25., 25., 50., 44., 17., 26., 50.], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>landmask</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>bool</div><div class="xr-var-preview xr-preview">False False False &mldr; False False</div><input id=attrs-040f97f5-12d0-45e6-98f3-d91d001dd7b6 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-040f97f5-12d0-45e6-98f3-d91d001dd7b6 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-117e59c6-c1a9-44c4-9c90-1354f5dd9ea6 class=xr-var-data-in type=checkbox><label for=data-117e59c6-c1a9-44c4-9c90-1354f5dd9ea6 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False, False, False,
False, False, False, False, False, False, False])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-1e4888b4-8c67-4351-b170-f574373188ee class=xr-section-summary-in type=checkbox checked><label for=section-1e4888b4-8c67-4351-b170-f574373188ee class=xr-section-summary>Attributes: <span>(8)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs><dt><span>name :</span></dt><dd>AMM7_1d_20070101_20070131_25hourm_grid_T</dd><dt><span>description :</span></dt><dd>ocean T grid variables, 25h meaned</dd><dt><span>title :</span></dt><dd>ocean T grid variables, 25h meaned</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>timeStamp :</span></dt><dd>2019-Dec-26 04:35:28 GMT</dd><dt><span>uuid :</span></dt><dd>96cae459-d3a1-4f4f-b82b-9259179f95f7</dd><dt><span>history :</span></dt><dd>Tue May 19 12:07:51 2020: ncks -v votemper,sossheig -d time_counter,0,30,5 AMM7_1d_20070101_20070131_25hourm_grid_T.nc example_data.nc</dd><dt><span>NCO :</span></dt><dd>4.4.7</dd></dl></div></li></ul></div></div></p></li></ul><p>We can see that the structure for the new dataset <code>model_timeseries</code>, generated from the gridded model simulation, is that of a <code>tidegauge</code> object. NB in the example simulation data the ssh variable is output as 5-day means. So it is not particulatly useful for high frequency validation but serves as a demonstration of the workflow.</p><h2 id=tidegauge-analysis-methods>Tidegauge analysis methods</h2><p>For a good comparison, we would like to make sure that both the observed and
modelled <code>Tidegauge</code> objects contain the same missing values. <code>TidegaugeAnalysis</code>
contains a routine for ensuring this. First create our analysis object:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>tganalysis</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>coast</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>TidegaugeAnalysis</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># In this case, transpose the interpolated dataset</span>
<span style=color:#000>model_timeseries</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model_timeseries</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>transpose</span><span style=color:#000;font-weight:700>()</span>

<span style=color:#8f5902;font-style:italic># This routine searches for missing values in each dataset and applies them</span>
<span style=color:#8f5902;font-style:italic># equally to each corresponding dataset</span>
<span style=color:#000>obs_new</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_new</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>match_missing_values</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_timeseries</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><p>Although we input data arrays to the above routine, it returns two new Tidegauge objects. Now you have equivalent and comparable sets of time series that can be easily compared.</p><h3 id=harmonic-analysis--non-tidal-residuals>Harmonic Analysis & Non tidal-Residuals</h3><p>The <code>Tidegauge</code> object contains some routines which make harmonic analysis and
the calculation/comparison of non-tidal residuals easier. Harmonic analysis is
done using the <code>utide</code> package. Please see <a href=https://pypi.org/project/UTide/>here</a> for more info.</p><p>First we can use the <code>TidegaugeAnalysis</code> class to do a harmonic analysis. Suppose
we have two <code>Tidegauge</code> objects called <code>obs</code> and <code>model_timeseries</code> generated from tidegauge observations and model simulations respectively.</p><p>Then subtract means from all the time series</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Subtract means from all time series</span>
<span style=color:#000>obs_new</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>demean_timeseries</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model_new</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>demean_timeseries</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># Now you have equivalent and comparable sets of time series that can be</span>
<span style=color:#8f5902;font-style:italic># easily compared.</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>figure</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>),</span>
         <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;model - demeaned&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;orange&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>,</span>
         <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs - demeaned&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>f</span><span style=color:#4e9a06>&#39;model and observed timeseries : {obs_new.dataset.site_name.isel(id_dim=stn_id).coords}&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_43_0.png alt=png></p><p>Then we can apply the harmonic analysis (though the example data is too short for this example to be that meaningful and the model data is only saved as 5-day means! Nevertheless we proceed):</p><h3 id=calculate-non-tidal-residuals>Calculate non tidal residuals</h3><p>First, do a harmonic analysis. This routine uses utide</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>ha_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>harmonic_analysis_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>min_datapoints</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>ha_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>harmonic_analysis_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>min_datapoints</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
solve: matrix prep ... solution ... done.
</code></pre><p>The <code>harmonic_analysis_utide</code> routine returns a list of <code>utide</code> structure object,
one for each <code>id_dim</code> in the <code>Tidegauge</code> object. It can be passed any of the
arguments that go to <code>utide</code>. It also has an additional argument <code>min_datapoints</code>
which determines a minimum number of data points for the harmonics analysis.
If a tidegauge <code>id_dim</code> has less than this number, it will not return an analysis.</p><p>Now, create new <code>TidegaugeMultiple</code> objects containing reconstructed tides:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>tide_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstruct_tide_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ha_mod</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>tide_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstruct_tide_utide</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ha_obs</span><span style=color:#000;font-weight:700>)</span>

</code></pre></div><pre><code>prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
Tidegauge object at 0x55b017f74fc0 initialised
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
prep/calcs ... done.
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><p>Get new TidegaugeMultiple objects containing non tidal residuals:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>ntr_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>calculate_non_tidal_residuals</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>tide_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstructed</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>ntr_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>calculate_non_tidal_residuals</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>tide_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstructed</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># Take a look</span>
<span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,rgba(0,0,0,1));&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,0.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,0.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1f1f1f;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111;&ndash;xr-background-color-row-even:#111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(';
}</p> <p>.xr-dim-list:after { content: &lsquo;)';
}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,';
padding-right: 5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:    (id_dim: 61, t_dim: 720)
Coordinates:
longitude  (id_dim) float32 1.444 -4.0 -5.333 -5.111 &hellip; 7.666 -9.111 8.777
latitude   (id_dim) float32 51.93 51.53 58.0 51.67 &hellip; 55.4 58.0 51.53 53.87
time       (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00
Dimensions without coordinates: id_dim, t_dim
Data variables:
ntr        (id_dim, t_dim) float64 nan nan nan &hellip; -0.1131 -0.0932 -0.06751</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-da94b4eb-c5b8-48e5-b7cf-493691f43b2c class=xr-section-summary-in type=checkbox disabled><label for=section-da94b4eb-c5b8-48e5-b7cf-493691f43b2c class=xr-section-summary title="Expand/collapse section">Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>id_dim</span>: 61</li><li><span>t_dim</span>: 720</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-6abd4387-8af0-4fb0-b3a8-a0556b87d039 class=xr-section-summary-in type=checkbox checked><label for=section-6abd4387-8af0-4fb0-b3a8-a0556b87d039 class=xr-section-summary>Coordinates: <span>(3)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">1.444 -4.0 -5.333 &mldr; -9.111 8.777</div><input id=attrs-df15d070-bb6d-4a23-9fb6-6090e9d2acb5 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-df15d070-bb6d-4a23-9fb6-6090e9d2acb5 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-d6fd227c-221f-4375-9865-0e2d746bb7c3 class=xr-var-data-in type=checkbox><label for=data-d6fd227c-221f-4375-9865-0e2d746bb7c3 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.4443359 , -4.        , -5.333008  , -5.111328  , -3.        ,
-3.1113281 , -5.2226562 , -3.        , -1.4443359 ,  1.4443359 ,
-4.666992  ,  1.3330078 , -6.2226562 , -2.555664  , -3.7783203 ,
-4.333008  ,  1.1113281 , -0.55566406, -5.555664  , -5.111328  ,
-1.4443359 , -2.        , -1.1113281 , -2.8886719 , -1.8886719 ,
-6.333008  , -3.1113281 , -6.2226562 , -0.        ,  0.11132812,
-4.        ,  1.3330078 , -2.7783203 , -2.1113281 , -1.4443359 ,
-3.555664  , -1.4443359 , -2.7783203 , -3.2226562 ,  1.7773438 ,
-5.        , -5.555664  , -3.1113281 , -1.1113281 , -6.333008  ,
-5.        , -4.7783203 , -6.666992  , -2.7783203 , -1.4443359 ,
-4.111328  , -4.111328  , -1.4443359 , 11.22168   , 11.777344  ,
4.888672  , 11.22168   , -7.333008  ,  7.6660156 , -9.111328  ,
8.777344  ], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float32</div><div class="xr-var-preview xr-preview">51.93 51.53 58.0 &mldr; 51.53 53.87</div><input id=attrs-7b09d9e0-d903-4ecf-88b7-0a3cb5972fe3 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-7b09d9e0-d903-4ecf-88b7-0a3cb5972fe3 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-4a634c8b-7353-42cb-8305-beed15f335ed class=xr-var-data-in type=checkbox><label for=data-4a634c8b-7353-42cb-8305-beed15f335ed title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.933594, 51.53418 , 58.000977, 51.666992, 54.000977, 51.26758 ,
58.467773, 58.467773, 55.067383, 51.933594, 53.333984, 52.933594,
56.66797 , 50.600586, 53.333984, 50.333984, 51.53418 , 54.467773,
50.067383, 54.80078 , 55.067383, 57.13379 , 60.20117 , 51.53418 ,
50.666992, 49.933594, 53.467773, 55.600586, 53.600586, 50.7334  ,
57.600586, 51.067383, 51.53418 , 49.13379 , 55.067383, 54.666992,
55.067383, 51.53418 , 56.000977, 52.467773, 52.067383, 54.666992,
51.26758 , 50.7334  , 58.13379 , 55.734375, 54.067383, 55.26758 ,
51.53418 , 55.067383, 52.734375, 51.26758 , 55.067383, 58.333984,
57.66797 , 61.93457 , 64.868164, 55.40039 , 58.000977, 51.53418 ,
53.867188], dtype=float32)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class="xr-var-preview xr-preview">2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-8257f181-ce0e-4725-83d9-3d88670f8a37 class=xr-var-attrs-in type=checkbox><label for=attrs-8257f181-ce0e-4725-83d9-3d88670f8a37 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-8034e749-7c3b-4c2f-b873-4ef923eab38a class=xr-var-data-in type=checkbox><label for=data-8034e749-7c3b-4c2f-b873-4ef923eab38a title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs><dt><span>axis :</span></dt><dd>T</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time axis</dd><dt><span>time_origin :</span></dt><dd>1900-01-01 00:00:00</dd><dt><span>bounds :</span></dt><dd>time_counter_bounds</dd></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', &hellip;, '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-206dc412-c036-4d3d-a214-940abf68bbf2 class=xr-section-summary-in type=checkbox checked><label for=section-206dc412-c036-4d3d-a214-940abf68bbf2 class=xr-section-summary>Data variables: <span>(1)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">nan nan nan &mldr; -0.0932 -0.06751</div><input id=attrs-dde2e21d-2cdd-48f1-988b-c834f6dc08a6 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-dde2e21d-2cdd-48f1-988b-c834f6dc08a6 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-b151a7db-4657-4ca0-8e52-9cb509277dd9 class=xr-var-data-in type=checkbox><label for=data-b151a7db-4657-4ca0-8e52-9cb509277dd9 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[        nan,         nan,         nan, &hellip;, -0.01578879,
-0.01832536, -0.02103986],
[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
[        nan,         nan,         nan, &hellip;, -0.092145  ,
-0.09043849, -0.08913844],
&hellip;,
[        nan,         nan,         nan, &hellip;, -0.00689739,
-0.00588311, -0.00477213],
[        nan,         nan,         nan, &hellip;, -0.10071189,
-0.10431121, -0.10936602],
[        nan,         nan,         nan, &hellip;, -0.11313507,
-0.0931955 , -0.06751227]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-44b0c31d-046b-486e-9b07-8277184fdd8e class=xr-section-summary-in type=checkbox disabled><label for=section-44b0c31d-046b-486e-9b07-8277184fdd8e class=xr-section-summary title="Expand/collapse section">Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></p><p>The dataset structure is preserved and has created a new variable called <code>ntr</code> - non-tidal residual.</p><p>By default, this routines will apply <code>scipy.signal.savgol_filter</code> to the non-tidal residuals
to remove some noise. This can be switched off using <code>apply_filter = False</code>.</p><p>The Doodson X0 filter is an alternative way of estimating non-tidal residuals. This will return a new Tidegauge() object containing filtered ssh data:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>dx0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>doodson_x0_filter</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ssh&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># take a look</span>
<span style=color:#000>dx0</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>

</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,rgba(0,0,0,1));&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,0.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,0.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1f1f1f;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111;&ndash;xr-background-color-row-even:#111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(';
}</p> <p>.xr-dim-list:after { content: &lsquo;)';
}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,';
padding-right: 5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:    (t_dim: 720, id_dim: 61)
Coordinates:
latitude   (id_dim) float64 51.95 51.57 57.9 51.71 &hellip; 58.0 51.53 53.87
site_name  (id_dim) object 'Harwich' 'Mumbles' 'Ullapool' &hellip; 'N/A' 'N/A'
longitude  (id_dim) float64 1.292 -3.975 -5.158 -5.051 &hellip; 7.567 350.8 8.717
Dimensions without coordinates: t_dim, id_dim
Data variables:
time       (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00
ssh        (id_dim, t_dim) float64 nan nan nan nan nan &hellip; nan nan nan nan</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-18176486-467c-4eff-87a4-d00091b507ad class=xr-section-summary-in type=checkbox disabled><label for=section-18176486-467c-4eff-87a4-d00091b507ad class=xr-section-summary title="Expand/collapse section">Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-1c70eb82-de4d-42e8-972a-1b902a7cbc11 class=xr-section-summary-in type=checkbox checked><label for=section-1c70eb82-de4d-42e8-972a-1b902a7cbc11 class=xr-section-summary>Coordinates: <span>(3)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">51.95 51.57 57.9 &mldr; 51.53 53.87</div><input id=attrs-4a087926-fddd-4f13-801f-c66ef69c7776 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-4a087926-fddd-4f13-801f-c66ef69c7776 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-a418920b-5c59-42ae-92ae-301fd9bc3d60 class=xr-var-data-in type=checkbox><label for=data-a418920b-5c59-42ae-92ae-301fd9bc3d60 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.94798   , 51.57      , 57.89525   , 51.7064    , 54.03167   ,
51.21525   , 58.45661   , 58.44097   , 55.00744   , 51.95675   ,
53.31394   , 52.93436   , 56.62311   , 50.6085    , 53.33167   ,
50.36839   , 51.44564   , 54.49008   , 50.103     , 54.84256   ,
55.00744   , 57.14406   , 60.15403   , 51.55      , 50.71433   ,
49.91847   , 53.44969   , 55.62742   , 53.63103   , 50.78178   ,
57.5987    , 51.11439   , 51.51089   , 49.18333   , 55.00744   ,
54.65081   , 55.00744   , 51.50002   , 55.98983   , 52.473     ,
52.01378   , 54.66475   , 51.21525   , 50.80256   , 58.20711   ,
55.74964   , 54.08539   , 55.20678   , 51.50002   , 55.00744   ,
52.71906   , 51.21097   , 55.00744   , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58.        , 51.53300095,
53.86700058])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>object</div><div class="xr-var-preview xr-preview">'Harwich' 'Mumbles' &mldr; 'N/A' 'N/A'</div><input id=attrs-7b3b3d82-2ca6-4145-b3fd-bb192ff6c866 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-7b3b3d82-2ca6-4145-b3fd-bb192ff6c866 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-031e15d8-3ce9-4895-b210-3354be1acec2 class=xr-var-data-in type=checkbox><label for=data-031e15d8-3ce9-4895-b210-3354be1acec2 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &quot;St. Mary's&quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype=object)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">1.292 -3.975 -5.158 &mldr; 350.8 8.717</div><input id=attrs-9c54dc55-a1ec-4a4c-a7ef-13864cadf878 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-9c54dc55-a1ec-4a4c-a7ef-13864cadf878 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-3d0d6a1a-d4b8-4a08-a70f-f5a2375ed332 class=xr-var-data-in type=checkbox><label for=data-3d0d6a1a-d4b8-4a08-a70f-f5a2375ed332 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00,  1.34839000e+00, -4.62044000e+00,  1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01,  5.70300000e-02, -4.00220000e+00,  1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00,  1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00,  1.12150002e+01,  1.18000002e+01,  5.11700010e+00,
1.12500000e+01,  3.52666992e+02,  7.56699991e+00,  3.50816986e+02,
8.71700001e+00])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-a14e6992-c681-44cc-992e-0c3a06bcc43a class=xr-section-summary-in type=checkbox checked><label for=section-a14e6992-c681-44cc-992e-0c3a06bcc43a class=xr-section-summary>Data variables: <span>(2)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class="xr-var-preview xr-preview">2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-c2a4b2e9-333a-4d06-b1aa-58581cd1e038 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-c2a4b2e9-333a-4d06-b1aa-58581cd1e038 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-8ee1ac7a-f703-4a80-b6ad-fc92150ba4bc class=xr-var-data-in type=checkbox><label for=data-8ee1ac7a-f703-4a80-b6ad-fc92150ba4bc title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>ssh</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">nan nan nan nan &mldr; nan nan nan nan</div><input id=attrs-1661a4ca-644a-4cd1-bd3a-8b8e6a69360d class=xr-var-attrs-in type=checkbox disabled><label for=attrs-1661a4ca-644a-4cd1-bd3a-8b8e6a69360d title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-0554ef79-ef91-4dfb-9749-4d93d49e0329 class=xr-var-data-in type=checkbox><label for=data-0554ef79-ef91-4dfb-9749-4d93d49e0329 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan],
&hellip;,
[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan],
[nan, nan, nan, &hellip;, nan, nan, nan]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-44ecce65-5250-4c8a-a455-6cb1b1bb1b23 class=xr-section-summary-in type=checkbox disabled><label for=section-44ecce65-5250-4c8a-a455-6cb1b1bb1b23 class=xr-section-summary title="Expand/collapse section">Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></p><p>We can compare these analyses e.g. the observed timeseries against the harmonic reconstruction. Noting we can in principle extend the harmoninc reconstruction beyond the observation time window.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>figure</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>tide_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>tide_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reconstructed</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;reconstructed from harmonics&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;orange&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;observed&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_55_0.png alt=png></p><p>We can also look closer at the difference between the observed timeseries and the harmonic reconstruction, that is the non-tidal residual. And we can compare the observed and modelled non-harmonic residual and contrast the different methods of removing the tides. Here we contrast using a harmonic analysis (and creating a &ldquo;non-tidal residual&rdquo;) with the DoodsonX0 filter. Note that the timeseries is far too short for a sensible analysis and that this is really a demonstration of concept.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>figure</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>dx0</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>dx0</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ssh</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs: doodsonX0 filtered&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;orange&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ntr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;analysis comparison: non-tidal residual vs doodsonX0&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>subplot</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ntr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;model: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;g&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ntr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;obs: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;blue&#39;</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;model vs observation: non-tidal residual&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>legend</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xticks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rotation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>tight_layout</span><span style=color:#000;font-weight:700>()</span>

</code></pre></div><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_57_0.png alt=png></p><h3 id=threshold-statistics-for-non-tidal-residuals>Threshold Statistics for non-tidal residuals</h3><p>This is a simple extreme value analysis of whatever data you use. It will count the number of peaks and the total time spent over each threshold provided. It will also count the numbers of daily and monthly maxima over each threshold. To this, a Tidegauge object and an array of thresholds (in metres) should be passed. The method return <code>peak_count_*</code>, <code>time_over_threshold_*</code>, <code>dailymax_count_*</code>, <code>monthlymax_count_*</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>thresh_mod</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold_statistics</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>thresholds</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>arange</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0.1</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>thresh_obs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold_statistics</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>thresholds</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>arange</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0.1</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Have a look</span>
<span style=color:#000>thresh_obs</span>
</code></pre></div><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,rgba(0,0,0,1));&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,0.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,0.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1f1f1f;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111;&ndash;xr-background-color-row-even:#111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(';
}</p> <p>.xr-dim-list:after { content: &lsquo;)';
}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,';
padding-right: 5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:                  (t_dim: 720, id_dim: 61, threshold: 40)
Coordinates:
latitude                 (id_dim) float64 51.95 51.57 57.9 &hellip; 51.53 53.87
site_name                (id_dim) object 'Harwich' 'Mumbles' &hellip; 'N/A' 'N/A'
longitude                (id_dim) float64 1.292 -3.975 &hellip; 350.8 8.717</p>
<ul>
<li>threshold                (threshold) float64 -2.0 -1.9 -1.8 &hellip; 1.7 1.8 1.9
Dimensions without coordinates: t_dim, id_dim
Data variables:
time                     (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30&hellip;
peak_count_ntr           (id_dim, threshold) float64 24.0 24.0 &hellip; 0.0 0.0
time_over_threshold_ntr  (id_dim, threshold) float64 671.0 671.0 &hellip; 0.0 0.0
dailymax_count_ntr       (id_dim, threshold) float64 29.0 29.0 &hellip; 0.0 0.0
monthlymax_count_ntr     (id_dim, threshold) float64 1.0 1.0 1.0 &hellip; 0.0 0.0</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-dfa0d6be-e49b-45af-860f-68cdd51166ca class=xr-section-summary-in type=checkbox disabled><label for=section-dfa0d6be-e49b-45af-860f-68cdd51166ca class=xr-section-summary title="Expand/collapse section">Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li><li><span class=xr-has-index>threshold</span>: 40</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-c8668914-8a81-436a-9e39-d588631b26ee class=xr-section-summary-in type=checkbox checked><label for=section-c8668914-8a81-436a-9e39-d588631b26ee class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">51.95 51.57 57.9 &mldr; 51.53 53.87</div><input id=attrs-abc4f9d6-51c9-4c85-b386-f65bd3101bd7 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-abc4f9d6-51c9-4c85-b386-f65bd3101bd7 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-37492dfb-be2f-4692-a73f-2cd0f96f71a3 class=xr-var-data-in type=checkbox><label for=data-37492dfb-be2f-4692-a73f-2cd0f96f71a3 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.94798   , 51.57      , 57.89525   , 51.7064    , 54.03167   ,
51.21525   , 58.45661   , 58.44097   , 55.00744   , 51.95675   ,
53.31394   , 52.93436   , 56.62311   , 50.6085    , 53.33167   ,
50.36839   , 51.44564   , 54.49008   , 50.103     , 54.84256   ,
55.00744   , 57.14406   , 60.15403   , 51.55      , 50.71433   ,
49.91847   , 53.44969   , 55.62742   , 53.63103   , 50.78178   ,
57.5987    , 51.11439   , 51.51089   , 49.18333   , 55.00744   ,
54.65081   , 55.00744   , 51.50002   , 55.98983   , 52.473     ,
52.01378   , 54.66475   , 51.21525   , 50.80256   , 58.20711   ,
55.74964   , 54.08539   , 55.20678   , 51.50002   , 55.00744   ,
52.71906   , 51.21097   , 55.00744   , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58.        , 51.53300095,
53.86700058])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>object</div><div class="xr-var-preview xr-preview">'Harwich' 'Mumbles' &mldr; 'N/A' 'N/A'</div><input id=attrs-af34b280-a096-4232-b4ec-9295391caacc class=xr-var-attrs-in type=checkbox disabled><label for=attrs-af34b280-a096-4232-b4ec-9295391caacc title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-c7be59b1-f7eb-4a20-9eb4-7087c1e61c68 class=xr-var-data-in type=checkbox><label for=data-c7be59b1-f7eb-4a20-9eb4-7087c1e61c68 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &quot;St. Mary's&quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype=object)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">1.292 -3.975 -5.158 &mldr; 350.8 8.717</div><input id=attrs-4463471d-e5e0-48c6-9870-8776aca3dbe1 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-4463471d-e5e0-48c6-9870-8776aca3dbe1 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-5831b90c-493b-4ac5-bcc4-93ce5e258ecb class=xr-var-data-in type=checkbox><label for=data-5831b90c-493b-4ac5-bcc4-93ce5e258ecb title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00,  1.34839000e+00, -4.62044000e+00,  1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01,  5.70300000e-02, -4.00220000e+00,  1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00,  1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00,  1.12150002e+01,  1.18000002e+01,  5.11700010e+00,
1.12500000e+01,  3.52666992e+02,  7.56699991e+00,  3.50816986e+02,
8.71700001e+00])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span class=xr-has-index>threshold</span></div><div class=xr-var-dims>(threshold)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">-2.0 -1.9 -1.8 -1.7 &mldr; 1.7 1.8 1.9</div><input id=attrs-4b4dd4f6-5424-48b2-a934-8b5977a80af4 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-4b4dd4f6-5424-48b2-a934-8b5977a80af4 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-9589750a-b1cf-4636-af71-da65a5c5e413 class=xr-var-data-in type=checkbox><label for=data-9589750a-b1cf-4636-af71-da65a5c5e413 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([-2.000000e+00, -1.900000e+00, -1.800000e+00, -1.700000e+00,
-1.600000e+00, -1.500000e+00, -1.400000e+00, -1.300000e+00,
-1.200000e+00, -1.100000e+00, -1.000000e+00, -9.000000e-01,
-8.000000e-01, -7.000000e-01, -6.000000e-01, -5.000000e-01,
-4.000000e-01, -3.000000e-01, -2.000000e-01, -1.000000e-01,
1.776357e-15,  1.000000e-01,  2.000000e-01,  3.000000e-01,
4.000000e-01,  5.000000e-01,  6.000000e-01,  7.000000e-01,
8.000000e-01,  9.000000e-01,  1.000000e+00,  1.100000e+00,
1.200000e+00,  1.300000e+00,  1.400000e+00,  1.500000e+00,
1.600000e+00,  1.700000e+00,  1.800000e+00,  1.900000e+00])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-3b9ee740-61af-48cb-9b97-d160cfaec8bb class=xr-section-summary-in type=checkbox checked><label for=section-3b9ee740-61af-48cb-9b97-d160cfaec8bb class=xr-section-summary>Data variables: <span>(5)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class="xr-var-preview xr-preview">2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-6c1607dc-1565-4843-b5ef-af0ce7ec0115 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-6c1607dc-1565-4843-b5ef-af0ce7ec0115 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-81fc6d90-ce8e-4cd3-bd5d-26017c1dcc41 class=xr-var-data-in type=checkbox><label for=data-81fc6d90-ce8e-4cd3-bd5d-26017c1dcc41 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>peak_count_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">24.0 24.0 24.0 24.0 &mldr; 0.0 0.0 0.0</div><input id=attrs-d2d84dbe-a6d7-4e1c-9ccb-6eaa6f700f4d class=xr-var-attrs-in type=checkbox disabled><label for=attrs-d2d84dbe-a6d7-4e1c-9ccb-6eaa6f700f4d title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-51a6e0f6-57d4-4f3c-ac4a-2f6ac6f32a69 class=xr-var-data-in type=checkbox><label for=data-51a6e0f6-57d4-4f3c-ac4a-2f6ac6f32a69 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[24., 24., 24., &hellip;,  0.,  0.,  0.],
[14., 14., 14., &hellip;,  0.,  0.,  0.],
[21., 21., 21., &hellip;,  0.,  0.,  0.],
&hellip;,
[23., 23., 23., &hellip;,  0.,  0.,  0.],
[30., 30., 30., &hellip;,  0.,  0.,  0.],
[24., 24., 24., &hellip;,  0.,  0.,  0.]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>time_over_threshold_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">671.0 671.0 671.0 &mldr; 0.0 0.0 0.0</div><input id=attrs-4ce83047-b6e8-4f0e-af84-64aee4e12efa class=xr-var-attrs-in type=checkbox disabled><label for=attrs-4ce83047-b6e8-4f0e-af84-64aee4e12efa title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-5ca2b5d9-b567-4944-a777-81cf2caf4435 class=xr-var-data-in type=checkbox><label for=data-5ca2b5d9-b567-4944-a777-81cf2caf4435 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[671., 671., 671., &hellip;,   0.,   0.,   0.],
[341., 341., 341., &hellip;,   0.,   0.,   0.],
[671., 671., 671., &hellip;,   0.,   0.,   0.],
&hellip;,
[696., 696., 696., &hellip;,   0.,   0.,   0.],
[696., 696., 696., &hellip;,   0.,   0.,   0.],
[696., 696., 696., &hellip;,   0.,   0.,   0.]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>dailymax_count_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">29.0 29.0 29.0 29.0 &mldr; 0.0 0.0 0.0</div><input id=attrs-41f692f2-7a4d-4c33-9c7f-36b3fddec3b4 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-41f692f2-7a4d-4c33-9c7f-36b3fddec3b4 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-e62c1c3f-45fc-4ac3-b21f-f5cd471f649d class=xr-var-data-in type=checkbox><label for=data-e62c1c3f-45fc-4ac3-b21f-f5cd471f649d title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[29., 29., 29., &hellip;,  0.,  0.,  0.],
[15., 15., 15., &hellip;,  0.,  0.,  0.],
[29., 29., 29., &hellip;,  0.,  0.,  0.],
&hellip;,
[29., 29., 29., &hellip;,  0.,  0.,  0.],
[29., 29., 29., &hellip;,  0.,  0.,  0.],
[29., 29., 29., &hellip;,  0.,  0.,  0.]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>monthlymax_count_ntr</span></div><div class=xr-var-dims>(id_dim, threshold)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">1.0 1.0 1.0 1.0 &mldr; 0.0 0.0 0.0 0.0</div><input id=attrs-df778a08-2447-4bfc-8204-29e65dec0545 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-df778a08-2447-4bfc-8204-29e65dec0545 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-4e167f8f-3d57-4f62-bc92-0e4e29c790df class=xr-var-data-in type=checkbox><label for=data-4e167f8f-3d57-4f62-bc92-0e4e29c790df title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 0., 0., 0.],
&hellip;,
[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 0., 0., 0.],
[1., 1., 1., &hellip;, 0., 0., 0.]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-eec88999-e951-4c90-a796-660a378b0ccd class=xr-section-summary-in type=checkbox disabled><label for=section-eec88999-e951-4c90-a796-660a378b0ccd class=xr-section-summary title="Expand/collapse section">Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></li></ul><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>peak_count_ntr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>mean</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;id_dim&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#8f5902;font-style:italic>#plt.ylim([0,15])</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>f</span><span style=color:#4e9a06>&#34;Observed peaks over threshold&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xlabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Analysis threshold (m)&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ylabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;event count&#39;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Text(0, 0.5, 'event count')
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_61_1.png alt=png></p><p>Note that the non-tidal residual is a noisy timeseries (computed as a difference between two timeseries) so peaks do not necessarily correspond to peaks in total water level. For this reason <code>time_over_threshold_*</code> can be useful. Below we see that about 6% (y-axis) of the observations of non-tidal residual exceed 20cm (x-axis). Again, threshold statistics are more useful with a longer record.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>normalised_event_count</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>100</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_over_threshold_ntr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>time_over_threshold_ntr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>isel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>stn_id</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>max</span><span style=color:#000;font-weight:700>()</span>

<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>normalised_event_count</span> <span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ylim</span><span style=color:#000;font-weight:700>([</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xlim</span><span style=color:#000;font-weight:700>([</span><span style=color:#0000cf;font-weight:700>0.1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>0.4</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>f</span><span style=color:#4e9a06>&#34;time over threshold&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>xlabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Analysis threshold (m)&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ylabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;normalised event count (%)&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>plot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>thresh_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>threshold</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>22</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>normalised_event_count</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>22</span><span style=color:#000;font-weight:700>],</span> <span style=color:#4e9a06>&#39;r+&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>markersize</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>[&lt;matplotlib.lines.Line2D at 0x7f7f56a97c40&gt;]
</code></pre><p><img src=/COAsT/tidegauge_validation_tutorial_files/tidegauge_validation_tutorial_63_1.png alt=png></p><h2 id=other-tidegaugeanalysis-methods>Other TidegaugeAnalysis methods</h2><h3 id=calculate-errors>Calculate errors</h3><p>The difference() routine will calculate differences, absolute_differences and squared differenced for all variables. Corresponding new variables are created with names <code>diff_*</code>, <code>abs_diff_*</code> and <code>square_diff_*</code></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>ntr_diff</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>difference</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ntr_obs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ntr_mod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>ssh_diff</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tganalysis</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>difference</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obs_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model_new</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># Take a look</span>
<span style=color:#000>ntr_diff</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span>
</code></pre></div><pre><code>Tidegauge object at 0x55b017f74fc0 initialised
Tidegauge object at 0x55b017f74fc0 initialised
</code></pre><div><svg style="position:absolute;width:0;height:0;overflow:hidden"><defs><symbol id="icon-database" viewBox="0 0 32 32"><path d="M16 0C7.163.0.0 2.239.0 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5V5c0-2.761-7.163-5-16-5z"/><path d="M16 17c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/><path d="M16 26c-8.837.0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"/></symbol><symbol id="icon-file-text2" viewBox="0 0 32 32"><path d="M28.681 7.159c-.694-.947-1.662-2.053-2.724-3.116s-2.169-2.03-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319H4.5c-1.378.0-2.5 1.121-2.5 2.5v27C2 30.878 3.122 32 4.5 32h23c1.378.0 2.5-1.122 2.5-2.5V10c0-.448-.137-1.23-1.319-2.841zM24.543 5.457c.959.959 1.712 1.825 2.268 2.543H22V3.189c.718.556 1.584 1.309 2.543 2.268zM28 29.5c0 .271-.229.5-.5.5h-23c-.271.0-.5-.229-.5-.5v-27c0-.271.229-.5.5-.5.0.0 15.499.0 15.5.0v7c0 .552.448 1 1 1h7v19.5z"/><path d="M23 26H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 22H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/><path d="M23 18H9c-.552.0-1-.448-1-1s.448-1 1-1h14c.552.0 1 .448 1 1s-.448 1-1 1z"/></symbol></defs></svg><style><p>:root{&ndash;xr-font-color0:var(&ndash;jp-content-font-color0,rgba(0,0,0,1));&ndash;xr-font-color2:var(&ndash;jp-content-font-color2,rgba(0,0,0,0.54));&ndash;xr-font-color3:var(&ndash;jp-content-font-color3,rgba(0,0,0,0.38));&ndash;xr-border-color:var(&ndash;jp-border-color2,#e0e0e0);&ndash;xr-disabled-color:var(&ndash;jp-layout-color3,#bdbdbd);&ndash;xr-background-color:var(&ndash;jp-layout-color0,white);&ndash;xr-background-color-row-even:var(&ndash;jp-layout-color1,white);&ndash;xr-background-color-row-odd:var(&ndash;jp-layout-color2,#eeeeee)}</p><p>html[theme=dark],body.vscode-dark{&ndash;xr-font-color0:#fff;&ndash;xr-font-color2:rgba(255,255,255,.54);&ndash;xr-font-color3:rgba(255,255,255,.38);&ndash;xr-border-color:#1f1f1f;&ndash;xr-disabled-color:#515151;&ndash;xr-background-color:#111;&ndash;xr-background-color-row-even:#111;&ndash;xr-background-color-row-odd:#313131}</p><p>.xr-wrap{display:block!important;min-width:300px;max-width:700px}</p><p>.xr-text-repr-fallback{display:none}</p><p>.xr-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px var(&ndash;xr-border-color)}</p><p>.xr-header &gt; div,.xr-header &gt; ul{display:inline;margin-top:0;margin-bottom:0}</p><p>.xr-obj-type,.xr-array-name{margin-left:2px;margin-right:10px}</p><p>.xr-obj-type{color:var(&ndash;xr-font-color2)}</p><p>.xr-sections{padding-left:0!important;display:grid;grid-template-columns:150px auto auto 1fr 20px 20px}</p><p>.xr-section-item{display:contents}</p><p>.xr-section-item input{display:none}</p><p>.xr-section-item input+label{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-item input:enabled+label{cursor:pointer;color:var(&ndash;xr-font-color2)}</p><p>.xr-section-item input:enabled+label:hover{color:var(&ndash;xr-font-color0)}</p><p>.xr-section-summary{grid-column:1;color:var(&ndash;xr-font-color2);font-weight:500}</p><p>.xr-section-summary &gt; span{display:inline-block;padding-left:.5em}</p><p>.xr-section-summary-in:disabled+label{color:var(&ndash;xr-font-color2)}</p><p>.xr-section-summary-in+label:before{display:inline-block;content:&lsquo;►&rsquo;font-size:11px;width:15px;text-align:center}</p><p>.xr-section-summary-in:disabled+label:before{color:var(&ndash;xr-disabled-color)}</p><p>.xr-section-summary-in:checked+label:before{content:&lsquo;▼&rsquo}</p><p>.xr-section-summary-in:checked+label &gt; span{display:none}</p><p>.xr-section-summary,.xr-section-inline-details{padding-top:4px;padding-bottom:4px}</p><p>.xr-section-inline-details{grid-column:2/-1}</p><p>.xr-section-details{display:none;grid-column:1/-1;margin-bottom:5px}</p><p>.xr-section-summary-in:checked~.xr-section-details{display:contents}</p><p>.xr-array-wrap{grid-column:1/-1;display:grid;grid-template-columns:20px auto}</p><p>.xr-array-wrap &gt; label{grid-column:1;vertical-align:top}</p><p>.xr-preview{color:var(&ndash;xr-font-color3)}</p><p>.xr-array-preview,.xr-array-data{padding:0 5px!important;grid-column:2}</p><p>.xr-array-data,.xr-array-in:checked~.xr-array-preview{display:none}</p><p>.xr-array-in:checked~.xr-array-data,.xr-array-preview{display:inline-block}</p><p>.xr-dim-list{display:inline-block!important;list-style:none;padding:0!important;margin:0}</p><p>.xr-dim-list li{display:inline-block;padding:0;margin:0}</p><p>.xr-dim-list:before{content:&lsquo;(';
}</p> <p>.xr-dim-list:after { content: &lsquo;)';
}</p><p>.xr-dim-list li:not(:last-child):after{content:&lsquo;,';
padding-right: 5px}</p><p>.xr-has-index{font-weight:700}</p><p>.xr-var-list,.xr-var-item{display:contents}</p><p>.xr-var-item &gt; div,.xr-var-item label,.xr-var-item &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-even);margin-bottom:0}</p><p>.xr-var-item &gt; .xr-var-name:hover span{padding-right:5px}</p><p>.xr-var-list &gt; li:nth-child(odd) &gt; div,.xr-var-list &gt; li:nth-child(odd) &gt; label,.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span{background-color:var(&ndash;xr-background-color-row-odd)}</p><p>.xr-var-name{grid-column:1}</p><p>.xr-var-dims{grid-column:2}</p><p>.xr-var-dtype{grid-column:3;text-align:right;color:var(&ndash;xr-font-color2)}</p><p>.xr-var-preview{grid-column:4}</p><p>.xr-var-name,.xr-var-dims,.xr-var-dtype,.xr-preview,.xr-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px}</p><p>.xr-var-name:hover,.xr-var-dims:hover,.xr-var-dtype:hover,.xr-attrs dt:hover{overflow:visible;width:auto;z-index:1}</p><p>.xr-var-attrs,.xr-var-data{display:none;background-color:var(&ndash;xr-background-color)!important;padding-bottom:5px!important}</p><p>.xr-var-attrs-in:checked~.xr-var-attrs,.xr-var-data-in:checked~.xr-var-data{display:block}</p><p>.xr-var-data &gt; table{float:right}</p><p>.xr-var-name span,.xr-var-data,.xr-attrs{padding-left:25px!important}</p><p>.xr-attrs,.xr-var-attrs,.xr-var-data{grid-column:1/-1}</p><p>dl.xr-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto}</p><p>.xr-attrs dt,.xr-attrs dd{padding:0;margin:0;float:left;padding-right:10px;width:auto}</p><p>.xr-attrs dt{font-weight:400;grid-column:1}</p><p>.xr-attrs dt:hover span{display:inline-block;background:var(&ndash;xr-background-color);padding-right:10px}</p><p>.xr-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all}</p><p>.xr-icon-database,.xr-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em!important;stroke-width:0;stroke:currentColor;fill:currentColor}</style><pre class=xr-text-repr-fallback>&lt;xarray.Dataset&gt;
Dimensions:          (t_dim: 720, id_dim: 61)
Coordinates:
time             (t_dim) datetime64[ns] 2007-01-01 &hellip; 2007-01-30T23:00:00
site_name        (id_dim) object 'Harwich' 'Mumbles' &hellip; 'N/A' 'N/A'
longitude        (id_dim) float64 1.292 -3.975 -5.158 &hellip; 7.567 350.8 8.717
latitude         (id_dim) float64 51.95 51.57 57.9 &hellip; 58.0 51.53 53.87
Dimensions without coordinates: t_dim, id_dim
Data variables:
diff_ntr         (id_dim, t_dim) float64 nan nan nan &hellip; -0.07105 0.03123
abs_diff_ntr     (id_dim, t_dim) float64 nan nan nan &hellip; 0.07105 0.03123
square_diff_ntr  (id_dim, t_dim) float64 nan nan nan &hellip; 0.005049 0.0009752</pre><div class=xr-wrap style=display:none><div class=xr-header><div class=xr-obj-type>xarray.Dataset</div></div><ul class=xr-sections><li class=xr-section-item><input id=section-6c449353-357b-48a6-94af-02b2461b758a class=xr-section-summary-in type=checkbox disabled><label for=section-6c449353-357b-48a6-94af-02b2461b758a class=xr-section-summary title="Expand/collapse section">Dimensions:</label><div class=xr-section-inline-details><ul class=xr-dim-list><li><span>t_dim</span>: 720</li><li><span>id_dim</span>: 61</li></ul></div><div class=xr-section-details></div></li><li class=xr-section-item><input id=section-d2ca5e25-32f8-4650-b84b-f1955415a076 class=xr-section-summary-in type=checkbox checked><label for=section-d2ca5e25-32f8-4650-b84b-f1955415a076 class=xr-section-summary>Coordinates: <span>(4)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>time</span></div><div class=xr-var-dims>(t_dim)</div><div class=xr-var-dtype>datetime64[ns]</div><div class="xr-var-preview xr-preview">2007-01-01 &mldr; 2007-01-30T23:00:00</div><input id=attrs-a0092f46-f5e0-42f7-8248-52c805d27053 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-a0092f46-f5e0-42f7-8248-52c805d27053 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-9e5ecfb8-82b5-41b6-ad5a-b87b93e39e5c class=xr-var-data-in type=checkbox><label for=data-9e5ecfb8-82b5-41b6-ad5a-b87b93e39e5c title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['2007-01-01T00:00:00.000000000', '2007-01-01T01:00:00.000000000',
'2007-01-01T02:00:00.000000000', '2007-01-01T03:00:00.000000000',
'2007-01-01T04:00:00.000000000', '2007-01-01T05:00:00.000000000',
'2007-01-01T06:00:00.000000000', '2007-01-01T07:00:00.000000000',
'2007-01-01T08:00:00.000000000', '2007-01-01T09:00:00.000000000',
'2007-01-01T10:00:00.000000000', '2007-01-01T11:00:00.000000000',
'2007-01-01T12:00:00.000000000', '2007-01-01T13:00:00.000000000',
'2007-01-01T14:00:00.000000000', '2007-01-01T15:00:00.000000000',
'2007-01-01T16:00:00.000000000', '2007-01-01T17:00:00.000000000',
'2007-01-01T18:00:00.000000000', '2007-01-01T19:00:00.000000000',
'2007-01-01T20:00:00.000000000', '2007-01-01T21:00:00.000000000',
'2007-01-01T22:00:00.000000000', '2007-01-01T23:00:00.000000000',
'2007-01-02T00:00:00.000000000', '2007-01-02T01:00:00.000000000',
'2007-01-02T02:00:00.000000000', '2007-01-02T03:00:00.000000000',
'2007-01-02T04:00:00.000000000', '2007-01-02T05:00:00.000000000',
'2007-01-02T06:00:00.000000000', '2007-01-02T07:00:00.000000000',
'2007-01-02T08:00:00.000000000', '2007-01-02T09:00:00.000000000',
'2007-01-02T10:00:00.000000000', '2007-01-02T11:00:00.000000000',
'2007-01-02T12:00:00.000000000', '2007-01-02T13:00:00.000000000',
'2007-01-02T14:00:00.000000000', '2007-01-02T15:00:00.000000000',
&hellip;
'2007-01-29T10:00:00.000000000', '2007-01-29T11:00:00.000000000',
'2007-01-29T12:00:00.000000000', '2007-01-29T13:00:00.000000000',
'2007-01-29T14:00:00.000000000', '2007-01-29T15:00:00.000000000',
'2007-01-29T16:00:00.000000000', '2007-01-29T17:00:00.000000000',
'2007-01-29T18:00:00.000000000', '2007-01-29T19:00:00.000000000',
'2007-01-29T20:00:00.000000000', '2007-01-29T21:00:00.000000000',
'2007-01-29T22:00:00.000000000', '2007-01-29T23:00:00.000000000',
'2007-01-30T00:00:00.000000000', '2007-01-30T01:00:00.000000000',
'2007-01-30T02:00:00.000000000', '2007-01-30T03:00:00.000000000',
'2007-01-30T04:00:00.000000000', '2007-01-30T05:00:00.000000000',
'2007-01-30T06:00:00.000000000', '2007-01-30T07:00:00.000000000',
'2007-01-30T08:00:00.000000000', '2007-01-30T09:00:00.000000000',
'2007-01-30T10:00:00.000000000', '2007-01-30T11:00:00.000000000',
'2007-01-30T12:00:00.000000000', '2007-01-30T13:00:00.000000000',
'2007-01-30T14:00:00.000000000', '2007-01-30T15:00:00.000000000',
'2007-01-30T16:00:00.000000000', '2007-01-30T17:00:00.000000000',
'2007-01-30T18:00:00.000000000', '2007-01-30T19:00:00.000000000',
'2007-01-30T20:00:00.000000000', '2007-01-30T21:00:00.000000000',
'2007-01-30T22:00:00.000000000', '2007-01-30T23:00:00.000000000'],
dtype='datetime64[ns]')</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>site_name</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>object</div><div class="xr-var-preview xr-preview">'Harwich' 'Mumbles' &mldr; 'N/A' 'N/A'</div><input id=attrs-11ddd461-94b7-4470-86bf-547d5bca7947 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-11ddd461-94b7-4470-86bf-547d5bca7947 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-8833ce95-b586-4f74-9e7b-01944f60a954 class=xr-var-data-in type=checkbox><label for=data-8833ce95-b586-4f74-9e7b-01944f60a954 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array(['Harwich', 'Mumbles', 'Ullapool', 'Milford Haven', 'Heysham',
'Hinkley Point', 'Kinlochbervie', 'Wick', 'North Shields',
'Felixstowe', 'Holyhead', 'Cromer', 'Tobermory', 'Weymouth',
'Llandudno', 'Devonport', 'Sheerness', 'Whitby', 'Newlyn',
'Portpatrick', 'North Shields', 'Aberdeen', 'Lerwick', 'Newport',
'Bournemouth', &quot;St. Mary's&quot;, 'Liverpool, Gladstone Dock',
'Port Ellen (Islay)', 'Immingham', 'Newhaven', 'Moray Firth',
'Dover', 'Avonmouth', 'St. Helier (Jersey)', 'North Shields',
'Workington', 'North Shields', 'Portbury', 'Leith', 'Lowestoft',
'Fishguard', 'Bangor', 'Hinkley Point', 'Portsmouth', 'Stornoway',
'Millport', 'Port Erin', 'Portrush', 'Portbury', 'North Shields',
'Barmouth', 'Ilfracombe', 'North Shields', 'N/A', 'N/A', 'N/A',
'N/A', 'N/A', 'N/A', 'N/A', 'N/A'], dtype=object)</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>longitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">1.292 -3.975 -5.158 &mldr; 350.8 8.717</div><input id=attrs-926dbbd1-f9e6-43d0-b63d-232bff841fc9 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-926dbbd1-f9e6-43d0-b63d-232bff841fc9 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-70e355cd-9c7e-4f65-9399-afe44a216d7d class=xr-var-data-in type=checkbox><label for=data-70e355cd-9c7e-4f65-9399-afe44a216d7d title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([ 1.29210000e+00, -3.97544000e+00, -5.15789000e+00, -5.05148000e+00,
-2.92042000e+00, -3.13433000e+00, -5.05036000e+00, -3.08631000e+00,
-1.43978000e+00,  1.34839000e+00, -4.62044000e+00,  1.30164000e+00,
-6.06422000e+00, -2.44794000e+00, -3.82522000e+00, -4.18525000e+00,
7.43440000e-01, -6.14170000e-01, -5.54283000e+00, -5.12003000e+00,
-1.43978000e+00, -2.08013000e+00, -1.14031000e+00, -2.98744000e+00,
-1.87486000e+00, -6.31642000e+00, -3.01800000e+00, -6.19006000e+00,
-1.86030000e-01,  5.70300000e-02, -4.00220000e+00,  1.32267000e+00,
-2.71497000e+00, -2.11667000e+00, -1.43978000e+00, -3.56764000e+00,
-1.43978000e+00, -2.72848000e+00, -3.18169000e+00,  1.75083000e+00,
-4.98333000e+00, -5.66947000e+00, -3.13433000e+00, -1.11175000e+00,
-6.38889000e+00, -4.90583000e+00, -4.76806000e+00, -6.65683000e+00,
-2.72848000e+00, -1.43978000e+00, -4.04517000e+00, -4.11094000e+00,
-1.43978000e+00,  1.12150002e+01,  1.18000002e+01,  5.11700010e+00,
1.12500000e+01,  3.52666992e+02,  7.56699991e+00,  3.50816986e+02,
8.71700001e+00])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>latitude</span></div><div class=xr-var-dims>(id_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">51.95 51.57 57.9 &mldr; 51.53 53.87</div><input id=attrs-d04f01cb-14ea-48d1-8664-63fde41b8c6a class=xr-var-attrs-in type=checkbox disabled><label for=attrs-d04f01cb-14ea-48d1-8664-63fde41b8c6a title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-ef81cae3-512a-4740-8baa-9b965ee22885 class=xr-var-data-in type=checkbox><label for=data-ef81cae3-512a-4740-8baa-9b965ee22885 title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([51.94798   , 51.57      , 57.89525   , 51.7064    , 54.03167   ,
51.21525   , 58.45661   , 58.44097   , 55.00744   , 51.95675   ,
53.31394   , 52.93436   , 56.62311   , 50.6085    , 53.33167   ,
50.36839   , 51.44564   , 54.49008   , 50.103     , 54.84256   ,
55.00744   , 57.14406   , 60.15403   , 51.55      , 50.71433   ,
49.91847   , 53.44969   , 55.62742   , 53.63103   , 50.78178   ,
57.5987    , 51.11439   , 51.51089   , 49.18333   , 55.00744   ,
54.65081   , 55.00744   , 51.50002   , 55.98983   , 52.473     ,
52.01378   , 54.66475   , 51.21525   , 50.80256   , 58.20711   ,
55.74964   , 54.08539   , 55.20678   , 51.50002   , 55.00744   ,
52.71906   , 51.21097   , 55.00744   , 58.34999847, 57.68299866,
61.93299866, 64.86699677, 55.36700058, 58.        , 51.53300095,
53.86700058])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-50d2ce45-a14e-435f-b66c-ff3200167a65 class=xr-section-summary-in type=checkbox checked><label for=section-50d2ce45-a14e-435f-b66c-ff3200167a65 class=xr-section-summary>Data variables: <span>(3)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><ul class=xr-var-list><li class=xr-var-item><div class=xr-var-name><span>diff_ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">nan nan nan &mldr; -0.07105 0.03123</div><input id=attrs-2f196afa-96b7-48ba-bd3a-82d05aaa58fd class=xr-var-attrs-in type=checkbox disabled><label for=attrs-2f196afa-96b7-48ba-bd3a-82d05aaa58fd title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-b18e9ca9-a1ab-419d-a5ba-74ff69ec252f class=xr-var-data-in type=checkbox><label for=data-b18e9ca9-a1ab-419d-a5ba-74ff69ec252f title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[        nan,         nan,         nan, &hellip;, -0.27055282,
-0.24161073, -0.19948584],
[        nan,         nan,         nan, &hellip;,         nan,
nan,         nan],
[        nan,         nan,         nan, &hellip;,  0.26775999,
0.29183498,  0.31725988],
&hellip;,
[        nan,         nan,         nan, &hellip;, -0.13722572,
-0.15640233, -0.18539439],
[        nan,         nan,         nan, &hellip;,  0.05165766,
0.07687488,  0.10824192],
[        nan,         nan,         nan, &hellip;, -0.15185874,
-0.07105414,  0.03122864]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>abs_diff_ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">nan nan nan &mldr; 0.07105 0.03123</div><input id=attrs-1faf83b7-a4df-4b05-ba94-f734fdab38f1 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-1faf83b7-a4df-4b05-ba94-f734fdab38f1 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-34e46e85-d788-4417-97d2-e74cd6724a7e class=xr-var-data-in type=checkbox><label for=data-34e46e85-d788-4417-97d2-e74cd6724a7e title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[       nan,        nan,        nan, &hellip;, 0.27055282, 0.24161073,
0.19948584],
[       nan,        nan,        nan, &hellip;,        nan,        nan,
nan],
[       nan,        nan,        nan, &hellip;, 0.26775999, 0.29183498,
0.31725988],
&hellip;,
[       nan,        nan,        nan, &hellip;, 0.13722572, 0.15640233,
0.18539439],
[       nan,        nan,        nan, &hellip;, 0.05165766, 0.07687488,
0.10824192],
[       nan,        nan,        nan, &hellip;, 0.15185874, 0.07105414,
0.03122864]])</pre></div></li><li class=xr-var-item><div class=xr-var-name><span>square_diff_ntr</span></div><div class=xr-var-dims>(id_dim, t_dim)</div><div class=xr-var-dtype>float64</div><div class="xr-var-preview xr-preview">nan nan nan &mldr; 0.005049 0.0009752</div><input id=attrs-91120bcc-f4c7-4582-b9b1-c32a3520cae7 class=xr-var-attrs-in type=checkbox disabled><label for=attrs-91120bcc-f4c7-4582-b9b1-c32a3520cae7 title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"/></svg></label><input id=data-65a8b825-c111-4642-90ef-180d23b18f6c class=xr-var-data-in type=checkbox><label for=data-65a8b825-c111-4642-90ef-180d23b18f6c title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"/></svg></label><div class=xr-var-attrs><dl class=xr-attrs></dl></div><div class=xr-var-data><pre>array([[       nan,        nan,        nan, &hellip;, 0.07319883, 0.05837574,
0.0397946 ],
[       nan,        nan,        nan, &hellip;,        nan,        nan,
nan],
[       nan,        nan,        nan, &hellip;, 0.07169541, 0.08516766,
0.10065383],
&hellip;,
[       nan,        nan,        nan, &hellip;, 0.0188309 , 0.02446169,
0.03437108],
[       nan,        nan,        nan, &hellip;, 0.00266851, 0.00590975,
0.01171631],
[       nan,        nan,        nan, &hellip;, 0.02306108, 0.00504869,
0.00097523]])</pre></div></li></ul></div></li><li class=xr-section-item><input id=section-640679e3-653d-472a-9a32-f5466d002c65 class=xr-section-summary-in type=checkbox disabled><label for=section-640679e3-653d-472a-9a32-f5466d002c65 class=xr-section-summary title="Expand/collapse section">Attributes: <span>(0)</span></label><div class=xr-section-inline-details></div><div class=xr-section-details><dl class=xr-attrs></dl></div></li></ul></div></div></p><p>We can then easily get mean errors, MAE and MSE</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>mean_stats</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ntr_diff</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>mean</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;t_dim&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>skipna</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
</code></pre></div><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it!</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/British-Oceanographic-Data-Centre/COAsT/issues/new>tell us how we can improve</a>.</p><script>const yesButton=document.querySelector('.feedback--answer-yes');const noButton=document.querySelector('.feedback--answer-no');const yesResponse=document.querySelector('.feedback--response-yes');const noResponse=document.querySelector('.feedback--response-no');const disableButtons=()=>{yesButton.disabled=true;noButton.disabled=true;};const sendFeedback=(value)=>{if(typeof ga!=='function')return;const args={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:value};ga(args.command,args.hitType,args.category,args.action,args.label,args.value);};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible');disableButtons();sendFeedback(1);});noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible');disableButtons();sendFeedback(0);});</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified October 20, 2022: <a href=https://github.com/British-Oceanographic-Data-Centre/COAsT-site/commit/2e5189b75bcbe695865d41868cd4b1a308904bd0>Updated Altimetry notebook pages from coast repo. (2e5189b)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="COAsT Pypi" aria-label="COAsT Pypi"><a class=text-white target=_blank href=https://pypi.org/project/COAsT/#history><i></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/British-Oceanographic-Data-Centre/COAsT><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 The Docsy Authors All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank>Privacy Policy</a></small><p class=mt-2><a href=/COAsT/about/>About Goldydocs</a></p></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/COAsT/js/main.min.7afee248b9b3c1d4438c6841cc272ae0ac1f81a3ee5c0ed939f1d57c18de3f7d.js integrity="sha256-ev7iSLmzwdRDjGhBzCcq4KwfgaPuXA7ZOfHVfBjeP30=" crossorigin=anonymous></script></body></html>